<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />


<meta name="date" content="2024-12-06" />

<title>A-SA24204129-Homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">A-SA24204129-Homework</h1>
<h4 class="date">2024-12-06</h4>



<div id="作业2024-09-09" class="section level1">
<h1>作业2024-09-09</h1>
<div id="example-1主成分分析" class="section level2">
<h2><strong><em>Example 1：主成分分析</em></strong></h2>
<p><span class="math inline">\(\hspace{1.5em}\)</span>在许多实际应用中，收集到的海量数据往往价值密度较低，包含大量噪声和冗余，高维的数据暗藏着低维的结构。基于此，降维技术应运而生，其中最常用的就是<strong>主成分分析(principal
component analysis, PCA)</strong>。</p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>主成分是将自变量进行新的线性组合，生成新的信息表达方式，在尽量不损失原始数据信息的情形下，将数据信息进行有效地转换与压缩。同时，主成分互不相关的性质对解释以及之后的统计分析都有帮助。</p>
<div id="理论部分" class="section level3">
<h3><strong>理论部分</strong></h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>假设研究数据包括样本和变量的数目分别为<span class="math inline">\(n\)</span>和<span class="math inline">\(p\)</span>。<span class="math inline">\(p\)</span>个变量按顺序表示为<span class="math inline">\(X_1,X_2,…,X_p\)</span>，由这<span class="math inline">\(p\)</span>个变量构成的随机向量可表示为<span class="math inline">\(\textbf{X}=(X_1,X_2,…,X_p)&#39;\)</span>.<span class="math inline">\(\mu\)</span>表示<span class="math inline">\(\textbf{X}\)</span>的均值，<span class="math inline">\(\Sigma\)</span>表示<span class="math inline">\(\textbf{X}\)</span>的协方差矩阵。Y表示提取到的主成分，则主成分由原始变量线性表示，如下式：
<span class="math display">\[
\begin{align}\left\{\begin{aligned}
\begin{matrix}
Y_1=c_{11}X_1+C_{21}X_2+…+c_{p1}X_p=\textbf{c}_1^TX\\
Y_2=c_{12}X_1+C_{22}X_2+…+c_{p2}X_p=\textbf{c}_2^TX\\
……\\
Y_p=c_{11}X_1+C_{21}X_2+…+c_{p1}X_p=\textbf{c}_1^TX\\
\end{matrix}
\end{aligned}\right.\end{align}
\]</span></p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>在<span class="math inline">\(Y_i=c_i&#39;\textbf{X}\)</span>的方差尽可能大且各<span class="math inline">\(Y_i\)</span>之间相互独立的前提下，求解出的主成分会损失原始变量较少的信息。<span class="math inline">\(Y_i\)</span>的方差可表示为<span class="math inline">\(Var(Y_i)=Var(c_i&#39;\textbf{X})=c_i&#39;\Sigma
c_i\)</span>，对于任意常数<span class="math inline">\(k\)</span>，有<span class="math inline">\(Var(k
c_i&#39;\textbf{X})=k^2 c_i&#39;\Sigma c_i\)</span>。需要限制<span class="math inline">\(c_i\)</span>的值，使<span class="math inline">\(Var(Y_i)\)</span>不能任意增大，所以在进行线性变换时要满足一定的约束条件：</p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>(1)<span class="math inline">\(c_i&#39;c_i=1,(i=1,2,…,p)\)</span>;</p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>(2)主成分<span class="math inline">\(Y_i\)</span>与<span class="math inline">\(Y_j\)</span>之间互不相关(<span class="math inline">\(i\neq j, i,j=1,2,…,p\)</span>);</p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>(3)在<span class="math inline">\(\textbf{X}\)</span>的所有满足约束条件(1)的线性组合中，方差最大的是<span class="math inline">\(Y_1\)</span>；在与<span class="math inline">\(Y_1\)</span>不相关的所有<span class="math inline">\(\textbf{X}\)</span>的线性组合中，方差最大的是<span class="math inline">\(Y_2\)</span>；以此类推，在与<span class="math inline">\(Y_1,Y_2,…,Y_p\)</span>都不相关的所有<span class="math inline">\(\textbf{X}\)</span>的线性组合中，方差最大的是<span class="math inline">\(Y_p\)</span>。</p>
</div>
<div id="r软件实现" class="section level3">
<h3><strong>R软件实现</strong></h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>下面是主成分分析经典的一个数值模拟方法(Zou等，2006),我们将基于这个模拟数据进行操作。<span class="math inline">\({V_1},{V_2},{V_3}\)</span>分别是三个潜在主成分，分别满足
<span class="math inline">\({V_1}\sim N(0,290)\)</span>,<span class="math inline">\({V_2}\sim N(0,300)\)</span>,<span class="math inline">\({V_3}=-0.3V_1+0.925V_2+e,e\sim
N(0,1)\)</span>,且<span class="math inline">\(V_1,V_2\)</span>与<span class="math inline">\(e\)</span>相互独立。设有10个变量，其构造方式如下：
<span class="math display">\[
\begin{align}
X_i&amp;=V_1+e_i^1,e_i^1\sim N(0,1),i=1,2,3,4;
\\
X_i&amp;=V_2+e_i^2,e_i^2\sim N(0,1),i=5,6,7,8;
\\
X_i&amp;=V_3+e_i^3,e_i^3\sim N(0,1),i=9,10.
\end{align}
\]</span> 其中 {<span class="math inline">\(e_i^j,i=1,2,…,10,j=1,2,3\)</span>}
相互独立。R语言运行结果如下：</p>
<pre><code>## [1] 1000000      10</code></pre>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">PC1</th>
<th align="right">PC2</th>
<th align="right">PC3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">X1</td>
<td align="right">-0.124</td>
<td align="right">0.476</td>
<td align="right">-0.088</td>
</tr>
<tr class="even">
<td align="left">X2</td>
<td align="right">-0.125</td>
<td align="right">0.476</td>
<td align="right">-0.088</td>
</tr>
<tr class="odd">
<td align="left">X3</td>
<td align="right">-0.125</td>
<td align="right">0.476</td>
<td align="right">-0.086</td>
</tr>
<tr class="even">
<td align="left">X4</td>
<td align="right">-0.125</td>
<td align="right">0.476</td>
<td align="right">-0.089</td>
</tr>
<tr class="odd">
<td align="left">X5</td>
<td align="right">0.389</td>
<td align="right">0.152</td>
<td align="right">0.275</td>
</tr>
<tr class="even">
<td align="left">X6</td>
<td align="right">0.389</td>
<td align="right">0.152</td>
<td align="right">0.277</td>
</tr>
<tr class="odd">
<td align="left">X7</td>
<td align="right">0.389</td>
<td align="right">0.152</td>
<td align="right">0.273</td>
</tr>
<tr class="even">
<td align="left">X8</td>
<td align="right">0.389</td>
<td align="right">0.152</td>
<td align="right">0.275</td>
</tr>
<tr class="odd">
<td align="left">X9</td>
<td align="right">0.408</td>
<td align="right">0.000</td>
<td align="right">-0.577</td>
</tr>
<tr class="even">
<td align="left">X10</td>
<td align="right">0.408</td>
<td align="right">0.000</td>
<td align="right">-0.578</td>
</tr>
<tr class="odd">
<td align="left">方差贡献率(%)</td>
<td align="right">59.793</td>
<td align="right">39.887</td>
<td align="right">0.082</td>
</tr>
<tr class="even">
<td align="left">累积贡献率(%)</td>
<td align="right">59.793</td>
<td align="right">99.681</td>
<td align="right">99.762</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(\hspace{1.5em}\)</span>PCA方法提取前三个主成分累积方差贡献率为<strong><em>99.68%</em></strong>，结果符合模拟数据的设定。但PCA无法识别其真实稀疏结构,这是由于主成分的计算依托于全部原始变量，获得的每个PC是所有变量的线性组合。为了达到降维和可解释性之间的良好平衡，将稀疏性这一简单性假设引入PCA中，从而改善主成分的不足。在这里不再讨论。</p>
<hr />
</div>
</div>
<div id="example-2寻找组间差异t检验" class="section level2">
<h2><strong><em>Example 2：寻找组间差异——t检验</em></strong></h2>
<p><span class="math inline">\(\hspace{1.5em}\)</span>在研究中，我们最常关注的问题莫过于处理组与对照组是否存在了显著不同。就两组间比较而言，t检验是常见的分析方法之一。</p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>鸢尾花(Iris)数据集是机器学习领域中最经典的数据集之一。它由三种不同品种的鸢尾花的测量数据组成：山鸢尾(setosa)、变色鸢尾(versicolor)和维吉尼亚鸢尾(virginica)。该数据集包含150个样本，每行数据包含每个样本的四个特征：花萼长度(sepal
length)、花萼宽度(sepal width)、花瓣长度(petal length)、花瓣宽度(petal
width)。</p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>接下来,使用 iris
数据集中的 Sepal.Length 进行 t 检验，比较不同种类的 Sepal.Length
是否有显著差异。</p>
<div id="正态性假设检验" class="section level3">
<h3><strong>正态性假设检验</strong></h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>t检验的一个重要前提就是数据必须符合<em>正态分布</em>。因此在执行t检验之前必须验证数据分布的正态性。若数据不符合正态分布，则t检验将无法适用于该数据。首先绘制QQ图查看数值分布，如果点大致沿着对角线分布，说明数据可能近似正态分布；偏离对角线可能表明数据不完全符合正态分布。结果如下图所示。</p>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>横坐标是标准的正态分布值，纵坐标是我们数据的值。可以看到大部分的点都离直线很近，大致沿着对角线分布，因此可以认为该数据符合正态性假设。</p>
</div>
<div id="t检验" class="section level3">
<h3><strong>t检验</strong></h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>接下来对数据进行独立样本的
t 检验，即分别两两比较不同种类的
Sepal.Length。R软件操作得到三组结果如下：</p>
<pre><code>## 
##  Two Sample t-test
## 
## data:  setosa and versicolor
## t = -10.521, df = 98, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -1.1054165 -0.7545835
## sample estimates:
## mean of x mean of y 
##     5.006     5.936</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  setosa and virginica
## t = -15.386, df = 98, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -1.786042 -1.377958
## sample estimates:
## mean of x mean of y 
##     5.006     6.588</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  versicolor and virginica
## t = -5.6292, df = 98, p-value = 1.725e-07
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.8818516 -0.4221484
## sample estimates:
## mean of x mean of y 
##     5.936     6.588</code></pre>
<p><span class="math inline">\(\hspace{1.5em}\)</span>可以看到，结果的p值均小于显著性水平0.01，这表明两组间的
Sepal.Length 存在显著差异。</p>
</div>
<div id="可视化箱线图" class="section level3">
<h3><strong>可视化——箱线图</strong></h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>箱线图能帮助我们更直观地了解数据的分布情况、中心趋势和离群情况。观察三组的箱体，发现在中位数、四分位数和异常值有着较为明显的差异。
<img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAz1BMVEUAAAAAACsAAFUAKysAK1UAK4AAVYAAVaoAv/8rAAArACsrAFUrKwArK1UrK4ArVVUrVYArVaorgKorgNRVAABVACtVKwBVKytVVVVVgIBVgKpVgNRVqqpVqtRVqv+AKwCAVSuAgFWAgKqAqoCAqtSA1KqA1NSA1P+gIPCpqamqVQCqVSuqVYCqgFWqqlWq1ICq1Kqq1NSq1P+q/6qq/9Sq///UgCvUqlXUqoDU1KrU/6rU////AAD/FJP/qlX/1ID/1Kr/1wD//6r//9T////ZJPniAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMlUlEQVR4nO2dDZujthHH8WZd19dL03R9lzbXeu+aF6dc26TbHsnFF3yx/f0/U6TRu40YEAgEnv/z3O0uIGn4IY2EGEF2JtUqG9uA1EWAEBEgRAQIEQFCRIAQESBEBAgRAUJEgBARIEQECBEBQkSAEBEgRAQIEQFCRIAQESBEBAgRAUJEgBARIEQECBEBQkSAEBEgRAQIEQFCRIAQESBEBAhRJrX401Oj40+P2XJ/self76oOfLvOss/l7/9+HlRCkS12jdLYllwlyrO7KgMbmpZp1eRiZ3gF6OPLypQlz/NBpREXYduyhJaAhCWtAOGmGUDybBBdA/KUb9lZtLoG4YCEJa0A4aapXYd1tuI/f/oiyz75cg8b2B5mLfufFfED237/ZMzXx+VO9u5maWmeLf7Ori+7WPw6nd6yHZ/vheUqW5byJUvw6c4PyKRjm79lf9zv1Ob7HYcgLXH2nk0xrBmxrOEkS2HJpWmOPao4dXI/raEGSaLcwoLXqUKmlBVxp8w3xzmALjZrQLD/AEUcN3DI/TsnW9Ei7RIuAVnpCiudaCOL5zagizqRmw2F2GrqlGOabY8uzrSwpag27Aeg4UUvvoK/ecq7p/OPGeMvzLePs2qwvdltYosv/2uu55MxyMr2d3ux2QPISlfAVRbFMLCr/SnPZEUX+JZqrwK0lMWw9Fs4+VW1adoeU5zmw6uaOlnxg+2WlSAXVZJvFubbx+X2tTKbrZOTnvD+6z0YJ2oqpNTZ8sPe8w5l5QFkpxPVWjgFkZjttQFt9fGyGe2M9Su7hTmm2faY4hwnrWwrNBdRijwFvhkOcY4zgJzNjv/48blqH0Bd1mMr2/PptdjsA2SnK1QjMAfnNiC917ls0io4zupnjGn2gaY41VY/bgQ324mVa2mgTMk3g0XOcQaQs/miMzm9f7Pmp19mV4Bkttn9P95vvIDsdBYCVWQ9IHPZeBuzKpdjmm2PKU47M109tGFQ/cz1Ca5BwnHIbIQXuLq02oHX1CCdrkMN4m3MzdWYdmGPLE7XoEfrZHVjfi7aWDcfxGxdvNpDR2kq6dnNtlRuxeek7XQ2giofdAXIcnUF7/F0C3NMu/BBKwXI7sbsboj//vMGSqvtxdwL4unFMuVhxMiDNWgxFLgz3ctyz4cjFzXI+EcrnY3A7sXE9ipAunMSvsy0sAvT7F5MFmf4wPmYgcwJqlSpUoLEyNEdB4F3uB4HVfRimbrYqjQ320onbQBZ6WwE1jhIWlIFSJcOx1ujZsc0+0BdnDbhU3G/BkPhV2c4b926WKX7/2sYi7oj6VdQxls1+HQ22076BF0FjLBZY369FlnZ2UIvdv91oRvxFSArnYOAF//HJ2g/wpIqHyRH0mdxXrqtXphm26OLazTdUXs/HK4es3V67lpZg6BG9kwdUA5zKupOEtfHl/5CZwlIDVia3faDZ/HOWswS0PnjF+vmk3G8W/9zO3toyhURAUJEgBARIEQECBEBQkSAEBEgRAQIEQFCRIAQESBEBAgRAUJEgBARIEQECBEBQkSAEBEgRAQIEQFCRIAQESBEBAgRAUJEgBD1DCibjIYF1L7csTUwoFjZxRMBQnSbgD5UqvLQ2wRkqRqLURRAxw2PXrPDfjtlF1XjASqWsGbHEylKgCSawhN1S4AOawBUehpZMoAwBQBSUfn+yNMp1SBMAYByNCZXrF9YnZW77lLu2GoPyHvOjo4bscTFd2wygPr3Qd6OqZVmDOj02HC1Qz/lxlaEXkz2T81UpN6L9QxILh9DerGaXJKb7hhlHDR8dvEU4KRfiAVFviFgz+WOrXBAPu/CD9mgy/pmCyg3XsQ/HDpuPlsjg6VkAEUYB71A1+zxsWRRv/ZxxoAaSM8H+RnNGJDV0/vGQ/pupPQOBmYMSN5glfzlHx5H0+B2bcaA1K1Gsdz75jKmBAhT+M0qGwd1GArNGNDpUVQPXoMIUNWB2gd1ua9PBlCMbh76Mf4anQ43G7MG1EER7ua/q1Tj5IkBipWdUHMsRhEA4U81WmXXoxIB1MX1tC+3jRBA1SELSBxDrKcajbPrUxig3zdVR0BTfaoxEKDpPtUYCBAfInY3dsaA9HTH5HqxoWpQLyJAw2YnlAqgI38PaN6ts58zoHKxK/ibkDsRmjEgPh/EpxI7TAa1KbdHDTaS3gKgoOnEUZ/NDwRI1aC86UtR67MbUAMBkj6o6DZcnLEPkkPFdh/TqcuuP6UCqA/dOiB0Uu0GANX1YkWmnz1HCgOunomun55OB5B6dHaOF0j+3a9NlSIga04t1lKEaQNKtQYNNA6SqvdBsgrF80EBgCoV77lY7a2GmlXzjraTAYRp4Djp9uV6lCqg3kSApGItRZiADwqaD+ptumMCgLqJAEXOLuRWo1IjAeIBDvwLXd5JkRsHBHye7SKum+8NEKYo4yB44pHDI/x2txq/VKrqyGl387zeyPux4JvVSixG0wYEtacIqEGWhgIUwQepZlYzDjpu+Bf2HmCCP7DcCQPKl/tihS3tld8784YSzRgQ98Alf7I66nOxpAFtz4c/vIN/4Rq3m8dmyUIMdZ6s8lWH4wKqVMcOq1IBPojfpeYPsZsY4oMqlQgg3omLbyYHFNf4bn7KgAYplwAhCgEUQ8HBC5080LwBidFx0S28Y4z4oCCFdPNiCJ1gAFUaPijhl5ukAUjVIBoH+Q4UazVih+BNF1A/D1ftcqvnEZvOLVpKA1D/5f7yz4Yao+snQC0MbXpg32s15gao97UaM/NBndZqVN7NjwnIN09mLG6akzOjGLxWo7LcEQF9OGOTruE1qL9bjd58UGtAH6z/Gxhaq0sf1ONAsRugLs+b4wDqfa3GeL1YJECoWn4VYcRuPoYPaqCWX0XozUkHqP9e7MDfsVnWN7Fbfqc9PHHm9/N1j577+CrCVKdcIeoHXpCT+1/h0UcNmigg8C7i9Sa1i1m6fxVhsoC2upOqHUl3/irClAEJ95LglGsMhfggeOLT8TVCs+3F2H2GeN94wzeZJf9VBEytx0ElPFQ9rMMaWHpfRcCUwpRrpabqgwYr9yYA1Yy2bxtQg0dntw1IDRBb16Ch7uFbKFITE0OBLk0sFUXzQTkbTRKgOhXZAwGq1WH9CQGq1enR/+Qjm4wiAuqkkPKGShM3o4jlEaBE0sTNKGJ5BCiRNHEzilgeAUokTdyMIpZHgBJJEzejuYoAISJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIgIECIChGg4QGUf31Cs0HXUv72l86cbBwPUz0cmhxcBQhQNEH/lq3xVQZY9wJ98PSP8Ye3N5c+QAni6cvENI3988QY+451lizc8HJVt2fxtw3MW14XbsAorLRYgvfijgHAQuYahBJNXZq8OP24vEbCcL38GHCpCt8wUIJZrIX6HEniYfEhpsQCpgH0dvm/ec1oudnovf6MK8upGr3goMste4HhQ+eQKkNiifw8tLRYg/tJO/lO8lUhaKoyDP0wIXxnaxniOpcKxVdfE3sL+M8UGlhbNB8F3krbq1Z2ZZamoS8IbMOdw931gDeItJucr/SWOwgvomWxVIaVF7cVYdddvfXVqkNoLv4Y2MVZl/idRNKtBQaVFBSQNVL8bH6S2wDkFf0P5uPkLuKGtsxjnGpDyQUGlRXPSnEIpehLpOR9ML6b28nM6bryLqzDlvO/WOC56MQMIbGCdXlBp0WoQdz7itXGZiKrO7XGQ2lvwH3noWnSoDQYQH+bc/Ud0mA4gNQ4KKW12N6vdXq1xrRkBAh/U8e0115oRIDGk6PuOb06AoogAISJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIgIECIChIgAISJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIgIEKJkAMEL0uofG48SB5oKIBGVEhzGEE+pABKvse74JtkYSgSQRebw7Ku1iJGREcRnFb5iQlmcSOK4SgQQa2KKEDvxrWhxKoJYhfHqYCi+UUcSR1YqgKBCgI8GJGf9HSaIIJZhvDqcjm3sOw7Ip2QAnSEwVr+EsFTxn+xPFXcp437PV5HEMZUSoDOEGYqgXQ5IRRCrMF4ApDbqSOLISgSQqiQ8sFMDUn3+dQ1SGmBYkAgg1YsxzyJ8kIwQB7k+yK40AwwdEwHEmg5fjlLCuiD47oLssKCSyDBe3YvpCPXyZmqQ9W2qw/qva+lcVATx1ThIRIR3/pZVEyUDSCt4ZUIcESBEBAhReoASEwFCRIAQESBEBAgRAUJEgBARIEQECBEBQkSAEBEgRAQIEQFCRIAQESBEBAgRAUJEgBARIEQECNFvbNGeCiVZW+kAAAAASUVORK5CYII=" /><!-- --></p>
<hr />
</div>
</div>
<div id="example-3一元线性回归分析" class="section level2">
<h2><strong><em>Example 3：一元线性回归分析</em></strong></h2>
<p><span class="math inline">\(\hspace{1.5em}\)</span>一元线性回归分析是一种最常用、最简单的估计。</p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>R中自带的women数据集储存了15个年龄在30~39岁间的女性的身高和体重信息，我们将建立一元线性回归模型，试图通过身高预测体重。</p>
<div id="模型构建与解读" class="section level3">
<h3><strong>模型构建与解读</strong></h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>。散点图可以判断两个变量之间有无相关关系，并对变量间的关系形态做出大致的描述:</p>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>可以看到散点分布呈现线性规律，说明适合构建线性回归方程。</p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>接着构建模型,用summary函数查看拟合模型结果如下:</p>
<pre><code>## 
## Call:
## lm(formula = women$weight ~ women$height)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.7333 -1.1333 -0.3833  0.7417  3.1167 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -87.51667    5.93694  -14.74 1.71e-09 ***
## women$height   3.45000    0.09114   37.85 1.09e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.525 on 13 degrees of freedom
## Multiple R-squared:  0.991,  Adjusted R-squared:  0.9903 
## F-statistic:  1433 on 1 and 13 DF,  p-value: 1.091e-14</code></pre>
<p><span class="math inline">\(\hspace{1.5em}\)</span>可以看到，拟合结果<span class="math inline">\(adj.R^2\)</span>达到0.9903，这表明模型的解释性非常好;同时F检验的p-value为1433.0243,
1,
13远远小于0.05，说明模型通过了F检验；截距项和系数也都通过了t检验；height的系数为正，这表明随着身高的增长，体重也增长，符合客观事实。得到回归方程如下：</p>
<p><span class="math display">\[
weight=-87.5166667+3.45*height
\]</span></p>
<p>进一步用图像对模型进行回归诊断：</p>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>1）左上图为<strong>残差与拟合图</strong>，理论上散点应该散乱的分布在横线两侧，但是此图明显有一个曲线关系，说明我们的模型需要加入一个二次项。</p>
<p>2）右上图是一个<strong>正态Q-Q图</strong>，用于检验因变量的正态分布性，若服从，则散点应分布在一条直线上。可以看出该图是符合这一条件的，表明满足正态性假设。</p>
<p>3）左下图为<strong>齐方差检验</strong>，若满足其方差，则散点在水平线周围随机分布，此图满足齐方差检验。</p>
<p>4）右下图是<strong>独立性检验</strong>，即一个样本是否会影响另一个样本，我们的样本数据并不存在这样的问题。</p>
</div>
<div id="模型修正" class="section level3">
<h3><strong>模型修正</strong></h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>根据以上分析，我们对模型引入一个二次项，得到结果如下：</p>
<pre><code>## 
## Call:
## lm(formula = women$weight ~ women$height + squ_h)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.50941 -0.29611 -0.00941  0.28615  0.59706 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  261.87818   25.19677  10.393 2.36e-07 ***
## women$height  -7.34832    0.77769  -9.449 6.58e-07 ***
## squ_h          0.08306    0.00598  13.891 9.32e-09 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3841 on 12 degrees of freedom
## Multiple R-squared:  0.9995, Adjusted R-squared:  0.9994 
## F-statistic: 1.139e+04 on 2 and 12 DF,  p-value: &lt; 2.2e-16</code></pre>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>得到的<span class="math inline">\(adj.R^2\)</span>提高到0.9994,对比来看，模型拟合效果得到提升。</p>
<hr />
</div>
</div>
</div>
<div id="作业2024-09-14" class="section level1">
<h1>作业2024-09-14</h1>
<div id="习题3.4" class="section level2">
<h2><strong><em>习题3.4</em></strong></h2>
<div id="答" class="section level3">
<h3>答：</h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span><strong>Rayleigh
分布</strong>（瑞利分布）是概率论中的一种概率分布，其概率密度函数如下：
<span class="math display">\[
f(x)=\frac{x}{\sigma^2}e^\frac{-x^2}{2\sigma^2}
\]</span> 其中,<span class="math inline">\(\sigma\)</span>是分布的尺度参数。其分布函数为：
<span class="math display">\[
F(x)=1-e^\frac{-x^2}{2}
\]</span> <span class="math inline">\(\hspace{1.5em}\)</span>下面将选取<span class="math inline">\(\sigma\)</span>分别为<strong>0.5、1、2、4</strong>，从瑞利分布中生成随机样本。并利用<strong>直方图</strong>检验生成的样本的模式是否接近理论模式。由于瑞利分布为连续型分布，这里我们选用<strong>逆变换法</strong>。即首先生成一个0到1上的均匀分布U,再利用逆变换<span class="math inline">\(X=F_X^{-1}(U)\)</span>生成随机数X。最终得到结果如下图所示。</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># 设置随机种子 可复现</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co"># 定义生成瑞利分布样本的函数</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>rayleigh_samples <span class="ot">=</span> <span class="cf">function</span>(sigma, n) {</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>  U <span class="ot">=</span> <span class="fu">runif</span>(n) <span class="co">#生成[0,1]</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>  samples <span class="ot">=</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(U)) <span class="co">#逆变换</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>}</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co"># 选取一系列Rayleigh分布的参数sigma</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>sigmas<span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>)</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">8000</span>  <span class="co"># 样本数量</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co"># 循环生成样本并绘制直方图</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))  <span class="co"># 设置图形布局2×2</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="cf">for</span> (sigma <span class="cf">in</span> sigmas) </span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a>  {</span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a>  samples <span class="ot">=</span> <span class="fu">rayleigh_samples</span>(sigma, n)</span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a>  <span class="co"># 绘制直方图</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a>  <span class="fu">hist</span>(samples, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Rayleigh Distribution (sigma =&quot;</span>, sigma, <span class="st">&quot;)&quot;</span>), </span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;Value&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">border =</span> <span class="st">&quot;black&quot;</span>, <span class="at">prob =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a>  <span class="co"># 添加理论密度函数曲线</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a>  <span class="fu">curve</span>((x <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>)), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;deeppink&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a>  <span class="co"># 添加众数线</span></span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v =</span> sigma, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)  <span class="co"># 理论众数</span></span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&#39;Mode&#39;</span>, <span class="st">&quot;Density&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;deeppink&quot;</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a>}</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)) <span class="co"># 还原图形布局</span></span></code></pre></div>
<p><span class="math inline">\(\hspace{1.5em}\)</span>从上图我们可以看到，模拟的分布直方图和概率密度函数形状接近，这表明我们的模拟是可以接受的。同时通过几张图的对比可以看出，尺度参数
σ 的值越大，分布就越宽。</p>
<hr />
</div>
</div>
<div id="习题3.11" class="section level2">
<h2><strong><em>习题3.11</em></strong></h2>
<div id="答-1" class="section level3">
<h3>答：</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co"># 创建一个函数模拟并生成直方图</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>mix_hist<span class="ot">=</span><span class="cf">function</span>(n,p1, <span class="at">co=</span><span class="st">&#39;lightblue&#39;</span>) </span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  <span class="co">#参数n为生成随机样本数,p1为N(0,1)的混合概率,co为绘制颜色</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>{</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>  p<span class="ot">=</span><span class="fu">rbinom</span>(n,<span class="dv">1</span>,<span class="at">prob =</span> p1)</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>  <span class="co">#生成两个正态分布随机数 N(0,1)和N(3,1)</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>  x1<span class="ot">=</span><span class="fu">rnorm</span>(n) </span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>  x2<span class="ot">=</span><span class="fu">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>  x<span class="ot">=</span>p<span class="sc">*</span>x1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>x2 <span class="co">#混合</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>  <span class="co">#绘制直方图</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>  title<span class="ot">=</span><span class="fu">paste</span>(<span class="st">&#39;p1 = &#39;</span>,p1)</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>  <span class="fu">hist</span>(x,<span class="at">probability =</span> T,<span class="at">main =</span> title,<span class="at">col =</span> co)</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>  <span class="co">#理论密度函数</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>  densityplot<span class="ot">=</span><span class="cf">function</span>(x)</span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a>    {</span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a>      p1<span class="sc">*</span><span class="fu">dnorm</span>(x)<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">*</span><span class="fu">dnorm</span>(x,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a>  }</span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a>  y<span class="ot">=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">6</span>,<span class="fl">0.1</span>)</span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a>  <span class="fu">lines</span>(y,<span class="fu">densityplot</span>(y),<span class="at">col=</span><span class="st">&#39;deeppink&#39;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a>} </span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="fu">mix_hist</span>(<span class="dv">50000</span>,<span class="fl">0.75</span>)<span class="co">#p1=0.75的情况</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>))  <span class="co"># 设置图形布局3×3</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="cf">for</span> (p1 <span class="cf">in</span> <span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>)) <span class="co">#p1取值为0.1,0.2,……,0.9</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  {</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="fu">mix_hist</span>(<span class="dv">50000</span>,p1,<span class="st">&#39;gray&#39;</span>)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>  }</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)) <span class="co"># 还原图形布局</span></span></code></pre></div>
<p><span class="math inline">\(\hspace{1.5em}\)</span>由结果图看出，对于<span class="math inline">\(p1\)</span>的取值，当<span class="math inline">\(p1\)</span>值接近0.5时，分布更倾向于双峰。而更高的值，如
<span class="math inline">\(p1&gt;\)</span>
0.75，导致以第一个分量为中心的单峰分布；更低的值，如 <span class="math inline">\(p1&lt;\)</span>
0.3，导致以第二个分量为中心的单峰分布。</p>
<hr />
</div>
</div>
<div id="习题3.20" class="section level2">
<h2><strong><em>习题3.20</em></strong></h2>
<div id="答-2" class="section level3">
<h3>答：</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co"># 函数一：复合泊松-伽马过程模拟函数</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>com_poisson_gamma <span class="ot">=</span> <span class="cf">function</span>(lambda_rate, alpha, beta, T, num) </span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  {</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  X_T <span class="ot">=</span> <span class="fu">numeric</span>(num)  <span class="co"># 初始化结果向量</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  </span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num) {</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>    <span class="co"># 生成泊松过程中的事件数量</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>    N_T <span class="ot">=</span> <span class="fu">rpois</span>(<span class="dv">1</span>, lambda_rate <span class="sc">*</span> T)</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>    <span class="co"># 生成伽马分布的随机变量并求和</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>    <span class="cf">if</span> (N_T <span class="sc">&gt;</span> <span class="dv">0</span>) </span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>      {</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>      Y <span class="ot">=</span> <span class="fu">rgamma</span>(N_T, <span class="at">shape =</span> alpha, <span class="at">rate =</span> beta)</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>      X_T[i] <span class="ot">=</span> <span class="fu">sum</span>(Y)} </span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>      X_T[i] <span class="ot">=</span> <span class="dv">0</span>}</span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a>  }</span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>  <span class="fu">return</span>(X_T)</span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>}</span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a><span class="co"># 函数2：估计平均值和方差</span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a>mean_var <span class="ot">=</span> <span class="cf">function</span>(X_T, lambda_rate, alpha, beta, T) {  </span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a>  emp_mean <span class="ot">=</span> <span class="fu">mean</span>(X_T)  </span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a>  emp_var <span class="ot">=</span> <span class="fu">var</span>(X_T)  </span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a>  theo_mean <span class="ot">=</span> lambda_rate <span class="sc">*</span> T <span class="sc">*</span> (alpha <span class="sc">/</span> beta)  </span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a>  theo_var <span class="ot">=</span> lambda_rate <span class="sc">*</span> T <span class="sc">*</span> ((alpha <span class="sc">*</span> (alpha <span class="sc">+</span> <span class="dv">1</span>)) <span class="sc">/</span> beta<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> (alpha <span class="sc">/</span> beta)<span class="sc">^</span><span class="dv">2</span>)  </span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">emp_mean =</span> emp_mean,  </span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a>              <span class="at">emp_var =</span> emp_var,  </span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a>              <span class="at">theo_mean =</span> theo_mean,  </span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a>              <span class="at">theo_var =</span> theo_var))  </span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a>} </span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a></span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a><span class="co"># 参数设置</span></span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a>lambda_rate <span class="ot">=</span> <span class="fl">2.0</span>  <span class="co"># 泊松率参数</span></span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">2.0</span>        <span class="co"># 伽马分布形状参数</span></span>
<span id="cb12-36"><a href="#cb12-36" tabindex="-1"></a>beta <span class="ot">=</span> <span class="fl">1.0</span>         <span class="co"># 伽马分布率参数</span></span>
<span id="cb12-37"><a href="#cb12-37" tabindex="-1"></a>T <span class="ot">=</span> <span class="dv">10</span>             <span class="co"># 时间</span></span>
<span id="cb12-38"><a href="#cb12-38" tabindex="-1"></a>num <span class="ot">=</span> <span class="dv">50000</span>        <span class="co"># 模拟次数</span></span>
<span id="cb12-39"><a href="#cb12-39" tabindex="-1"></a></span>
<span id="cb12-40"><a href="#cb12-40" tabindex="-1"></a><span class="co"># 运行模拟</span></span>
<span id="cb12-41"><a href="#cb12-41" tabindex="-1"></a>X_T <span class="ot">=</span> <span class="fu">com_poisson_gamma</span>(lambda_rate, alpha, beta, T, num)</span>
<span id="cb12-42"><a href="#cb12-42" tabindex="-1"></a></span>
<span id="cb12-43"><a href="#cb12-43" tabindex="-1"></a><span class="co"># 估计平均值和方差</span></span>
<span id="cb12-44"><a href="#cb12-44" tabindex="-1"></a>results <span class="ot">=</span> <span class="fu">mean_var</span>(X_T, lambda_rate, alpha, beta, T)</span>
<span id="cb12-45"><a href="#cb12-45" tabindex="-1"></a><span class="co"># 计算实验的平均值和标准差</span></span>
<span id="cb12-46"><a href="#cb12-46" tabindex="-1"></a>emp_mean <span class="ot">=</span> results<span class="sc">$</span>emp_mean</span>
<span id="cb12-47"><a href="#cb12-47" tabindex="-1"></a>emp_sd <span class="ot">=</span> <span class="fu">sqrt</span>(results<span class="sc">$</span>emp_var)</span>
<span id="cb12-48"><a href="#cb12-48" tabindex="-1"></a></span>
<span id="cb12-49"><a href="#cb12-49" tabindex="-1"></a></span>
<span id="cb12-50"><a href="#cb12-50" tabindex="-1"></a><span class="co"># 创建一个数据框以便输出为表格</span></span>
<span id="cb12-51"><a href="#cb12-51" tabindex="-1"></a>result_table <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb12-52"><a href="#cb12-52" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">&quot;实验平均值&quot;</span>, <span class="st">&quot;理论平均值&quot;</span>, <span class="st">&quot;实验方差&quot;</span>, <span class="st">&quot;理论方差&quot;</span>),</span>
<span id="cb12-53"><a href="#cb12-53" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(results<span class="sc">$</span>emp_mean, results<span class="sc">$</span>theo_mean, results<span class="sc">$</span>emp_var, results<span class="sc">$</span>theo_var)</span>
<span id="cb12-54"><a href="#cb12-54" tabindex="-1"></a>)</span>
<span id="cb12-55"><a href="#cb12-55" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(result_table, <span class="at">caption =</span> <span class="st">&quot;复合泊松-伽马过程的模拟统计结果&quot;</span>)</span></code></pre></div>
<table>
<caption>复合泊松-伽马过程的模拟统计结果</caption>
<thead>
<tr class="header">
<th align="left">Statistic</th>
<th align="right">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">实验平均值</td>
<td align="right">40.02137</td>
</tr>
<tr class="even">
<td align="left">理论平均值</td>
<td align="right">40.00000</td>
</tr>
<tr class="odd">
<td align="left">实验方差</td>
<td align="right">119.22625</td>
</tr>
<tr class="even">
<td align="left">理论方差</td>
<td align="right">40.00000</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(\hspace{1.5em}\)</span>输出结果中，实验均值和理论均值接近，实验方差和理论方差也接近，这从<strong>数值上表明模拟的准确性较高</strong>。直方图显示了模拟数据的实际分布情况，而KDE曲线则是对这种分布的一种平滑近似。如果两者的形状近似，那么这表明模拟数据在整体上呈现出一种相对稳定的分布模式，没有出现异常或不一致的偏差，暗示了模拟过程的合理性。通过可视化，可以快速了解<strong>模拟数据的分布情况</strong>。</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># 绘制直方图</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">hist</span>(X_T, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">main =</span> <span class="st">&quot;Histogram of X(10)&quot;</span>, </span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;X(10) values&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co"># 绘制核密度估计曲线  </span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>density_curve <span class="ot">=</span> <span class="fu">density</span>(X_T, <span class="at">adjust =</span> <span class="dv">1</span>)  </span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="fu">lines</span>(density_curve, <span class="at">col =</span> <span class="st">&quot;deeppink&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)  </span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">max</span>(density_curve<span class="sc">$</span>x) <span class="sc">*</span> <span class="fl">0.9</span>, <span class="at">y =</span> <span class="fu">max</span>(density_curve<span class="sc">$</span>y) <span class="sc">*</span> <span class="fl">1.1</span>,   </span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>     <span class="at">labels =</span> <span class="st">&quot;Kernel Density Estimate&quot;</span>, <span class="at">pos =</span> <span class="dv">4</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)  </span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAHgCAMAAABNUi8GAAAAxlBMVEUAAAAAACsAAFUAKysAK1UAK4AAVYAAVaorAAArACsrAFUrKwArK1UrK4ArVYArVaorgKorgNRVAABVACtVKwBVKytVVStVVVVVgIBVgKpVgNRVqqpVqtRVqv+AKwCAVQCAVSuAgFWAgKqAqoCAqtSAqv+A1P+qVQCqVSuqVYCqgFWqqoCq1ICq1NSq1P+q/6qq//+t2ObUgCvUgFXUqlXUqoDU1KrU1NTU1P/U/6rU////FJP/qlX/1ID/1Kr//6r//9T///95+2MIAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAWNElEQVR4nO2da2PjuHVAaXdcO5mkqZVN0rRrpY/U2j4yGWmzaSvRI+n//6kSAJ8SKfEBkBfAOR88HkoCRPIYxPMiOQMIJln6CwDcAkFBNAgKokFQEA2CgmgQFESDoCAaBAXRICiIBkFBNAgKokFQEA2CgmgQFESDoCAaBAXRICiIBkFBNAgKokFQEA2CgmgQFESDoCAaBAXRICiIBkFBNAgKokFQEA2CgmgQFESDoCAaBAXRIGiD0zp52pt/n8v/1F7+j6+2M/zhJUl+pX77eEkev1b/HlcP7/odm/xLnH5Ikoff79UbHm1/C8EgaIPbgn77zroaaZLxqn/dJVmeKtPkTf/PfJFMy+IbKcw7Xi1/C8EgaIOGoFdsEuuC7pK8oCzUNJoWFv70XZILmr3xj+cftby7y4I9ZBC0QVsJ+uPn7Nn6d1+UnxlK0Z9+kyR/8/vywfvpXZubKfRv3yWPX4xVv3hXj+nk+afPycP35x9fsndV2ZQJ6CQLRdXD/b/yB32qj2a2PrzoL2H+YszP7H1v81+ahUDQBi2C7vSjVWlTCJofyb1Rhn2uDj/tU/NyJlgmqOFzobahSqAhaH78zfyq3r5LPv3JfKMsKVWi6gpp/nscIGiDvKZnantaUFUK7s9/0RVF84j/eMm9fdVVyOf9aVN4+/Tl/D/Zp/52r970qgV9VZ9Nvs/fr6knUHvEn43Q9SrGj7/a538yOr3iG2wiesYjaINrQTMzPv0pf7XQQ5eFG1OomhZ3Lmjx5P3rf35WCWTHTYH3tC8Mq5I5F/WC2qM/LYpT9WdRfqMWQeNpxyNog2tBzRFT49RiFLUApVbxe8O10z8XCRjNzM9K0HoCTUF1XvpdV+9uCNq0OmwQtEFLHfTbd6ZK+e+5HkXhlpV2b8XvdUGVZZ/+9a+rTkHrCTRd25U1UgQtQNAGrf2g3/7lc9Gk6VGCGpWO3YJ2lqDZGx9+m9R9rN5dbyQhaLx0ddSf/lDVOLvroFobXTCWjaQWQTvroFlb61WVv68tgpp/8rYTgkbLtaCZb3+vn/O64a3E6G7FFyXo0/7bursO2tWKT5O8MWU6qJqNJPXG7/OOehpJ8dJSgv5Qdmvqcclb/aBlHfRmI6neD1oTVD3g382Lumn2fPWN8qFOupkipu0R/xdVA/3Fl3M+bPQlHwj6R/OB7NAvv1y14j/9UfW0dwlaS6ASdJPbZx7y5XBmWc9Q00r0ZJG4BuMR1Ab2i7T0RjXz4yWeKiiCTmOj58plpWPL1JJJZKVk53h7GtETHkGnkY+7O2hV77qd30T0hEfQiXz7zUs+18kyx1VXS50JywBiQFAQDYKCaBAURIOgIBoEBdEgKIgGQUE0CAqiQVAQDYKCaBAURIOgIBoEBdEgKIgGQUE0CAqiQVAQDYKCaBAURIOgIBoEBdEgKIgGQUE0CAqiQVAQDYKCaBAURIOgIBoEBdEgKIgGQUE0CAqiQVAQDYKCaBAURIOgIBoEBdEgaElSsfRXgRLuRUmyLeCiyIF7UZILelAs/V2gAEFLklJPDJUDgpYkuZ/ZIx5FxYCgJYn209RBMVQKCFqSFH5uVUM++50GvQC4ASVJ4ee2qI3SoF8ebkBJ6acRdIugEuAGFFR+bssOJwRdHG5AQeVnJegBQZeGG2BQbaJLQZWhXJ+F4QZoDq2CbhF0cbgBCt3r2SLolt7QpYldUDN7yfR5IqhAohe07FDatgmKoUuDoPcExdBFQdDCz3ZBEwxdFgStRuBbBT1j6KIg6LYxAn8t6BlBlwRBL0bgLwUt2/ixX6mFiP2y3xW0akMt/VXjJPbLnlxNEbkWlHlNCxL7ZUdQ4cR+2RFUOLFf9utJdi2CMjN0OWK/7AgqnMgve83PW4Jumbq8FJFfdgSVTtyXvT5L+aagTF1eirgvO4KKJ+rLfjic+wrKxNCFQFAEFU3MgjYXIt0RFEOXAUERVDQRC6qN6y9ogqFLgKAIKpp4BTW+DRCUqfVLgKBDBMXQ2YlW0Fy2IYJShC5AnIJWC40GCYqh8xOpoC1LORFUJAg6RFAMnZ0RgqZJ8vBu/5vMSdKylLOnoBg6L8ME3STJ68cv9+fj6s3R95mH0YJShM7NIEE3T/vzRpeeu+w3j2lbKXdX0FqkxqW/f0QMuda63Pz4mRI0ffzq6hvNwShBzT8Erp+XYYK+Zj9P/3v2vQRtXSnXU1BWf8zLoGu9K8pNo6q3TBKUyfWzMuxa70zzPU28biO17peAoDKJ8VpPFJSZoXMSoaCNhR7jBMXQ2Rgm6Glt+lq8bsNPFpQidEaGNZKSvG2UJv42krq2RBogKHOX52OIoKd1qaXH3UwI6hWDO+oNXnbU14aCJgrKiOdsxFSCasVMrE8E9YWBddC8CL2sgyYl1r6YA5JtsefMZEExdC6GGXVcGQ07y0/pgh5ubCo34GA1IX/pcwoey1dY9A1L7mwqN+ggW3/MA4KOFpTA9XMw8grvOlrxom9Y20KP0YIaQ0WfbxDEVYLaFJTA9bOAoKMFZWboHEQl6P1dDxFUGpYni4i+YbYFZWboDFieLCL6hiGoh1ge6hR9w/rsejjsIONJzrE8WQRBwS6UoFMExVDn2JksMi65mem3LSeCyiKiySIuBGXqsmsi6gdFUB9B0GkHmRjqmHgEbV8Nj6DCQdCJgmKoWxAUQUUTjaAd4RqmCsrqD8cg6OSDxSz9pc8wTBAUQUWDoNMPsn7OIbEI2hXwBkGFg6AWDrLA0x0IiqCiQVAEFU0kguredGeCsgLZHQiKoKJBUCsHWYHsijgENePlCOohCIqgogle0KQ2n8OdoCyRd0X4guYFXIdsCCqcKAS9ERUUQYWDoJYOMm/ZDQiKoKJBUAQVTQyC3gpba01QDHUDgiKoaBDU2kEMdQGCIqhoIhD0ZlxlBBUOglo7SAgHFyAogooGQRFUNOELejvwt01BMdQBCIqgokFQBBUNgloUFEPtE7ygdwJ/WxS0mrm/9DmHBIJaPUgIB9sgKIKKBkERVDShC1rzcw5BiTFiGwRFUNEgqOWDhHCwS3kxj6vk2WJyUkBQz6ldzF2SdG1iPCY5EdQ3R5pLUFbI26R5MSc7Ku3ezC8oIRzscnkxlaKPX7verV7VW8bvOt4j7d4sICir56zSMCrV/p3WXdvB7x7es7qqqqp6Imhj7xkE9ZHKqKyVlBgz0w77TutX/TN7F4LeOIihFqm14rPi8TbHlX68nzdPewRF0HmoBP218bOr+DwXJWjG5hlBbx3EUHtcCdqlXv21rDbghaDNvWcQ1EdyozZJya1upp1pw2dlKYIi6CxclaCWkhPBUoIys94eQY/FI6j/DDPqtDbVgM56qihBLzZHQlAfMUYdV6+qG/S2fKoKmldQ066aKoJqQTHUGkOMKruZMlU7BpsQFEHtMsSooqP+3N1bKkXQts2R5hQUQ21RH+p8VZNBusbhz16VoMqWy82RENRHKqM2T/uPl+fz5sa05aIb9KoOWvWiuviOI1hWUFbI26M2Fv+Wefd2a6jTTChRdBazUu7IsoJut6zvtEVD0E0m562hzgHJLUzSsvcMgvpI7RH/fFw97c10TwvJLQuChkJjPujD+2ndz0/ps5mWF5QFyHYIdKgzadnaA0F9BEERVDTVJbw7zj4suWURICgr5K1QayT1MNObySIIGgq1bqb7C+L9mSxSxVVGUL9p9IPewaehTgGCEsLBBuUl7NHB5NFkkbbA9AjqI9UlTJN7Rag/JegBQUOhHt2ux4Tljski18ktS2tY5dkFZYG8BYYZ5ctkEQQNhjA76hE0GGpGZcXj034zLUKoDEHrMe2WFBRDp1NrJD2879RspgDigyJoONS6mV512zyE+aAIGg6Njnol6M0Z9f2TW5JGyLBFBSUIzmSuStDNjVVzA5JbEgQNiMs66O5ud33P5BYEQQOi2YpPkrtRbHsntxjNiEzLCsry46kE2A+KoCGBoAgqmoux+EktpDOCXgmKoRMpjNrk+x9N3GtOgKAXIcMQ1G9yo9KicfTx4nsrHkGDwhhVm618KzZT3+QWRZigGDqNMoBtccD3oU7jA4KGQiHo3cUcQ5JbEnGCYugkEBRBRROSoLW4nAgaCkEJum0JGbasoEn1R7PklfGYQtAqRjKCWhRU/yQS4wRCGupMti0BbwQIShyxCSAogooGQRFUNAg6g6DEERtPWIK2hAxDUL9B0DkEJUzTaBAUQUUTlKBtMe1kCMoK+bEgKIKKBkHnERRDRxKSoK0x7RDUbxB0JkGJ4TAOBJ1PUAwdQUCC1vyUKOgZQ8eAoLMJyszlMSDofIJi6AjCEbQetRZBgwFBZxQUQ4eDoHMJalYnHVidNIxgBG1ErZUoqP7J1OWhIOisgjIzdCgIOregTLwbRCiCNoOCyhWUmaEDQdCZBWXWyDAQFEFFE4igF0FBJQuKoYNA0AUExdD+IOjsgjIzdAhDjOoRYmwBQWtBFz0RlBHPAQwy6rS+F/puCUG3RUARjwTF0L4MM6q22YKN5KzgoaAUof0ZaFR6Z6/ZZQS9CgoqXVAM7Y3/jSQEDRoEXURQDO1LCIJex1yULWit32H+y+UbQxtJd+LYI2jflwlc349Bl6jcajbt2nMWQRHULkMu0WldbZjYsW/3EoK2xFz0QFAm1/dj2EjS3d2UEBRB7UIJupSgrP7oxcA6aF6EXtZBqzF6a1+sN20xFxE0GIZdomK6SEf5uUgJ6q2grP7og//9oAgaNN4L2hpz0Q9BmVvfg5FG7cS04hE0bChBXR689xkMvYvvgtYjMiFogCCoy4MIOhnPJ4s0At74Jyjr5+7i92SRA4KGjt9Dnc14Ih4KysTle/g9WQRBg8frEvQiXIOPgmLoHexMFhmX3GQQNHy8niziv6CsTrqHz/2gpvDxWtCtjiW23TLxrgsEdXmw12cOzK2/gaeC1pfuulfIceoIegNfBd22hGvwVVDm1t8AQV0eRNDJ+Cvo9Wp4bwVlbn03COryIIJOBkFdHuz9Gbrru/BW0JbV8F4LiqHtIKjLg/0/g6Ad+Cpo22JjnwVlZmgHCOry4CBBMbQNTwVtXcvptaBs/dEOgro8OERQDG0FQV0eHCQohrbhp6A1P0MR1Mx+OTA19AIEdXlw6GeYeXeFl4LWozUEJag2FEHrIKjLg8M/c2BYvomPgjaiNQQmKPNGLkBQlwfHfIamfAMPBW1GawhQUAyt4Z+gh8AFxdAGPgp6DltQhuXreCVo21LOAAVlSKmGX4Jui4n0YQuKoRW+CTpha3iPBMXQEs8EPcQgaDUs7/Rq+oF3gopQaIbUGfQ0+CXopH1j/RKUQU8Dgro8OCmhw4GaqGeCTtuW0zdBMVThk6CHyASlR/Tsm6DyFHKbOv1NPgk6dVM5DwU1/U1RrwPxR9BDhIKqH4e414F4I+j0TeU8FTTyLlGPBJ0ajt5bQbcxt+Z9EdTCjjP+ChqzoX4Imt8gwQq5Tj1aRb0QtLg7ohVynPoh0m57+YKWATem7jjjt6DmzzQ+Rz0Q9GApVq3fghaT8GJzVLygh9YBTokKzZN6bI5KF7TupycKuU49L0cjGV4ado6ntXnUPH61ktx9Dhaj3IQiqPqhFY2i937gfvH5NvEz7Rd/ONgMIhKSoEZRBG1yWpda7jp2jLd2yWrzJNzdZJsJzZ96HFXRIUYdV2/Fr2nHQ96eoNui9umxQo5Tj6K1JLYELVtHPivkNvW8997WJZfJwDpoXoQ6r4PWGu8+K+Ra0Lz33tJFF8kwo44r04rvKD+tCdre+emfQq4FrTrv7Vx3gUjsBz24mZscoKDmn0OJjasvDHmCHi46l3xWaB5Bt3VHQ9NUVEd9fZBkppvsc+pXB0O0VFBHfXFpZ73JPqfenuX5EFRxKqObqbqes99Pj1Nvz7Ix78l/URfvqK9dQ8eDRpEI2nz5SlTfpHVZgt68OE2k3E+vUh+Q5XWJuhQuBe3uqE9KhvuZwEI4FbELp4Le76gHsEsMM7bAYxAURDNS0F1nVz2ATShBQTQICqJBUBCN5ckiAHaxPFkEwC6WhzoB7GJ5sgiAXTwtQZcbwIae2LrTQ958f1XnXMzW+TBXRpyQlXTETBbhfkrPaBlBxcD9lJ4RgoaVESfkOJ2Z4X5KzwhBw8qIE3KczsxwP6VnhKBhZcQJOU5nZrif0jOKXFCIBQQF0SAoiAZBQTQICqJBUBANgoJoEBREg6AgGgQF0SAoiAZBQTQICqLxTFAde0evKE2T5OHdbWYbvTbQcUYfL0nyfHafz3mXXbk31xl9/PxrI4vpefkl6Gmdne5O3dA0+yV1a2iqF686zijN8jiuZjihnUpfGeoyo+NKB/Qos7CQl1+CfryoMmD3+NXEkNg8O8zruFKCOs7IJD/DCZ3WzyZ9lxmlJqxcmYWNvPwS1JD9TZamustl9/SHTFDHGX38LC9eXJ9QKajDjNLkVYdEKrOwkZePgm6yU9c31mWEqCwHVQd1nFH6+OeVrlQ7P6HiEe82IyNokYWNvDwUVMXdMRUbh3U29XRSgjrOaKeeiap0c35CRXvFbUZaxjILG3n5J2hatJGc3k8VHW0OQR/yMsb5CWWPnezZ6/pPG0HzuGWun4g6/Rke8aZ+ltXVnJ9QWS/kEe+UPMiz6zbFLo8h+OY4I3Pzshvp+oTKwsxtRtE3kooAkDN0M5kS1HFGJiZw6r6bybjiPKM08m4mVYkyzNBRb0aSHGe0K/4IXJ9QUQd1m1EaeUd9/uRVp7yba6jTcUZpMXbr+oQ2c2SU1zfLLKbn5ZegEB0ICqJBUBANgoJoEBREg6AgGgQF0SAoiAZBQTQICqJBUBANgoJoEBREg6AgGgQF0SAoiAZBQTQICqJBUBANgoJoEBREg6AgGgQF0SAoiAZBQTQICqJBUBANgo7j40UHbjLh9k5rHXOvuQfL8dcdQYlMRDvoB4KOJA+kq8Pt7XSAwas9WIzCVyDoEBB0LJs8unwZ5PNiD5aiXL0CQYeAoGNR22+Z4MEmMPvlHiwm9mcZOjYrUzdmr7dMUO2o/rHLgyKqDecSxL0GQUfz8fIP2r0yhHAzQHsRdjvfoehpr96mNk2oC6r+r6oJ2uIUQ69B0PHk8fKPqzzsc3OLi6Ls1KVp9h7daFKHaoKaj6pNPlxuSeY1CDqa01pXOqs65aWgubnq9bTcW7UhqDmcWZs3sOAKBB3N5un/1C6wRUF5/Ygvitbs2a6iiWfVzcf/bpagabGZiNnGmSf8NQg6FlVj1H1NzRK01kgqBFX7Hb6ZFy4e8c0NBjaug+77CIKO5ONFt310o6deB61tvVIUrcfV77JX8rb+W1n31E/2eqFJ/1MLCDqO0zqvf6otE+ut+NrWK2X5uFG7N5rCMytyMw9P66d99lA3rXhleblpC1yAoKPQdinUzqFFE/xqD5ZiKMn0H+njmYyqoMxMTf6p6Ac1Rav7bXW8BEGn0/Fo5oltAwS1wK51s7+usXgYAoJaoHXUvXM2EwwBQUE0CAqiQVAQDYKCaBAURIOgIBoEBdEgKIgGQUE0CAqiQVAQDYKCaBAURIOgIBoEBdEgKIgGQUE0CAqiQVAQDYKCaBAURPP/Gusud/Ihp7kAAAAASUVORK5CYII=" /><!-- --></p>
<hr />
</div>
</div>
</div>
<div id="作业2024-09-23" class="section level1">
<h1>作业2024-09-23</h1>
<div id="习题5.4" class="section level2">
<h2><strong><em>习题5.4</em></strong></h2>
<p><span class="math inline">\(\hspace{1.5em}\)</span>编写一个函数来计算Beta(3,3)的蒙特卡罗估计数，并使用该函数来估计x
=0.1,0.2，…，0.9的F(x)。将估计值与R中的pbeta函数返回的值进行比较。</p>
<div id="答-3" class="section level3">
<h3>答：</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">10000</span>  <span class="co"># 蒙特卡罗样本数量</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>a <span class="ot">=</span> <span class="dv">3</span>      <span class="co"># Beta 分布的第一个形状参数</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>b <span class="ot">=</span> <span class="dv">3</span>      <span class="co"># Beta 分布的第二个形状参数</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co"># Monte Carlo 估计 CDF 的函数</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>mc.cdf.beta <span class="ot">=</span> <span class="cf">function</span>(p, n, shape1, shape2) </span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>  {</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>  <span class="cf">if</span> (p <span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">||</span> p <span class="sc">&gt;=</span> <span class="dv">1</span>) <span class="fu">return</span>(<span class="dv">0</span>)  <span class="co"># 确保 p 在 (0, 1) 范围内</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>  samples <span class="ot">=</span> <span class="fu">rbeta</span>(n, shape1, shape2)  <span class="co"># 生成 n 个 Beta 分布的样本</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(samples <span class="sc">&lt;=</span> p))  <span class="co"># 计算小于等于 p 的比例</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>}</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co"># 要估计的 x 值</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>x_values <span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co"># 计算 Monte Carlo 估计和精确 CDF</span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>mc_estimates <span class="ot">=</span> <span class="fu">sapply</span>(x_values, <span class="cf">function</span>(x) <span class="fu">mc.cdf.beta</span>(x, n, a, b))</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>exact_values <span class="ot">=</span> <span class="fu">sapply</span>(x_values, <span class="cf">function</span>(x) <span class="fu">pbeta</span>(x, a, b))</span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a>  <span class="at">x =</span> x_values,</span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a>  <span class="at">Monte_Carlo_Estimate =</span> mc_estimates,</span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a>  <span class="at">Exact_Value =</span> exact_values</span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a>)</span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(result, <span class="at">caption =</span> <span class="st">&quot;Monte Carlo 估计和精确 CDF比较表&quot;</span>,<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table>
<caption>Monte Carlo 估计和精确 CDF比较表</caption>
<thead>
<tr class="header">
<th align="right">x</th>
<th align="right">Monte_Carlo_Estimate</th>
<th align="right">Exact_Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.1</td>
<td align="right">0.009</td>
<td align="right">0.009</td>
</tr>
<tr class="even">
<td align="right">0.2</td>
<td align="right">0.060</td>
<td align="right">0.058</td>
</tr>
<tr class="odd">
<td align="right">0.3</td>
<td align="right">0.161</td>
<td align="right">0.163</td>
</tr>
<tr class="even">
<td align="right">0.4</td>
<td align="right">0.312</td>
<td align="right">0.317</td>
</tr>
<tr class="odd">
<td align="right">0.5</td>
<td align="right">0.500</td>
<td align="right">0.500</td>
</tr>
<tr class="even">
<td align="right">0.6</td>
<td align="right">0.688</td>
<td align="right">0.683</td>
</tr>
<tr class="odd">
<td align="right">0.7</td>
<td align="right">0.837</td>
<td align="right">0.837</td>
</tr>
<tr class="even">
<td align="right">0.8</td>
<td align="right">0.942</td>
<td align="right">0.942</td>
</tr>
<tr class="odd">
<td align="right">0.9</td>
<td align="right">0.990</td>
<td align="right">0.991</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># 绘制对比图</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">ggplot</span>(result, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Monte_Carlo_Estimate, <span class="at">color =</span> <span class="st">&quot;蒙特卡罗估计&quot;</span>), <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Monte_Carlo_Estimate, <span class="at">color =</span> <span class="st">&quot;蒙特卡罗估计&quot;</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Exact_Value, <span class="at">color =</span> <span class="st">&quot;精确值&quot;</span>), <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Exact_Value, <span class="at">color =</span> <span class="st">&quot;精确值&quot;</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Beta(3, 3) CDF 蒙特卡罗估计与精确值对比&quot;</span>,</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;x 值&quot;</span>,</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;CDF 值&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;蒙特卡罗估计&quot;</span> <span class="ot">=</span> <span class="st">&quot;deepskyblue&quot;</span>, <span class="st">&quot;精确值&quot;</span> <span class="ot">=</span> <span class="st">&quot;deeppink&quot;</span>)) <span class="sc">+</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span>  <span class="co"># 增加基础字体大小</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">18</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),  <span class="co"># 标题居中并加粗</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),  <span class="co"># X轴标题加粗</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)   <span class="co"># Y轴标题加粗</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a>  )</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>我们通过<strong>数值</strong>和<strong>图像可视化</strong>形式分别进行对比，得到具体结果如上表和上图所示。可以看到，模拟结果很好，与pbeta函数返回的值相差不大。</p>
<hr />
</div>
</div>
<div id="习题5.9" class="section level2">
<h2><strong><em>习题5.9</em></strong></h2>
<div id="答-4" class="section level3">
<h3>答:</h3>
<div id="rayleigh分布" class="section level4">
<h4>Rayleigh分布</h4>
<p><span class="math inline">\(\hspace{1.5em}\)</span>Rayleigh分布的概率密度函数为：</p>
<p><span class="math display">\[
f(x)=\frac{x}{\sigma^2}e^\frac{-x^2}{2\sigma^2},x\geq0,\sigma&gt;0
\]</span> 使用逆变换法生成随机样本。</p>
</div>
<div id="对立变量" class="section level4">
<h4>对立变量</h4>
<p><span class="math inline">\(\hspace{1.5em}\)</span>对立变量技术涉及生成两个负相关的变量<span class="math inline">\(X_1\)</span>和<span class="math inline">\(X_2\)</span>。设U是均匀分布在[0,1]的随机变量，使用U生成<span class="math inline">\(X_1\)</span>，使用1-U生成<span class="math inline">\(X_2\)</span></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># 函数：生成Rayleigh分布样本</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>rayleigh_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, n_samples) {</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_samples)  <span class="co"># 生成均匀分布随机数</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(U))       <span class="co"># 使用U生成X1</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>  X2 <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> U))   <span class="co"># 使用(1-U)生成X2</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">X1 =</span> X1, <span class="at">X2 =</span> X2))</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>}</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="co"># 函数：计算方差减少并绘制图形</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>variance_reduction_and_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, n_samples) </span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>  {</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">rayleigh_sample</span>(sigma, n_samples)</span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> samples<span class="sc">$</span>X1</span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>  X2 <span class="ot">&lt;-</span> samples<span class="sc">$</span>X2</span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>  </span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>  <span class="co"># 计算对立变量的平均</span></span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a>  X_plus_antithetic <span class="ot">&lt;-</span> (X1 <span class="sc">+</span> X2) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a>  </span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a>  <span class="co"># 独立变量生成</span></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a>  independent_X1 <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="fu">runif</span>(n_samples)))</span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a>  independent_X2 <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="fu">runif</span>(n_samples)))</span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a>  X_plus_independent <span class="ot">&lt;-</span> (independent_X1 <span class="sc">+</span> independent_X2) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a>  </span>
<span id="cb16-24"><a href="#cb16-24" tabindex="-1"></a>  <span class="co"># 计算方差</span></span>
<span id="cb16-25"><a href="#cb16-25" tabindex="-1"></a>  var_antithetic <span class="ot">&lt;-</span> <span class="fu">var</span>(X_plus_antithetic)</span>
<span id="cb16-26"><a href="#cb16-26" tabindex="-1"></a>  var_independent <span class="ot">&lt;-</span> <span class="fu">var</span>(X_plus_independent)</span>
<span id="cb16-27"><a href="#cb16-27" tabindex="-1"></a>  </span>
<span id="cb16-28"><a href="#cb16-28" tabindex="-1"></a>  <span class="co"># 计算方差减少百分比</span></span>
<span id="cb16-29"><a href="#cb16-29" tabindex="-1"></a>  percent_reduction <span class="ot">&lt;-</span> (var_independent <span class="sc">-</span> var_antithetic) <span class="sc">/</span> var_independent <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb16-30"><a href="#cb16-30" tabindex="-1"></a>  </span>
<span id="cb16-31"><a href="#cb16-31" tabindex="-1"></a>  <span class="co"># 绘制直方图</span></span>
<span id="cb16-32"><a href="#cb16-32" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))  <span class="co"># 设置图形区域为1行2列</span></span>
<span id="cb16-33"><a href="#cb16-33" tabindex="-1"></a>  </span>
<span id="cb16-34"><a href="#cb16-34" tabindex="-1"></a>  <span class="fu">hist</span>(X_plus_independent, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">col =</span> <span class="st">&#39;deepskyblue&#39;</span>, </span>
<span id="cb16-35"><a href="#cb16-35" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">&#39;独立变量生成的Rayleigh样本&#39;</span>, </span>
<span id="cb16-36"><a href="#cb16-36" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&#39;样本值&#39;</span>, </span>
<span id="cb16-37"><a href="#cb16-37" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&#39;频率&#39;</span>, </span>
<span id="cb16-38"><a href="#cb16-38" tabindex="-1"></a>       <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(X_plus_independent, X_plus_antithetic)),</span>
<span id="cb16-39"><a href="#cb16-39" tabindex="-1"></a>       <span class="at">probability =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-40"><a href="#cb16-40" tabindex="-1"></a>  </span>
<span id="cb16-41"><a href="#cb16-41" tabindex="-1"></a>  <span class="fu">hist</span>(X_plus_antithetic, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">col =</span> <span class="st">&#39;deeppink&#39;</span>, </span>
<span id="cb16-42"><a href="#cb16-42" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">&#39;对立变量生成的Rayleigh样本&#39;</span>, </span>
<span id="cb16-43"><a href="#cb16-43" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&#39;样本值&#39;</span>, </span>
<span id="cb16-44"><a href="#cb16-44" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&#39;频率&#39;</span>, </span>
<span id="cb16-45"><a href="#cb16-45" tabindex="-1"></a>       <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(X_plus_independent, X_plus_antithetic)),</span>
<span id="cb16-46"><a href="#cb16-46" tabindex="-1"></a>       <span class="at">probability =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-47"><a href="#cb16-47" tabindex="-1"></a></span>
<span id="cb16-48"><a href="#cb16-48" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;独立变量&quot;</span>, <span class="st">&quot;对立变量&quot;</span>), </span>
<span id="cb16-49"><a href="#cb16-49" tabindex="-1"></a>         <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;deepskyblue&quot;</span>, <span class="st">&quot;deeppink&quot;</span>))</span>
<span id="cb16-50"><a href="#cb16-50" tabindex="-1"></a>  </span>
<span id="cb16-51"><a href="#cb16-51" tabindex="-1"></a>  <span class="fu">return</span>(percent_reduction)</span>
<span id="cb16-52"><a href="#cb16-52" tabindex="-1"></a>}</span>
<span id="cb16-53"><a href="#cb16-53" tabindex="-1"></a></span>
<span id="cb16-54"><a href="#cb16-54" tabindex="-1"></a><span class="co"># 示例使用</span></span>
<span id="cb16-55"><a href="#cb16-55" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">1.0</span>  <span class="co"># 参数</span></span>
<span id="cb16-56"><a href="#cb16-56" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 样本数量</span></span>
<span id="cb16-57"><a href="#cb16-57" tabindex="-1"></a>reduction <span class="ot">&lt;-</span> <span class="fu">variance_reduction_and_plot</span>(sigma, n_samples)</span>
<span id="cb16-58"><a href="#cb16-58" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">σ =&quot;</span>, sigma), <span class="at">outer =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;方差减少百分比: %.2f%%</span><span class="sc">\n</span><span class="st">&quot;</span>, reduction))</span></code></pre></div>
<pre><code>## 方差减少百分比: 94.71%</code></pre>
<hr />
</div>
</div>
</div>
<div id="习题5.13" class="section level2">
<h2><strong><em>习题5.13</em></strong></h2>
<div id="答-5" class="section level3">
<h3>答：</h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>对于重要性分布<span class="math inline">\(f_1\)</span>,由于Gamma分布在 (1,<span class="math inline">\(\infty\)</span>)上有较好的支持，因此选择参数为<span class="math inline">\(\alpha\)</span>=3,<span class="math inline">\(\beta\)</span>=1的Gamma分布，即： <span class="math display">\[
f_1(x) = \frac{\beta^\alpha}{\Gamma(\alpha)} x^{\alpha-1} e^{-\beta x}
= \frac{1^3}{2} x^{3-1} e^{-x} = \frac{1}{2} x^2 e^{-x}
\]</span></p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>对重要性分布 <span class="math inline">\(f_2\)</span>，我们可以选择正态分布，例如 <span class="math inline">\(N(\mu=2, \sigma^2=1)\)</span>，在 (1,<span class="math inline">\(\infty\)</span>)
区间上也是合适的。正态分布的概率密度函数为： <span class="math display">\[
f_2(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{(x-2)^2}{2}}
\]</span></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># 加载必要的库</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="co"># 设置随机种子以确保结果可重复</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co"># 定义目标分布 g(x)</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>  (x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>}</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="co"># 定义重要性分布 f1 (Gamma 分布) 和 f2 (正态分布)</span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>  (x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x)) <span class="sc">/</span> <span class="dv">2</span> <span class="co"># Gamma(3, 1) 的 PDF</span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>}</span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>  <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="co"># N(2, 1) 的 PDF</span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a>}</span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a><span class="co"># 重要性采样函数</span></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a>importance_sampling <span class="ot">&lt;-</span> <span class="cf">function</span>(g, f, n) {</span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">identical</span>(f, f1)) {</span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a>    samples <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, <span class="at">shape =</span> <span class="dv">3</span>, <span class="at">rate =</span> <span class="dv">1</span>)</span>
<span id="cb19-21"><a href="#cb19-21" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">identical</span>(f, f2)) {</span>
<span id="cb19-22"><a href="#cb19-22" tabindex="-1"></a>    samples <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb19-23"><a href="#cb19-23" tabindex="-1"></a>  }</span>
<span id="cb19-24"><a href="#cb19-24" tabindex="-1"></a>  <span class="co"># 计算权重</span></span>
<span id="cb19-25"><a href="#cb19-25" tabindex="-1"></a>  weights <span class="ot">&lt;-</span> <span class="fu">g</span>(samples) <span class="sc">/</span> <span class="fu">sapply</span>(samples, f)</span>
<span id="cb19-26"><a href="#cb19-26" tabindex="-1"></a>  <span class="co"># 计算估计值和方差</span></span>
<span id="cb19-27"><a href="#cb19-27" tabindex="-1"></a>  estimate <span class="ot">&lt;-</span> <span class="fu">mean</span>(weights)</span>
<span id="cb19-28"><a href="#cb19-28" tabindex="-1"></a>  variance <span class="ot">&lt;-</span> <span class="fu">var</span>(weights) <span class="sc">/</span> n</span>
<span id="cb19-29"><a href="#cb19-29" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">estimate =</span> estimate, <span class="at">variance =</span> variance, <span class="at">samples =</span> samples))</span>
<span id="cb19-30"><a href="#cb19-30" tabindex="-1"></a>}</span>
<span id="cb19-31"><a href="#cb19-31" tabindex="-1"></a></span>
<span id="cb19-32"><a href="#cb19-32" tabindex="-1"></a><span class="co"># 执行重要性采样</span></span>
<span id="cb19-33"><a href="#cb19-33" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb19-34"><a href="#cb19-34" tabindex="-1"></a>result_f1 <span class="ot">&lt;-</span> <span class="fu">importance_sampling</span>(g, f1, n_samples)</span>
<span id="cb19-35"><a href="#cb19-35" tabindex="-1"></a>result_f2 <span class="ot">&lt;-</span> <span class="fu">importance_sampling</span>(g, f2, n_samples)</span>
<span id="cb19-36"><a href="#cb19-36" tabindex="-1"></a></span>
<span id="cb19-37"><a href="#cb19-37" tabindex="-1"></a>results_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb19-38"><a href="#cb19-38" tabindex="-1"></a>  <span class="at">Distribution =</span> <span class="fu">c</span>(<span class="st">&quot;Gamma&quot;</span>, <span class="st">&quot;Normal&quot;</span>),</span>
<span id="cb19-39"><a href="#cb19-39" tabindex="-1"></a>  <span class="at">Estimate =</span> <span class="fu">c</span>(result_f1<span class="sc">$</span>estimate, result_f2<span class="sc">$</span>estimate),</span>
<span id="cb19-40"><a href="#cb19-40" tabindex="-1"></a>  <span class="at">Variance =</span> <span class="fu">c</span>(result_f1<span class="sc">$</span>variance, result_f2<span class="sc">$</span>variance)</span>
<span id="cb19-41"><a href="#cb19-41" tabindex="-1"></a>)</span>
<span id="cb19-42"><a href="#cb19-42" tabindex="-1"></a></span>
<span id="cb19-43"><a href="#cb19-43" tabindex="-1"></a><span class="co"># 输出结果为表格</span></span>
<span id="cb19-44"><a href="#cb19-44" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(results_df, <span class="at">caption =</span> <span class="st">&quot;重要性采样结果&quot;</span>)</span></code></pre></div>
<table>
<caption>重要性采样结果</caption>
<thead>
<tr class="header">
<th align="left">Distribution</th>
<th align="right">Estimate</th>
<th align="right">Variance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Gamma</td>
<td align="right">0.496716</td>
<td align="right">0.0000239</td>
</tr>
<tr class="even">
<td align="left">Normal</td>
<td align="right">1.116925</td>
<td align="right">0.0907373</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># 可视化目标分布和重要性分布</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>x_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>target_density <span class="ot">&lt;-</span> <span class="fu">g</span>(x_vals)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>gamma_density <span class="ot">&lt;-</span> <span class="fu">f1</span>(x_vals)</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>normal_density <span class="ot">&lt;-</span> <span class="fu">f2</span>(x_vals)</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="co"># 创建数据框用于 ggplot</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>data_plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rep</span>(x_vals, <span class="dv">3</span>),</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>  <span class="at">density =</span> <span class="fu">c</span>(target_density, gamma_density, normal_density),</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>  <span class="at">distribution =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Target (g)&quot;</span>, <span class="st">&quot;Gamma (f1)&quot;</span>, <span class="st">&quot;Normal (f2)&quot;</span>), <span class="at">each =</span> <span class="fu">length</span>(x_vals))</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>)</span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a><span class="co"># 绘制图像</span></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a><span class="fu">ggplot</span>(data_plot, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> density, <span class="at">color =</span> distribution)) <span class="sc">+</span></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span>  </span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Comparison of Target and Importance Distributions&quot;</span>,</span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;x&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;deepskyblue&quot;</span>, <span class="st">&quot;deeppink&quot;</span>, <span class="st">&quot;darkolivegreen3&quot;</span>)) <span class="sc">+</span></span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABPlBMVEUAAAAAACsAAFUAKysAK1UAK4AAVYAAVaoAv/8rAAArACsrAFUrKwArK1UrK4ArVVUrVYArVaorgKorgNRNTU1NTWtNTYhNa6ZNiMRVAABVACtVAFVVKwBVKytVK1VVK4BVgIBVgKpVgNRVqoBVqtRVqv9rTU1rTWtrTYhra4hra6ZrpuGAKwCAKyuAVQCAVSuAVVWAgFWAgKqAqoCAqtSA1P+ITU2ITWuITYiIa02Ia6aIxP+izVqma02ma2umiE2mxKam4eGm4f+qVQCqVSuqgCuqgFWqqlWqqoCqqtSq1NSq1P+q/6qq/9Sq///EiE3E///UgCvUgFXUqlXUqoDU1IDU1KrU1NTU1P/U/6rU/9TU///hpmvh///r6+v/FJP/qlX/xIj/1ID/1Kr/4ab//6r//8T//9T//+H///+FYCBdAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAQAklEQVR4nO2diZ8btRXHZ3NgL0ch9QLdNr3ZUMimlIalpRhacGkpKQluaCndZcdZ1nH0//8D1ZM0o2MkPc2Mbdne9/tAMhodM/pG1+hJVsFIURW5X2DTRYAQESBEBAgRAUJEgBARIEQECFEnQIu/vVgU19/o9MDF8c3TdjH+WhQDiDI/LJSuPUyKePEzNNzieIC8VhdAF/vyPW91iNse0Iw/SeSiNaApHm4lgPiL3vovY/++XRy1j9xeM/MxrfDmAjQtRuLvi31I8/vbRXHjAbhGj/f3fsVm+8UrpxziiF/cOIFwj3l95B7wMtPi2hfwJot3+C1RRavo/AU/f1EEU6o8JlaJ0fmwU33AHu8Xe78U2YWYLz3gHjzmiLmh9WN4jBtfmIC8WWgPaHFcve83/P+ZqG57JxzQy/xy7/6+qBHzQ3DBfc5T6IhHvL5f3PwffxPx7nBLR1e36tJSewQAOameKvegagD2TkxARuj6MeLejdsWIE8W2gOaHw5MWsUb8CxInV89hleCksWr4eB08Rl/DucpyhdcwfvKN7l1Wt1S0fkVb4mnxcBN11/F3FTnh3vvse+PxfOgaH7NfXQVs0Krx+gYBiBfFvoBgodyTfZOxNX8EOrPMaQuMjIRr/jN57/bl6geVm9y/Rdf2NGlZ5229gi2QVaqM1FWIBavJ+ALcMw2yAoNj5Hh1HOq1/JkoTcg8fYzADSq/CaQugg0FXVPFX6ZOfEn1JvilQdG9Mpz4KYbAOSkCg+S0Weqp+M3NKDGOwxUsgunDWpmoU8b9K9XHuCAeEl9+ff/+PbQAsS+vi2als6A3FTjgJrvsEpAdS82P4Qc6ipmpy5fpGIg678GxPWf3xZHZhVzAMWrmJuqWcXq4DWg5jtUVayuDj5AImivcdDIaqTt1Isfykaav9Yp9LzQDleAZtyTLT4TPU3dSFuAsEbaTdVqpN/jXT0Uc1msPKHhMTzGG6LNDgOSWWgPqB5JQ0pGN2+nfn1f9s9Vx2oCUvcg97qbtwBpj1AvZqfKdDev6thI3BsxX2jxmJmnm/dkodO32Pfv7NffYhd6oGhXYBhuPWBqxPce78+MKiYGirdOjeguoNoj0Eg7qYph396vxeMhpni5+W35Eed5BwjH28EbX0bbIMjCir7mra5ubeKD32Um1rWRbpH62nSx/xwvl5Nlfh3uFiDdqi1NuwXIaNWWpdUC2h0RIEQECBEBQkSAEBEgRB0Bna/ZnU8ECBEBQkSAEBEgRAQIUQTQ0/cPXv9OXT/76EPLjwBJJmc/Uo6zAwLk6ukfv2KXv/lKXF++9QEBcnX59nfs6R8+hctnH3+iq9g5rpIrIRimNWQfVxjQk9drQGd3W7VBpVB6+AR3PqWUIH7VAVAZ9O/gzqeUNujsAHTX9IxlSFQwh9AuAnr20V3di7UpQYDmnO0+IDUOkoWoBaCyBlQmhU9y59PyR9ICzDljBMjvLgkQKAqIVYDKhPBp7nxaHSBGgLxuAiQUzFBpASrR8InufFoBoNpNgDxuAiRFgBCFMlQ6gEokfKo7n5YPyHAToIabACkRIEQECFEgQzWRgBuLH3TnEwFCRIAQESBE7QEhBrGoe6fsYlH5/8WbvZbdq2Hxw+58IkCICBAiAoSIACFaJiDP/A8BMt2+CTJzfgiLH3HnEwFCRIAQESBEBAjREgF5LakESLsJkCEChIgAISJAiAgQIk+G/EvuCFDtDqxJ1OuFkPhRdz4RIERJ+8WeHBy89pXlR4DM/WKwlrxecy9FgOz9Ysy4EiJA1n4xLl2CUm1i/U1jq857kpL2i7HLO69+ank2/8WDm1eqlfdI/Lg7n1JLkL4S8gIaj33+OwvIboPYI2u7jw/QeKwJXQVAer+YWdmUQoDGTf+dBWTsFzs7OMDboPHYIHQlAMXkB8RqQgSo4ZZsCJBSI0OlROMBpPawIvERdz4tH9DY9SdATANiBEiqkaExAbLkAyQuFCgC5LrrERBcDLm0HwFiDqChVOVHgLhKDyCT0JUHpL/CoBEasnOTEAEyAQ3FJffXhAiQAWhYA9KECJAfUE2IAGlAQxNQRYgAWYDEtfInQEoGHxeQIhSPv0xA9aGRiZqO5BluFy88ZBc/aJyrsHRAzASkCK0T0EycJ5R+QgtnAmg4VzhLatqIuJz9YpwJ/AU4aoeUuNPRNhZ6g2FD2m9xfCRzLY5oOmKLe+8WxWgGxyAZl8oTNDmaHxZ7J5O9+4Bp/hP3YE0T0PywOm8Kp2Q7VQmSr2qWILaKEhQDJEoDaP7jE3DIo8QGzqXyZJKIvJJ/TtzDb+wSNEk9/WVzAZmtCM/94t4Jg/85EuNSearwJqBGHXOrGByHm1CBvYCqV4U6ZmZmnW2QaGr3xcFkEzjfLARoog4nnd1sCUgiQo+4DQGqXNp/zYBkG8QZzA+PRL3yAlKerEMJmoo+coJVNDsDVg1rAvIQWmEvJk612zsRRen5Ez8g5cnatkFwCJU8nRIrQj5AQy8gcXuNgEQHJXpsOKDvKFDFpCcEnxyZgLBeLPEY7iCg2mn6rxlQS9ljw/g4CGomSyg+DAFkTH4wtumALCbISLofoOGWAkKkAU2r4+5TvmT8gCy31o4AqktQiq4moBayMiAb5TAgD6EtBMSLDwwRiyJhmOgDNNx1QO3kBWTdsYIToCsCSFazlNFiS0CNb40tBTQZwBnt07bdfBqgoeneTkC8AMGkUuuBIgCy+OwwIDhvuy2gMgHQuVPHthPQ4ngEkwWTllVMzCAmADIDbCcgmCkY6LkgvV/s8s5B5PgsD6AGoR0BZEnvF4NV9pdvBlfaN5dMBQAZIVY35bovrBovxFuJyl/axKSJw/MlD0rZq/EEMIX3aihAVuSMgKAFTQQkbWLCxPH8iWcuCORWMf2pEdrt4zWKCfNX01CmJQDZYTrbxcqGzKz/fSAByBHdxUu3r33ZMIgpQNIm9u5AXHpmE11A0MdrWVtYYGeLKePly/QSpMP0KkFxQA/VJOpkBCYLqHJNg5hrE1OWDt9kRni6wyxBT9+3+bQHxGxCqwQ0/7moODz3anq+aRBzLRrSVu2tY3YJMgEZ+8Uu79h9WAOQy8dY1FmFXyKgmCDD05EqJJxKA5AwiEkstU0MRn8sAZA9RNT7xZp8NhvQ4t79UAlSBjG7BMmeLwGQMx9U7xeTJ9SFejFfDQsCGtZuJzziTpbIuujKVBtkA1IGMasNqvjgbVALdQLE1gUIPrmrXsypYtIgVvdi4C8n41N6sRbqDGjYiJ/kXo0wmxjIBsRhHk1T1nfoDHibIA8guwhtBiDMJgay54NufitnPFChgJyOXgMaOvHd9PzufGpMdxy1nO5oBYgRoNp/FwGxKVQxNWqKqwegoR3fTc/vzie7kYYltCkLzDoDYlsOKFk6A5JPM4NhQEN2lQCVyYCsIrSdgGZqSJkgHJBNyAI03E5Ai2PRe80PWw0UWwNiWwuoGkEnrePvB2i4jYD0ZFDKt4YDyJfBECC2pYD0dGKrgSIB8qsnIF+VjLpTBQuZi9h+Cm3wqW74v1FrrQ6QRUj4G4RWWILiJh9t8Knu+Gc5amUC1Bx5x92Wxg2Zvmo6VZp3Xrp97eH8sLjx0xM5gVat7oHJw+q+d56slgGoXuUaB9QwioXsXT7bmLxItJD1AFSZd2A2FeZeYcnBiE0Hxiao6r5/prUJqJ3ql1dfYq1KkKcILb0Esdq8AzAW904AmWXwUfexOrYUQP4MhgF5pmhD6bdXNd9cmXcABgCCGrJ3Yhh85P0VAyo7Axo2wsfcLaQsXbV5pypBsqlZdwlqBShShJYNyDTv6DZImYHW2QbFAJmEPIBaLclrIWX40eYdXrmeuyd6MY5DfXGqXkzcT+zF2qkvIHfB1YpH0o2xkRoHSUN1NGpGQG1WnPUQDK6bu7nF0im4nzySbicLEOsAiK0NUE/1A1T2AtRixVk+rRWQdbQxATIJ+QGlrzjLp3yAGAHCASUvqMqnjIDY7gMqy+r3ExMB2QfTtlhxlk8rBaQJeQG1WHGWT7kBJS6oyqesgNJXnOVTT0Cqje4BKG29UD71AVS2B+SeWLfVgPR+scbhUMsElLReKJ9S9ovBCWy+A9hwQM1TEhxAqQuq8inpbJ9Hr/6lWwnaaUDWfjGjill2LgAUM22FbWPntYksmMDKM5+itPPFvG0QFIbWJahxYl3airN8al+ChJYKKGFBVT4lni/WFVDznA0XUNqKs3xKOV+MBQFVfHoCwtcL5VPS+WJeQGVnQM5pUSnrhfKp+0jarGEtAHmO0yJAOCBsvVA+bQKghOUw+bQRgPDlMPnUGZDIZxdAvrN+0OUw+dQbUOV2/ZXSAKGrPfJp1YBUEAwQtpghn3oBqmtYf0DIYoZ86gqo7AXIcxBJfDFDPvUAxDoCCpzUErXV59M6AI2TAEVN0fnUEVBpt9Gxj81kQDFTdD51B8T6APKekhAxRedTDkDBYyTCltZ86gaobAdonAgobEjMp86AmNlGRye8vIACv1AespPlU+cqxnoAihxEEthXn099TM/NRZrM54Y6lgwoMImfT33OF2sYvVKNY2IcHgqtLWUryG57raEEuSe1gNwihM1R59MGAvJNwebTmgA5v57c6MfcKdirVYKaPy/d+ge486kHoOaGORZwEyAckOcXystg+CsHyPMT7owAmWoUoXOnmb7qgDw/n8wIkCm3CJ07Pf0uArKyjGXQ89OljACZbqcIKUBlMHy311qB1gXI86t4jACZ7nEzvFGECJA3vCa0g4A8VSbuHnt6PQJkuk1CGlAZDL8ZWiMgk1DlXxHaPUDDDoAMQrV/2VgW7I2fT10BecY1DHfXsSxAzSV52wFI7xczd45J+UbGKe7x2F3MUJZlyBS9EUrZL2buHFMadgRU/0Cb4VeWTUjbAEjv1bB2bUh5Pj5ZmnucpG0ApHf72CeNtTKJhexkKKAtsIvp/WLWzjGp5gxhO/culyChtkD6uvOpYxtEgMz9YtbOMSkCxMz9Yp5xkBP2SgKKiQAhIkCICBAiAkRSIkCICBAiAoSIACEiQIgIECIChIgAIeoCqPlxb+vyjnO2eENgBoj5Hrz6acR/reoAyGPksASTj5dvRnN4FgX46EMxy7sZ6gDIM8Fo6QnAexQjcPnWBxFvSH9z1AGQZ4q6oaj/s48/iVWxy7f/vN1VzGPkcAWTtGGd3Y22QZd3PhT/CJuhlZSgp+/H+PD4cUAJJXR9WkEbJIpARGcHoDDCp3/ackAeI4clhI9MAunFtrqKYeMgWUKikOKAePqvbUxHRiNpRAQIEQFCRIAQESBEBAgRAUJEgBARIERrADTdg0NO44d1bq7WUYImA/hvS7UOQBfP33cPgt0eraUNmhbR45Q3WmsBNCm2toatBdDs2j8Pt7YIrQEQnP0+u7atjdAaAE1unrLF8bZWMhooIiJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIj+D97anbjKM95BAAAAAElFTkSuQmCC" /><!-- --></p>
<div id="结果解释" class="section level4">
<h4>结果解释：</h4>
<p><span class="math inline">\(\hspace{1.5em}\)</span>使用Gamma分布作为重要性分布时，估计值为0.5049；使用正态分布作为重要性分布时，估计值为0.7874。Gamma分布的方差为2.4135e-05，表明其估计值的稳定性较高；正态分布的方差为
0.0048，相对较大，表明其估计值波动较大。这可能是因为正态分布是对称的，可能不够灵活以适应某些数据的偏态分布。而Gamma
分布具有较强的右偏特征，适用于非负且具有较大变异性的数据，通过选择合适的参数可以使得其在关注的区域内有较高的密度，从而提供更稳定的估计值。</p>
<hr />
</div>
</div>
</div>
</div>
<div id="作业2024-10-14" class="section level1">
<h1>作业2024-10-14</h1>
<div id="多重假设检验bonferroni与b-h方法的模拟比较" class="section level2">
<h2><strong><em>多重假设检验——Bonferroni与B-H方法的模拟比较</em></strong></h2>
<p><span class="math inline">\(\hspace{1.5em}\)</span>设在N=1000个假设中,950个是零假设,50个是备择假设。任何<strong>零假设</strong>下的p值都是<strong>均匀分布</strong>的(<strong>runif</strong>)，而任何<strong>备择假设</strong>下的p值都遵循<strong>参数为0.1和1的贝塔分布</strong>(<strong>rbeta</strong>)。</p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>分别获取<strong>Bonferroni调整</strong>和<strong>B-H调整</strong>后的p值。进行m=10000次模拟重复，计算两种调整方法中每种方法在名义水平<span class="math inline">\(\alpha\)</span>=0.1下的FWER、FDR和TPR。将结果输出到3×2表格中，进一步进行分析。</p>
<div id="代码实现" class="section level3">
<h3>代码实现：</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="co">#设置种子</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="co"># 参数设定</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>N<span class="ot">=</span><span class="dv">1000</span>  <span class="co"># 总假设数</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>num0<span class="ot">=</span><span class="dv">950</span>  <span class="co"># 零假设数</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>num1<span class="ot">=</span><span class="dv">50</span>  <span class="co"># 备择假设数</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">10000</span>  <span class="co"># 模拟次数</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.1</span>  <span class="co"># 显著性水平</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="co"># 初始化存储结果的表格</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>results<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>m, <span class="at">ncol=</span><span class="dv">6</span>)</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a><span class="co"># 模拟</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>  <span class="do">## 生成p值</span></span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>  <span class="co"># 零假设使用均匀分布，备择假设使用贝塔分布</span></span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a>  p_values<span class="ot">=</span><span class="fu">c</span>(<span class="fu">runif</span>(num0), <span class="fu">rbeta</span>(num1, <span class="fl">0.1</span>, <span class="dv">1</span>)) </span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a>  </span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a>  <span class="do">## 校正</span></span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a>  bo_adjusted<span class="ot">=</span><span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a>  bh_adjusted<span class="ot">=</span><span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a>  </span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a>  <span class="co">#计算拒绝数目</span></span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a>  rejected_bo<span class="ot">=</span><span class="fu">sum</span>(bo_adjusted <span class="sc">&lt;</span> alpha)</span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a>  rejected_bh<span class="ot">=</span><span class="fu">sum</span>(bh_adjusted <span class="sc">&lt;</span> alpha)</span>
<span id="cb21-26"><a href="#cb21-26" tabindex="-1"></a>  </span>
<span id="cb21-27"><a href="#cb21-27" tabindex="-1"></a>  <span class="co"># 真实拒绝的数目</span></span>
<span id="cb21-28"><a href="#cb21-28" tabindex="-1"></a>  true_positive_bo<span class="ot">=</span><span class="fu">sum</span>((p_values[(num0 <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N] <span class="sc">&lt;</span> alpha) <span class="sc">&amp;</span> (bo_adjusted <span class="sc">&lt;</span> alpha))</span>
<span id="cb21-29"><a href="#cb21-29" tabindex="-1"></a>  true_positive_bh<span class="ot">=</span><span class="fu">sum</span>((p_values[(num0 <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N] <span class="sc">&lt;</span> alpha) <span class="sc">&amp;</span> (bh_adjusted <span class="sc">&lt;</span> alpha))</span>
<span id="cb21-30"><a href="#cb21-30" tabindex="-1"></a>  </span>
<span id="cb21-31"><a href="#cb21-31" tabindex="-1"></a>  <span class="do">## FWER</span></span>
<span id="cb21-32"><a href="#cb21-32" tabindex="-1"></a>  fwer_bo<span class="ot">=</span>rejected_bo <span class="sc">/</span> num0</span>
<span id="cb21-33"><a href="#cb21-33" tabindex="-1"></a>  fwer_bh<span class="ot">=</span>rejected_bh <span class="sc">/</span> num0</span>
<span id="cb21-34"><a href="#cb21-34" tabindex="-1"></a>  </span>
<span id="cb21-35"><a href="#cb21-35" tabindex="-1"></a>  <span class="do">## FDR</span></span>
<span id="cb21-36"><a href="#cb21-36" tabindex="-1"></a>  fdr_bo<span class="ot">=</span><span class="fu">ifelse</span>(rejected_bo <span class="sc">&gt;</span> <span class="dv">0</span>, (num0 <span class="sc">-</span> true_positive_bo) <span class="sc">/</span> rejected_bo, <span class="dv">0</span>)</span>
<span id="cb21-37"><a href="#cb21-37" tabindex="-1"></a>  fdr_bh<span class="ot">=</span><span class="fu">ifelse</span>(rejected_bh <span class="sc">&gt;</span> <span class="dv">0</span>, (num0 <span class="sc">-</span> true_positive_bh) <span class="sc">/</span> rejected_bh, <span class="dv">0</span>)</span>
<span id="cb21-38"><a href="#cb21-38" tabindex="-1"></a>  </span>
<span id="cb21-39"><a href="#cb21-39" tabindex="-1"></a>  <span class="do">## TPR</span></span>
<span id="cb21-40"><a href="#cb21-40" tabindex="-1"></a>  tpr_bo<span class="ot">=</span>true_positive_bo <span class="sc">/</span> num1</span>
<span id="cb21-41"><a href="#cb21-41" tabindex="-1"></a>  tpr_bh<span class="ot">=</span>true_positive_bh <span class="sc">/</span> num1</span>
<span id="cb21-42"><a href="#cb21-42" tabindex="-1"></a>  </span>
<span id="cb21-43"><a href="#cb21-43" tabindex="-1"></a>  <span class="co"># 存储每次模拟的结果</span></span>
<span id="cb21-44"><a href="#cb21-44" tabindex="-1"></a>  results[i, ]<span class="ot">=</span><span class="fu">c</span>(fwer_bo, fdr_bo, tpr_bo, fwer_bh, fdr_bh, tpr_bh)</span>
<span id="cb21-45"><a href="#cb21-45" tabindex="-1"></a>}</span>
<span id="cb21-46"><a href="#cb21-46" tabindex="-1"></a></span>
<span id="cb21-47"><a href="#cb21-47" tabindex="-1"></a><span class="co"># 转换为数据框并计算平均值</span></span>
<span id="cb21-48"><a href="#cb21-48" tabindex="-1"></a>results1<span class="ot">=</span><span class="fu">as.data.frame</span>(results)</span>
<span id="cb21-49"><a href="#cb21-49" tabindex="-1"></a><span class="fu">colnames</span>(results1)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;fwer_bo&quot;</span>, <span class="st">&quot;fdr_bo&quot;</span>, <span class="st">&quot;tpr_bo&quot;</span>,</span>
<span id="cb21-50"><a href="#cb21-50" tabindex="-1"></a>                     <span class="st">&quot;FWER_BH&quot;</span>, <span class="st">&quot;FDR_BH&quot;</span>, <span class="st">&quot;TPR_BH&quot;</span>)</span>
<span id="cb21-51"><a href="#cb21-51" tabindex="-1"></a></span>
<span id="cb21-52"><a href="#cb21-52" tabindex="-1"></a><span class="co"># 计算每列的平均值</span></span>
<span id="cb21-53"><a href="#cb21-53" tabindex="-1"></a>results_mean<span class="ot">=</span><span class="fu">colMeans</span>(results1)</span>
<span id="cb21-54"><a href="#cb21-54" tabindex="-1"></a></span>
<span id="cb21-55"><a href="#cb21-55" tabindex="-1"></a><span class="co"># 将平均值整理为3×2表格</span></span>
<span id="cb21-56"><a href="#cb21-56" tabindex="-1"></a>table<span class="ot">=</span><span class="fu">matrix</span>(results_mean, <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">byrow=</span><span class="cn">FALSE</span>)</span>
<span id="cb21-57"><a href="#cb21-57" tabindex="-1"></a><span class="fu">rownames</span>(table)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb21-58"><a href="#cb21-58" tabindex="-1"></a><span class="fu">colnames</span>(table)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;Bonferroni校正&quot;</span>, <span class="st">&quot;B-H校正&quot;</span>)</span>
<span id="cb21-59"><a href="#cb21-59" tabindex="-1"></a>table<span class="ot">=</span><span class="fu">round</span>(table, <span class="dv">3</span>)  <span class="co"># 保留三位小数</span></span>
<span id="cb21-60"><a href="#cb21-60" tabindex="-1"></a></span>
<span id="cb21-61"><a href="#cb21-61" tabindex="-1"></a><span class="co"># 显示结果</span></span>
<span id="cb21-62"><a href="#cb21-62" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Bonferroni校正</th>
<th align="right">B-H校正</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">FWER</td>
<td align="right">0.021</td>
<td align="right">0.033</td>
</tr>
<tr class="even">
<td align="left">FDR</td>
<td align="right">48.208</td>
<td align="right">30.319</td>
</tr>
<tr class="odd">
<td align="left">TPR</td>
<td align="right">0.399</td>
<td align="right">0.610</td>
</tr>
</tbody>
</table>
</div>
<div id="结果分析" class="section level3">
<h3>结果分析：</h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>两种调整方法中每种方法在名义水平<span class="math inline">\(\alpha\)</span>=0.1下的FWER、FDR和TPR如上表所示。结果表明，在不同的假设检验中，这两种校正方法的表现有所不同。</p>
<div id="fwer家庭错误率" class="section level4">
<h4>1. FWER（家庭错误率）</h4>
<ul>
<li><strong>Bonferroni校正</strong>的FWER为
<strong>0.021</strong>，这表示在所有假设检验中，仅有约2.1%的情况下错误拒绝了零假设。</li>
<li><strong>B-H校正</strong>的FWER为
<strong>0.033</strong>，略高于Bonferroni校正。这意味着在B-H校正中，错误拒绝的比例相对更高，但仍然保持在可接受的范围内。</li>
</ul>
<p><strong>分析</strong>：Bonferroni校正是一种保守的校正方法，能够有效控制FWER，因此其FWER值较低。而B-H校正相对宽松，适合于需要平衡假发现率（FDR）和检出率（TPR）的场景。</p>
</div>
<div id="fdr假发现率" class="section level4">
<h4>2. FDR（假发现率）</h4>
<ul>
<li><strong>Bonferroni校正</strong>的FDR为
<strong>48.208</strong>，这个值相对较高，表明在错误拒绝的假设中，有接近48.2%是伪阳性（假阳性）。</li>
<li><strong>B-H校正</strong>的FDR为
<strong>30.319</strong>，虽然也是相对较高，但明显低于Bonferroni校正。这意味着B-H校正能够有效减少假阳性的比例。</li>
</ul>
<p><strong>分析</strong>：FDR的比较显示出B-H校正在控制假发现率方面的优势。Bonferroni校正虽然FWER较低，但由于其保守性，容易产生较高的假发现率，不适合于假阳性率需要较低的情形。</p>
</div>
<div id="tpr真正率" class="section level4">
<h4>3. TPR（真正率）</h4>
<ul>
<li><strong>Bonferroni校正</strong>的TPR为
<strong>0.399</strong>，表示约39.9%的真实备择假设得到了正确的拒绝。</li>
<li><strong>B-H校正</strong>的TPR为
<strong>0.610</strong>，表明在B-H校正下，接近61%的真实备择假设得到了正确的拒绝。</li>
</ul>
<p><strong>分析</strong>：B-H校正的TPR高于Bonferroni校正，意味着它在检出真正的效应方面更为有效。这也与FDR的高低相辅相成，较低的FDR伴随较高的TPR显示出B-H校正在进行多重假设检验时的有效性。</p>
</div>
<div id="总结" class="section level4">
<h4>总结</h4>
<ul>
<li><strong>Bonferroni校正</strong>适用于对假发现率要求严格的场景，其FWER较低，但可能导致TPR降低和FDR增加。</li>
<li><strong>B-H校正</strong>则在保持合理的FWER水平的同时，能够提升TPR并降低FDR，适合大规模假设检验中的应用。</li>
</ul>
<hr />
</div>
</div>
</div>
<div id="习题7.4" class="section level2">
<h2><strong><em>习题7.4</em></strong></h2>
<p><span class="math inline">\(\hspace{1.5em}\)</span>依据boot包中提供的空调数据集aircondit，12个观察结果以空调设备故障的间隔时间为单位(3、5、7、18、43、85、91、98、100、130、230、487)。假设故障间隔时间遵循指数模型Exp(<span class="math inline">\(\lambda\)</span>)。获得危险率<span class="math inline">\(\lambda\)</span>的MLE，并使用bootstrap估计估计的偏差和标准误差。</p>
<div id="代码实现-1" class="section level3">
<h3>代码实现：</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="co"># 加载空调故障时间数据</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>hours<span class="ot">=</span>aircondit<span class="sc">$</span>hours</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="co"># 设置Bootstrap参数</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>B<span class="ot">=</span><span class="fl">1e4</span>  <span class="co"># 设置Bootstrap次数为10000次</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="do">## 计算lambda的 MLE：n/sum(xi)</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>lambda_hat<span class="ot">=</span><span class="fu">length</span>(hours)<span class="sc">/</span><span class="fu">sum</span>(hours)</span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a><span class="co"># 初始化存储向量</span></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>boot_lambda_hats<span class="ot">=</span><span class="fu">numeric</span>(B)</span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a><span class="do">## 进行Bootstrap抽样</span></span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a>  boot_hours<span class="ot">=</span><span class="fu">sample</span>(hours, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a>  <span class="co"># 计算Bootstrap样本的 MLE</span></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a>  boot_lambda_hats[b]<span class="ot">=</span><span class="fu">length</span>(boot_hours)<span class="sc">/</span><span class="fu">sum</span>(boot_hours)</span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a>}</span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a><span class="do">## 计算偏差</span></span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a>boot_lambda_hats_mean<span class="ot">=</span><span class="fu">mean</span>(boot_lambda_hats)</span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a>bias<span class="ot">=</span>boot_lambda_hats_mean <span class="sc">-</span> lambda_hat</span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a><span class="do">## 计算标准误差</span></span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a>std_error<span class="ot">=</span><span class="fu">sd</span>(boot_lambda_hats)</span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a></span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a><span class="co"># 结果输出</span></span>
<span id="cb22-26"><a href="#cb22-26" tabindex="-1"></a>results<span class="ot">=</span><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">MLE=</span>lambda_hat,<span class="at">bias=</span>bias, <span class="at">se.boot=</span>std_error, </span>
<span id="cb22-27"><a href="#cb22-27" tabindex="-1"></a>                <span class="at">se.samp=</span><span class="fu">sd</span>(hours)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(hours))), <span class="dv">4</span>)</span>
<span id="cb22-28"><a href="#cb22-28" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(results)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">MLE</td>
<td align="right">0.0093</td>
</tr>
<tr class="even">
<td align="left">bias</td>
<td align="right">0.0013</td>
</tr>
<tr class="odd">
<td align="left">se.boot</td>
<td align="right">0.0043</td>
</tr>
<tr class="even">
<td align="left">se.samp</td>
<td align="right">39.3268</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># 绘制Bootstrap均值的直方图</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="fu">hist</span>(boot_lambda_hats, <span class="at">main=</span><span class="st">&quot;Bootstrap Estimates of Lambda&quot;</span>, </span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>     <span class="at">xlab=</span><span class="fu">expression</span>(<span class="fu">hat</span>(lambda)), </span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>     <span class="at">breaks=</span><span class="dv">30</span>, <span class="at">col=</span><span class="st">&quot;lightblue&quot;</span>, <span class="at">border=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>lambda_hat, <span class="at">col=</span><span class="st">&#39;red&#39;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="结果分析-1" class="section level3">
<h3>结果分析：</h3>
<ul>
<li><p><strong>偏差(Bias)</strong> 值为
0.0013，说明估计值与真实值之间存在微小的偏差，整体来看估计相对准确。</p></li>
<li><p><strong>自助法标准误(se.boot)</strong>
通过bootstrap计算，用于评估MLE的不确定性，表示在重复抽样过程中MLE的变异程度。相对较小的值(0.0043)表明bootstrap法的MLE具有一定的稳健性。</p></li>
<li><p><strong>样本标准误
(se.samp)</strong>用于衡量样本统计量的变异性，这个值相对较大，可能是由于样本数量有限，同时样本中有一些极端值（如
230 和 487），这些值会显著增加标准差，从而导致高的标准误差。</p></li>
</ul>
<hr />
</div>
</div>
<div id="习题7.5" class="section level2">
<h2><strong><em>习题7.5</em></strong></h2>
<p><span class="math inline">\(\hspace{1.5em}\)</span>使用standard
normal, basic, percentile和BCa方法计算故障之间的平均时间<span class="math inline">\(1/\lambda\)</span>的95%引导置信区间。比较这些时间间隔，并解释为什么它们可能会有所不同。</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="co"># 提取数据</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>hours<span class="ot">=</span>aircondit<span class="sc">$</span>hours</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="co"># 计算样本均值的倒数</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>mu<span class="ot">=</span><span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(hours)</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a><span class="co"># 设置随机种子和参数</span></span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">1000</span>  </span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>R<span class="ot">=</span><span class="dv">999</span>  </span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a><span class="co"># 初始化置信区间矩阵</span></span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a>ci.norm<span class="ot">=</span>ci.basic<span class="ot">=</span>ci.perc<span class="ot">=</span>ci.bca<span class="ot">=</span><span class="fu">matrix</span>(<span class="cn">NA</span>, m, <span class="dv">2</span>)</span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a><span class="co"># 定义fun算平均故障时间</span></span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a>mean_failure_time<span class="ot">=</span><span class="cf">function</span>(hours, ind) {</span>
<span id="cb24-16"><a href="#cb24-16" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(hours[ind]))  <span class="co"># lambda的倒数为平均故障时间</span></span>
<span id="cb24-17"><a href="#cb24-17" tabindex="-1"></a>}</span>
<span id="cb24-18"><a href="#cb24-18" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" tabindex="-1"></a><span class="co"># 执行自助法抽样</span></span>
<span id="cb24-20"><a href="#cb24-20" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb24-21"><a href="#cb24-21" tabindex="-1"></a>  boot_results<span class="ot">=</span><span class="fu">boot</span>(<span class="at">data =</span> hours, <span class="at">statistic =</span> mean_failure_time, <span class="at">R =</span> R)</span>
<span id="cb24-22"><a href="#cb24-22" tabindex="-1"></a>  <span class="co"># 计算各类型的置信区间</span></span>
<span id="cb24-23"><a href="#cb24-23" tabindex="-1"></a>  ci<span class="ot">=</span><span class="fu">boot.ci</span>(boot_results, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span>
<span id="cb24-24"><a href="#cb24-24" tabindex="-1"></a>  ci.norm[i, ]<span class="ot">=</span>ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb24-25"><a href="#cb24-25" tabindex="-1"></a>  ci.basic[i, ]<span class="ot">=</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb24-26"><a href="#cb24-26" tabindex="-1"></a>  ci.perc[i, ]<span class="ot">=</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb24-27"><a href="#cb24-27" tabindex="-1"></a>  ci.bca[i, ]<span class="ot">=</span>ci<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb24-28"><a href="#cb24-28" tabindex="-1"></a>}</span>
<span id="cb24-29"><a href="#cb24-29" tabindex="-1"></a></span>
<span id="cb24-30"><a href="#cb24-30" tabindex="-1"></a><span class="co"># 计算并打印每种置信区间的平均值</span></span>
<span id="cb24-31"><a href="#cb24-31" tabindex="-1"></a>result<span class="ot">=</span><span class="fu">list</span>(</span>
<span id="cb24-32"><a href="#cb24-32" tabindex="-1"></a>  <span class="at">norm =</span> <span class="fu">round</span>(<span class="fu">colMeans</span>(ci.norm), <span class="dv">4</span>),</span>
<span id="cb24-33"><a href="#cb24-33" tabindex="-1"></a>  <span class="at">basic =</span> <span class="fu">round</span>(<span class="fu">colMeans</span>(ci.basic), <span class="dv">4</span>),</span>
<span id="cb24-34"><a href="#cb24-34" tabindex="-1"></a>  <span class="at">perc =</span> <span class="fu">round</span>(<span class="fu">colMeans</span>(ci.perc), <span class="dv">4</span>),</span>
<span id="cb24-35"><a href="#cb24-35" tabindex="-1"></a>  <span class="at">bca =</span> <span class="fu">round</span>(<span class="fu">colMeans</span>(ci.bca), <span class="dv">4</span>)</span>
<span id="cb24-36"><a href="#cb24-36" tabindex="-1"></a>)</span>
<span id="cb24-37"><a href="#cb24-37" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>## $norm
## [1] -0.0005  0.0164
## 
## $basic
## [1] -0.0030  0.0133
## 
## $perc
## [1] 0.0052 0.0215
## 
## $bca
## [1] 0.0046 0.0181</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># 计算每种置信区间包含mu的比例</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;norm =&#39;</span>, <span class="fu">mean</span>(ci.norm[, <span class="dv">1</span>] <span class="sc">&lt;=</span> mu <span class="sc">&amp;</span> ci.norm[, <span class="dv">2</span>] <span class="sc">&gt;=</span> mu), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>    <span class="st">&#39;basic =&#39;</span>, <span class="fu">mean</span>(ci.basic[, <span class="dv">1</span>] <span class="sc">&lt;=</span> mu <span class="sc">&amp;</span> ci.basic[, <span class="dv">2</span>] <span class="sc">&gt;=</span> mu), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>    <span class="st">&#39;perc =&#39;</span>, <span class="fu">mean</span>(ci.perc[, <span class="dv">1</span>] <span class="sc">&lt;=</span> mu <span class="sc">&amp;</span> ci.perc[, <span class="dv">2</span>] <span class="sc">&gt;=</span> mu), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>    <span class="st">&#39;BCa =&#39;</span>, <span class="fu">mean</span>(ci.bca[, <span class="dv">1</span>] <span class="sc">&lt;=</span> mu <span class="sc">&amp;</span> ci.bca[, <span class="dv">2</span>] <span class="sc">&gt;=</span> mu), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## norm = 1 
##  basic = 1 
##  perc = 1 
##  BCa = 1</code></pre>
<div id="结果分析-2" class="section level3">
<h3>结果分析：</h3>
<ul>
<li><p><strong>负值的置信区间</strong>:对于norm和basic方法，置信区间的下限为负值，这是不合理的。平均故障时间不应为负值，说明模型可能不适合该数据，或者自助法的分布未能有效捕捉到真实情况。</p></li>
<li><p><strong>相对合理的置信区间</strong>:perc和bca的置信区间更为合理，且均为正值，表明从该模型推断的平均故障时间是正的。
这些置信区间和它们的差异可以归因于以下几个因素：</p></li>
</ul>
<ol style="list-style-type: decimal">
<li><strong>计算方法的不同</strong>:
<ul>
<li><strong>正态置信区间</strong>:
假设样本均值的分布是正态的，使用样本均值和标准误差来构建置信区间。适用于大样本，但在小样本或分布不对称时，可能不太准确。</li>
<li><strong>基本置信区间</strong>:
基于原始样本的重采样，使用样本的原始统计量构建置信区间。这种方法对样本的实际分布有更好的适应性。</li>
<li><strong>百分位置信区间</strong>:
使用重采样分布的百分位数来构建区间，直接依赖于数据的分布，通常能提供更准确的置信区间。</li>
<li><strong>BCa置信区间</strong>:
这是调整后的百分位置信区间，通过引入偏差校正和加速因子来提高置信区间的准确性。</li>
</ul></li>
<li><strong>样本特性</strong>:
<ul>
<li>样本的分布特性可能会影响各自方法的结果。例如，如果样本数据是偏态的，正态置信区间可能不准确，而其他方法（如BCa）则可能更可靠。</li>
</ul></li>
<li><strong>置信区间的宽度</strong>:
<ul>
<li>从输出中可以看到，正态和基本置信区间相对较窄，而百分位和BCa置信区间相对较宽。这可能意味着基于重采样的方法（如百分位和BCa）对数据的变化更敏感，提供了更保守的估计。</li>
</ul></li>
<li><strong>包含<span class="math inline">\(\mu\)</span>的比例</strong>:
<ul>
<li>所有方法都包含了<span class="math inline">\(\mu\)</span>，这意味着根据这些方法计算的置信区间都成功地覆盖了样本均值的倒数，表明在这些数据下，样本均值的倒数是一个相对稳定的参数。</li>
</ul></li>
</ol>
<hr />
</div>
</div>
</div>
<div id="作业2024-10-21" class="section level1">
<h1>作业2024-10-21</h1>
<div id="一习题7.8" class="section level2">
<h2><strong><em>一、习题7.8</em></strong></h2>
<p><span class="math inline">\(\hspace{1.5em}\)</span>要求使用Jackknife刀切法估计习题7.7中的统计量<span class="math inline">\(\hat{\theta}\)</span>的偏误和标准误差，其中<span class="math inline">\(\hat{\theta}\)</span>是基于协方差矩阵的主成分分析中第一个特征值所解释的方差比例。</p>
<div id="代码实现-2" class="section level3">
<h3>代码实现：</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co">#清除内存变量</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="co"># 导入数据</span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>scores<span class="ot">=</span>scor</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="co"># 计算 theta_hat</span></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>theta_hat<span class="ot">=</span><span class="fu">eigen</span>(<span class="fu">cov</span>(scores))<span class="sc">$</span>values[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">eigen</span>(<span class="fu">cov</span>(scores))<span class="sc">$</span>values)</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a><span class="co"># Jackknife 估计</span></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">nrow</span>(scores)</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>theta_jack<span class="ot">=</span><span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i) {</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>  <span class="fu">eigen</span>(<span class="fu">cov</span>(scores[<span class="sc">-</span>i, ]))<span class="sc">$</span>values[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">eigen</span>(<span class="fu">cov</span>(scores[<span class="sc">-</span>i, ]))<span class="sc">$</span>values) </span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a>})</span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a><span class="co"># 计算 Jackknife 偏差和标准误差</span></span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a>bias_jack<span class="ot">=</span>(n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(theta_jack) <span class="sc">-</span> theta_hat)</span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a>se_jack<span class="ot">=</span><span class="fu">sqrt</span>((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">mean</span>((theta_jack <span class="sc">-</span> theta_hat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb28-16"><a href="#cb28-16" tabindex="-1"></a>results<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">Metric=</span><span class="fu">c</span>(<span class="st">&quot;Original&quot;</span>, <span class="st">&quot;Bias&quot;</span>, <span class="st">&quot;Standard Error&quot;</span>),</span>
<span id="cb28-17"><a href="#cb28-17" tabindex="-1"></a>  <span class="at">Value=</span><span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">mean</span>(theta_jack),<span class="dv">3</span>), <span class="fu">round</span>(bias_jack,<span class="dv">3</span>), <span class="fu">round</span>(se_jack,<span class="dv">3</span>)))</span>
<span id="cb28-18"><a href="#cb28-18" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(results, <span class="at">caption=</span><span class="st">&quot;Jackknife方法估计结果&quot;</span>)</span></code></pre></div>
<table>
<caption>Jackknife方法估计结果</caption>
<thead>
<tr class="header">
<th align="left">Metric</th>
<th align="right">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Original</td>
<td align="right">0.619</td>
</tr>
<tr class="even">
<td align="left">Bias</td>
<td align="right">0.001</td>
</tr>
<tr class="odd">
<td align="left">Standard Error</td>
<td align="right">0.050</td>
</tr>
</tbody>
</table>
</div>
<div id="结果分析-3" class="section level3">
<h3>结果分析：</h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>Jackknife方法是一种重采样技术，通过系统地从原始样本中移除一个或多个观测值，然后重新计算统计量，以此来估计原始统计量的方差和偏误。根据输出结果：</p>
<ul>
<li><p><strong>original
(0.619)</strong>：是原始样本的估计值，表明在主成分分析中，第一个主成分解释了61.9%的方差，说明样本在该维度上具有较强的解释力。</p></li>
<li><p><strong>bias
(0.001)</strong>：偏误非常小，接近于零，表明使用Jackknife方法后，估计值与原始估计值几乎没有系统性偏差，原始估计较为准确。</p></li>
<li><p><strong>se
(0.050)</strong>：标准误差为0.050，表示虽然有一定的波动，但围绕真实值的变异性相对较小。较小的标准误差意味着估计值更精确，更有信心认为真实值接近0.619。</p></li>
</ul>
</div>
<div id="总结-1" class="section level3">
<h3>总结</h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>估计值0.619是真实值的良好且精确的估计；偏差很小，表明估计量没有系统性地高估或低估真实值；标准误差很小，表明估计值相对可靠。</p>
<hr />
</div>
</div>
<div id="二习题7.10" class="section level2">
<h2><strong><em>二、习题7.10</em></strong></h2>
<p><span class="math inline">\(\hspace{1.5em}\)</span>替换对数-对数模型为三次多项式模型，使用交叉验证选择最佳拟合模型。拟合的模型包括：</p>
<ol style="list-style-type: decimal">
<li>线性模型：<span class="math inline">\(Y=\beta_0 + \beta_1 X +
\epsilon\)</span></li>
<li>二次模型：<span class="math inline">\(Y=\beta_0 + \beta_1 X +
\beta_2 X^2 + \epsilon\)</span></li>
<li>指数模型：<span class="math inline">\(\log(Y)=\log(\beta_0) +
\beta_1 X + \epsilon\)</span></li>
<li>三次模型：<span class="math inline">\(Y=\beta_0 + \beta_1 X +
\beta_2 X^2 + \beta_3 X^3 + \epsilon\)</span></li>
</ol>
<div id="代码实现-3" class="section level3">
<h3>代码实现：</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a><span class="co"># 加载数据集</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a><span class="fu">data</span>(ironslag)</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a><span class="co"># 定义变量</span></span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>magnetic<span class="ot">=</span>ironslag<span class="sc">$</span>magnetic; chemical<span class="ot">=</span>ironslag<span class="sc">$</span>chemical</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">length</span>(magnetic); e1<span class="ot">=</span>e2<span class="ot">=</span>e3<span class="ot">=</span>e4<span class="ot">=</span><span class="fu">numeric</span>(n); a_R21<span class="ot">=</span>a_R22<span class="ot">=</span>a_R23<span class="ot">=</span>a_R24<span class="ot">=</span><span class="fu">numeric</span>(n)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAHgCAMAAABNUi8GAAAA0lBMVEUAAAAAACsAAFUAKysAK1UAK4AAVaoAv/8rAAArACsrAFUrKwArKysrK1UrK4ArVVUrVYArgKorgNRVAABVACtVAFVVKwBVKytVVStVVVVVgIBVgKpVgNRVqtRVqv+AKwCAKyuAVQCAVSuAgFWAqoCAqtSA1P+gIPCqVQCqVSuqgCuqgFWqqlWqqoCq1ICq1Kqq1NSq1P+q/9Sq///UgCvUgFXUqlXUqoDUqqrU1IDU1NTU1P/U////AAD/pQD/qlX/1ID/1Kr/1NT//6r//9T////lFm8SAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAe20lEQVR4nO2dDXvjtpWF6dlY1kx208SeTLNNx0qzXdtJmnZnR8k2XUdSavH//6US/ARFELwgLsgL8rzPkxlFwgd55hAXAKmrJAVAMMncBwCADRgUiAYGBaKBQYFoYFAgGhgUiAYGBaKBQYFoYFAgGhgUiAYGBaKBQYFoYFAgGhgUiAYGBaKBQYFoYFAgGhgUiAYGBaKBQYFoYFAgGhgUiAYGBaKBQYFoYFAgGhgUiAYGBaKRbtCXu+S+eHXavvo477FEy/mHT5Pk397bihyTrrr//O5+ftVh0OVz3iU518/9ZQwGzarBoIM0BgVjeUqustHz521y21+mz6CzE49B1bWc/d/7b5PkczUU/LRNrv6Y/X3+Lsnfebm7+q/tqw9zHqxMKgmVB4vXuRsr3XIlP/kh/zBXsPwgH3df/TUfQTNzF0WnJzqD5mzUsKC4rV5s0vwzWxRbK9XgmPnvQTNopVu6LzQt1b1+Lj/QDLofnCGEIzqDXn84P2VintRgWbyVvfipkHfz/P/zHq1IjqW1VMhuDNrWLfusUrD+oJ6DZu/fZi+uHuY4+ugMWup7LC579b/nH79K6ugFOpgNWutWLIOOmoLlB7VBZ10oxWrQfWXQfMZUGHSeS1w8TYjXDVrrVnxcqKsUrD+oDWragpqMeA1aTomOydXX/1CDBAzaQy7a6d/f/5zoc9BatyJ2H+tLvP4AIyiFPoOetsn79OfcqZ98PP8JBrWgtpnycTE33eb5t11bt+qtQsH6g6zsbaX6F8+/vbPtUoUjAoMW3LYNWq/ijwlC/ADVRr3S7impI3v5Ql/FFyNo9UFW9urPzSp+nmE0WoOevy/3QdUu3t/yHRQYtIfiVudXyecf0vO3SfKZ2vSsdWvtgyoF6w9O75JXPzb7oPNsMUs3KODj9PsItzlgUCAaGBSIBgYFooFBgWhgUCAaGBSIBgYFooFBgWhgUCAaGBSIBgYFooFBgWhgUCAaGBSIBgYFooFBgWhgUCAaGBSIBgYFooFBgWhgUCAaokHLr1PP8tX9JQI9qdAM+lTmmXnahDyW9QA9yZAM+vK2TIlweoMs3AxATzr+Bk1WBYvo0LNmUCtiiC9D0ZMhy+7yl1lJc5JMJws9m5fDhSmUCaZMk/rFC5rUf/CdLPTUXg+XHtcPeZSOnBAGNXUDPXtLE9kb0+gvXtAAIb4AenIZtM6BaMoRuXxB02ZUY1okQc/q1XBZUounrZotrfWK12A6WehZwhfi9yrRLgRlO1nomcM4B32520BQxpOFngrWRdLR/FtjEHQk0DNNbwZL+MuxKkEnONkV6XlzA4MyA4MycgODptzb3ms3KKOeuT1D3kniayEcCffhrdygfHreFMPnyg2q31RjbDEsq9Cziu4wKAzKCJeezeRz5QZFiGeGRc8bbXG0doNikcQMg56ttTset2MGj9t5crG1tPoRlJu1j6Ce3Fxufa7eoPbxyH20WrtBvfTs2BMGtU/qR0z5V25QLz1NN44cDHp6/ZA/A+aMYEHt2yJjNk3oxaFnG/N9TbpBzzv1W+LmB8BoLQhEl6wbfoIaFHq2MET3ps5wn2n1Ve0xiQQEC6oFHVP4CRnioadGnz2dQnz+VW3T97TJLUgkafQ0KRpwkQQ9ayxPLTkY9LxLEvMTtApLsivRglZw3aSjNwE9S6wP1XGt4m3JrqIQlOUm3a8ZHMeyJj37o3vVzHBHw9hzCVFamB/fOzS/FrAcy2r0HLAn2aCZYOVXtc37IksQ1I5d7l9rd9JOFnrmeg7akzHELzzZlSVg/fqrPnYynewa9CTYk/FO0rKTXfVN+dvm7Ck0isXrSbJn2H3QBT19YzRox5ymQr2sW0+iPekGPW1LcXr2RbIZ1fUvWRlTxuoFCNoJ8UZzlgUprFvP3J6003AdQft4us2CUqbmPtptkQG0casb1/Vy1AbXq2dhT+JZMG4z5YpHt+o0CWURz2rOvC7LUS1Yz+4Tn9bzcbuTdP1Lz5QpWkFd7hjX5rSdkNOdpPXp2Z17Dmzo0w163t0er5/7nr6ptkUiC0mmxY95xd4yp+WMyCe7Rj37Hkj20lObg2aC9q06M7nVX8ZnH+IVtEQP62wGXZ+expU7n0GLK35pT98MhvjOpNM7JJWsTU/LA588IX7g6RuvPmbENqk3r4h8J/UVa9LzxrLvybZIGo1oQU0oyQaX6311gxzR1F3wYrPnEDBol6R/G55SOTiR6enhztTJoEfL0zeefUjCw5wK+smuQs9q8Bx9zA6r+Lv7YH1MTs+8p4nr3Zk+252PkjXoWdoz+zSgnrRbnX59TI1p5dgyJ3nz3tQ0jaXr2cT2wHrWJUx7xkx9TMzQTmf3ih/arbsoSWLJeuoLo9B6NiHedc4k9vGwtjyGjU7i3aXetiksVk+Fvm4PrecSV/F1gDFuJk0T4scjWM+cy12lqUL8aGYRdDiJVf9Op+MTTu1ytGI+CNWzxLDpGVbPixA/YmNkDkEHrtCx2/CkjmksSs8Kny353o6pJYpMGBv3dEIzCGqd4wQzp63TLovRs+KG357u20ynNx+d0wlxCOq4MtAFbVWlPNLpheM2U+x6Ns2FcGfqYtDzrswldJzhiifPqbsVmlf2nU4myO3Gr6f2aSB3pm6LJJUuaJOetq53QJiWWY6KNnqqP1qTzhHN0fulF41ZT50gob3ul6FETtBkV0ZBaWtD03Jd3zqW+isfgvU07CndzKgnrcPAya4McYW4u2Z+pNMasLxgak2snq33qrFzVj3rEvs5cwl1LkzTIHD5Xt9yvRlB+YM9vbH49GxVvWki+7x61qv4u3v1FQVTzAkmqCVemO/wNu+Zdjq78yjrP8G4Q6YWjEzPNjeteee8etYGffvw8mXvnkiQZFfWeGEJPz3b8KZARA1sLsdMIyI9L7AF9hn0rEqcd/fnbx56N+0CJLuyxou+K95yA1NrrrmmeX464aI2hUj0vHivFdhTEXrWJU6vH45mxfpqej59Qxa0Dt2aOccLNZFBY9BTq6De6wvsHt3SanuWUKivKCqtWedMxJBUvGqPnD6hZpoQb2d+PS9etc053NyIcn2VvUso1JxJzZdmmNQnelIaw7VPam5UOfNxsTCvnheh+8bgzoHmRpUzHxe5hO1LXsWq8/jKOOln+jczNNpZETUGtX8PJtxDv/SGherZNmjtzRuxelYlrF/yKrdFjsZsWGEOPg8cF89+UFeTXkFn8LBoiNSz9epGGzkF61kb1J7PstgW2ZtGhEDH3oycpv1N2/dg/KbtdugGlaanPh5q3hSvZ13C+iWv4tmc1PjrqLRDd4oS5s0ku2R2+3JBb1aSnho3elRPI9CTNAf17CN1ihL9DxzHFOLl6FmhWbPZSZKvJ2kO6tmHaelofjXwNLytqnkJNdvTTDL0LLjpepNSVYaetDmoXx8tQU0XZvFq1Hc1DFe3sTMmmOagvl2Q9Gwbk/hEpzg9mxAfNNFAop2i6Y9R5mw1Yu+MC4cQP5eeNx1cOxelZxPiwya7sizF+++vt6v2dt6dPnU648IhxHvraXVafYrdUkPOjEtP/+4cW2gHouYmEaEC96cjCLVYMHVhs57dltbTjkzPyQ3affbjV+s+xtBVS045wMKUBu1g9mN3LbMoPcd36Pf0TesOpo+g0xLwQPieZlqUntOPoIZft/YISRMz6wg6XHGBek5tUH1FZH/2o+lAjp6iDbpMPfkMOnzefct1WVHHyoQGHe+jRenJZtCByGHdSxIVdaxMZ1AfTZakJ5dBrVft4Da8pKhjZTKD+o2CC9IzuEEd7xEJlzYSg2qtxa5n0BA/dI/I2JhoReMI8a3GItcz2CLJ3Zwp37gRjCgWSRdtxa0n8egdk12xPvshCa5jC5o87KKtuPWkHb1Lsqux5qwak6wn18EFTh7WaixyPUmHT84lNCqut1sTrSfTv3bw5GFaa7HryWlQX3MOMr/a0RnUSgx6EkM8JdlVWHOmIuIVV4gPkTzMmSj0JB5hgGRXzkiY8XN1Dz21Y/As0Vtz6p/ui0PQ8U1Dz3Elwrfg0JP8kBRDF01P8vWMyaBRTOpj6KLuKgI9aav46nf9jKlaVoX7vwH0tDGoFfVOEuFLtO7/eM41JuhimhEMejJXP++GcwVDUDrQc6Lqfk0tUVA+oCdDdb+mligoH9CTobpfU0sUlA/oyVDdr6klCsoH9GSo7tfUEgXlA3oyVPdraomC8gE9GaoDEBYYFIgGBgWigUGBaGBQIBoYFIgGBgWigUGBaGBQIBoYFIgGBgWiYTJoniLjvHP44aq8xmmbJIbcBabiWcl7py7KGvQu1O+/Xj04nkYgoGcF17fA1CE8bUjftdFqkH8vUP026zE7W3oXVQ36TxKeXmels6NyOY1AQM8aFoPuk99l16/KOGRKNtRfI30a/mZOwTG7aM+7e4cuyhr0LnKyDlxOIxDQs4HFoH9/VkdwKkWl1zh/4/KTwNk17NJFUcOti3R//ezYRwigZwPjHNTtSIrSn+azFBruJ5vVcOritL16cDyNQEDPilkNqmYpL18SR//9K9cu8houXaRqzhSxQZeo56wGVVBr7NV169TFvrrSXYLY24eIDapYmp6MBnWbDTsKus93KpzWDfXehpugAhZJ0LOBcx/UaT9B1VCbEKfPKJtqKrIo6F2UNehd1EUFbDNBzxpOg77cuW4s743pswwUv4px79BFVYPcRX00TqcRCOhZgVudQDQwKBANDApEA4MC0cCgQDQwKBANDApEA4MC0cCgQDQwKBANDApEA4MC0cCgQDQwKBANDApEA4MC0cCgQDQwKBANDApEA4MC0cCgQDQwKBBNFAbt/d5/54PZMy5EQUx6xm1Qj5JrJiY9YdAVEpOewg1a5J0+vflLnn66yFFx3v1hm2yyTzZFjq0iNfUxSco3QD/x6SnboCrvdKbRabtRmX5Ugt/99fN5d/38cnf9fHqtMqeVRcoM1fMLKpoI9ZRt0GORrl8lrlK6FinflK7lf9k7xyajf5nrD/QSoZ6yDbovBS2yZargk1xdCFoWySOThCteNBHqKdugx7aghVrGKz7P/CvhihdNhHrKNmg+IcqnRkpQpWL5VyNoWST/vRMJV7xoItRTtkHrVWeZEPtOJfBvC1oWOe+S5IviDdBPfHoKNyhYOzAoEA0MCkQDgwLRwKBANDAoEA0MCkQDgwLRwKBANDAoEA0MCkQDgwLRwKBANDAoEA0MCkQDgwLRwKBANDAoEA0MCkQDgwLRwKBANDAoEA0MCkQDgwLRwKBANDAoEA0MCkQDgwLRwKBANDAoEA0MCkQDgwLRwKBANDAoEA0MCkQDgwLRwKBANDAoEA0MCkQDgwLRwKBANDAoEA0MCkQDgwLRwKBANDAoEA0MCkQDgwLRyDHoy11S8OqjRyv//O4+PW21Jlr/AxT/9/skufr8g/5WJv598UqaXgsz6HmXwKADfFfIfPWgvQeDDtNo5EFu0BbSBJ+dY3L1PhtFt8n1c/Mmi/hBEGnQ0zZ7mQn5kL339bvk6gsl5eldknzy33m5998myefqvZ+2ydUftbcyf2Yj8F+VJ89qoMgKwaBtMolu1d/7LMYXkh+zmNUIXej187ZUeHZEGjR9Sl79rxKyCvsbJWPOe/29p/yFVkwz6FNZCAZtc9o2sb1lUF2vff4/1xIcKsqgSWm44nUmVPb39Yfz98VYunnOXuVaZu9lFv6YafkhF7R5q56Dvtxln/1UFIJBNXQ9WgYthS71vG05eUZkGjQfL+8rBdWfha7qVaNqOajqb2mLpPOPXyUwaIdeg2pCS9JMlEHv9f8pDKmuYuW6Y/7/agLVqLq3GPT8XbkjIElsCfSF+EpopdfRb6uPFaEG3deh3jKC7qtZksGg2RLr638cswIwaJtqkXT8j//BCOqEbtBsGf+faqNODaQfMrfmCjZz0FLVrNT79OfWW7n8St998snH859g0C77ZpspU2vz/NuuULAUupyDfvH827vCyTMjyqDVDrISLluGXz9X793Wq/h77bLXV/HaW1d/3tbzU1mjgQy0jfqnSiXjKl6EcCINqq5kNYreFhucaqszu+abfdDKjefv633Q6q3Tu+TVj0rjn7bJJ3+7K1alM5+ZNJSSxa3O87dJ8tkP2j5oqu+DfhhsaQLkGNSE3BscYCJgUCAaGBSIRrZBweqBQYFoYFAgGhgUiAYGBaKBQYFoYFAgGhgUiAYGBaKBQYFoYFAgGhgUiAYGBaKBQYFoYFAgGhgUiAYGBaKBQYFoYFAgGqJBn5q0SYAB6EmFZtCnMsfM0ybksawH6EmGZNCXt2W+qdMbJEFgAHrS8TdosipYRIeeNYNaEUN8GYqeDEl3l7/MSpqTZDpZ6Nm8HC5MoUzFaZrUL17QpP6D72ShZ/H6QCs9rh/yKB05IQxq6maFeh54Dbo3ZtVfvKABQnzB6vU8cBm0zoxoShm5fEHTZlRjWiRBT0XmT6456GmrZktrveI1mE4Weub2PPAtktK9yru7akFz2E529Xrm/mQ0aBaWNqsWtIDvZFeuZzn9ZDSoSrG9YkFLOE92zXpWyyNWgwZrISImONk16Fkv32FQZmBQBg7N9tLqDcq97b12g3Loqflz9QZNuA9v5Qbl0LO1O79yg+o3KRlbDMuy9Ty07x7BoDAoI/56Xvhz7QZFiGfGV8/Ozfe1GxSLJGb89Ow+HBLSoKt5PEwHj9uN5zK8K1Y/gnKz9hHUA5M/YVD7eOQ+Wq3doKP1NNoTBrVP6kdM+Vdu0NF69vjTxaCn1w/5M2DOCBbUvi0yZtOEXhx6avQ+Ok836HmnflbY/AAYrQWB6JJ1w09Qg0LPhr7hs6e4uUTxVe0xiQQEC6oFHVP4cQ/xj4/UktCzxuJPlxCff1Xb9D1tcgsSSRo9TYo6HfujglwaehbY7Olk0PMuScxP0Cosya5EC1rhf5Mut+cjvQnomWP3J9sq3pbsKgpBPW/SPVajJ9PJrkXPAXuyGdSeS4jSwvyMv0Pz+NgEd56TXYmeh0F/Ug2aCVZ+Vdu8L7IEQe30y/3YmnrSThZ6Kj2H7ckY4hee7KovYD1eLoy4Qvzy9aTYk/FO0rKTXZmn/I8de/Kd7OL1pPkz6D7ogp6+MRjU5M5OIQvr1vNAymqT0g162pbi9OyLZDOq61+yMqaM1QsQtBPize5MySe7bj0PZH86j6B9PN1mQSlTcx/ttsgA+rjV687UeQTtY8l6FvYkngXjNlOueHSrTpNQVvF6Qntdl+GYlq1n51tH1vNxu5N0/UvPlClaQR3vwA+4M3U52XXq2VkbDWzo0w163t0er5/7nr6ptkUiC0mm1XnvTbrGnZYzIp/sKvXs7swP3RJ1moNmgvatOjO51V/GZx8iFrShcqe/oCUr1NN044jPoMUVv7Snb2gh/uJepl9IKlmdnj33NdlC/MDTN159zMjwpP5y3uk7qa9Yl579t93ZFkmjES2oCU2y4VXRZd0AxzN9F7wkCeGpkL66DCXCtzAtVdB5dHZnCoMa8LCnk0GPlqdvPPsQRTFtH+XO1OVk16Knw20jAw6r+Lv7YH1Mjm3ek9TupNZo1yayEj1Le3ZXTux3kuy35vz6mBrrytE4dA6sNVsFaaxBz0M1errcDOkUpJYw7Rkz9TEx/XtvdWCnbt6b2yaxeD0Le6qI1BlBOfVsQrzrnEns42E98ujTzvAGXbqe9cqIfjOkt23PEuFb4KZ3K/7R/GmIED+eCPQ86Av3qUL8aGYR1CWJ1eWK3fkJJ70crZgP4vU8XOwrhdXzIsSP2BiZQ1DyFTp2O8nSMY2F6tlxp3/H1BJFJoyNezqhGQQlznG43UnqtGKBepbu5LOn+zbT6c1H53RCHII6rgx0QXsCTABzap0OszQ9Q7gzdTHoeVfmEjrOcMXTI0yngqnqYyB3pg6HuSQ9k0DuTN0WSSpd0CY9bV3vgDAtsxwVbfS8qBrOnJ2u7CxEz7S82R7And2uRpXICZrsyigobW3YrlqZs9k6lvorH3HoqTjU94v6WvGBy6CBk10Z4gp1d61+T4vr9oDle6QcRKBnTj12zqdnXWI/Zy6hzoVpDDXG3lTV9qSzufk2ItYNHSi5ZMx65hwqd86rZ72Kv7tXX1EwxZxgglrihfkOb/c93ZzdedTAP8EI6Kv4WPUsOGjzznn1rA369uHly949kSDJrqzxghSSWiOnKbBTA5vLMdOIUs+CQ39gn0HPqsR5d3/+5qF30y5AsitrvBi+4i/3kvTmmmua56cTLmpTiE7PgoMW2FMRetYlTq8fjmbF+mp6Pn1DFrQTuh8vzTnY3IhyltokItKzeO9w0OO6GD1pTauvKCqtWedMxJDUfmU053BzI8r1VeZAjp7FqwtzDjdH7ZZQ2buEQs2Z1Hxphkm9doXW3vSbrE+ySLIjQ8/mC8PGjXgZetYlbF/yKladx1fGST/Tv5mhUe2P9sBpXn/aZkqsx0VCtp75m403D3L1rEpYv+RVboscjdmwwhx8EzgedXOSVpNeQWfwsGjI1VO90qx5aH/aVyPIQTkZ1J7PstgW2ZtGhEDHnnSWQ/oAYPsejN+0feCoqAVl6tkaNXNvitezLmH9klfxbE5q/HVU2qE7R4nuasgumd2+XNCblabn4dKakehJmoN69pE6RonHrjkvGhEckirk6Nm1ZqcRwXqS5qCefXSXjv2v+reRBqs2+3sCnmYSoOeh15k9FXpezasnbQ7q10dLUNOFWbyyetPS8uUBGDtjgmkO6tuFVc/DJY69y9KzCfFBEw0k2ika/ugL6rTODYpedsaFQ4ifXE8vY+qdi9KzCfFhk12ZHjXKI8ewN+2ZlkxHYP/RaB8cQvxUenZ8eRhY1cSlp393ji00UeJR96ZFT2sXPp+OINRiwb2Lri+JzxVHpufkBm0/YVzuvluu+KGr1iXlgD/zG9Q0YJb1mruZC9JzfIfjnr5pW5NB0GkJeCADeg7OMDuTp55u6j8kIGkEfbzwpnE9b25fjJ5zjKDkpc8y9ZzEoJfWrGp2gpO5Azl6TmtQ1zX5IvXkM6jpvDujZn8LglSzMKFBE7ozTS0sRU82g15EjkeaN411BTOdQX00WZKeXAZtrloXZ9ZtRKLndAb1GwUXpCenQcdYs9OabGkjMajWWux6MoZ4T2tWjYlWNI4Q32oscj3DLpJGtSVZ0SkXSdCTViInaLKri7biFpQG9CzgMmjgZFetxiTryXVw0LOEyaDBk11prYnWk+lkoWdFfAa1Mr/a0RnUSgx6EkN8iGRXzgiIV1whHnrWh+BdIidAsitnJMz4ubqHntoxeJborTn1T/fFIej4pqHnuBLhW3DoSX5IiqGLpif5esZk0Cgm9TF0UXcVgZ60VXz1u37GVC2rwv3fAHraGNSKeieJ8CVa93885xoTdDHNCAY9maufd8O5giEoHeg5UXW/ppYoKB/Qk6G6X1NLFJQP6MlQ3a+pJQrKB/RkqO7X1BIF5QN6MlT3a2qJgvIBPRmq+zW1REH5gJ4M1QEICwwKRAODAtHAoEA0MCgQDQwKRAODAtHAoEA0MCgQDQwKRAODAtEwGTRPkXHeOfxwVV7jtE0SQ+4CU/Gs5L1TF2UNehfq91+vHhxPIxDQs4LrW2DqEJ42pO/aaDXIvxeofpv1mJ0tvYuqBv0nCU+vs9LZUbmcRiCgZw2LQffJ77LrV2UcMiUb6q+RPg1/M6fgmF205929QxdlDXoXOVkHLqcRCOjZwGLQvz+rIziVotJrnL9x+Ung7Bp26aKo4dZFur9+duwjBNCzgXEO6nYkRelP81kKDfeTzWo4dXHaXj04nkYgoGfFrAZVs5SXL4mj//6Vaxd5DZcuUjVnitigS9RzVoMqqDX26rp16mJfXekuQeztQ8QGVSxNT0aDus2GHQXd5zsVTuuGem/DTVABiyTo2cC5D+q0n6BqqE2I02eUTTUVWRT0Lsoa9C7qogK2maBnDadBX+5cN5b3xvRZBopfxbh36KKqQe6iPhqn0wgE9KzArU4gGhgUiAYGBaKBQYFoYFAgGhgUiAYGBaKBQYFoYFAgGhgUiAYGBaKBQYFoYFAgGhgUiAYGBaKBQYFoYFAgGhgUiAYGBaKBQYFoYFAgGhgUiCYKg/Z+77/zwewZF6IgJj3jNqhHyTUTk54w6AqJSU/hBi3yTp/e/CVPP13kqDjv/rBNNtknmyLHVpGa+pgk5Rugn/j0lG1QlXc60+i03ahMPyrB7/76+by7fn65u34+vVaZ08oiZYbq+QUVTYR6yjbosUjXrxJXKV2LlG9K1/K/7J1jk9G/zPUHeolQT9kG3ZeCFtkyVfBJri4ELYvkkUnCFS+aCPWUbdBjW9BCLeMVn2f+lXDFiyZCPWUbNJ8Q5VMjJahSsfyrEbQskv/eiYQrXjQR6inboPWqs0yIfacS+LcFLYucd0nyRfEG6Cc+PYUbFKwdGBSIBgYFooFBgWhgUCAaGBSIBgYFooFBgWhgUCAaGBSIBgYFooFBgWhgUCAaGBSIBgYFooFBgWhgUCAaGBSIBgYFooFBgWj+BcD/P+V9PWpJAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="do">## leave-one-out交叉验证</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>  y <span class="ot">=</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>  x <span class="ot">=</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>  </span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>  <span class="co"># 线性模型</span></span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>  L1 <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>  yhat1 <span class="ot">=</span> <span class="fu">predict</span>(L1, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> chemical[k]))</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>  e1[k] <span class="ot">=</span> magnetic[k] <span class="sc">-</span> yhat1</span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a>  a_R21[k] <span class="ot">=</span> <span class="fu">summary</span>(L1)<span class="sc">$</span>adj.r.squared</span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a>  </span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>  <span class="co"># 二次模型</span></span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a>  L2 <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a>  yhat2 <span class="ot">=</span> <span class="fu">predict</span>(L2, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> chemical[k]))</span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a>  e2[k] <span class="ot">=</span> magnetic[k] <span class="sc">-</span> yhat2</span>
<span id="cb30-16"><a href="#cb30-16" tabindex="-1"></a>  a_R22[k] <span class="ot">=</span> <span class="fu">summary</span>(L2)<span class="sc">$</span>adj.r.squared</span>
<span id="cb30-17"><a href="#cb30-17" tabindex="-1"></a>  </span>
<span id="cb30-18"><a href="#cb30-18" tabindex="-1"></a>  <span class="co"># 指数模型</span></span>
<span id="cb30-19"><a href="#cb30-19" tabindex="-1"></a>  L3 <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb30-20"><a href="#cb30-20" tabindex="-1"></a>  logyhat3 <span class="ot">=</span> <span class="fu">predict</span>(L3, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> chemical[k]))</span>
<span id="cb30-21"><a href="#cb30-21" tabindex="-1"></a>  yhat3 <span class="ot">=</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb30-22"><a href="#cb30-22" tabindex="-1"></a>  e3[k] <span class="ot">=</span> magnetic[k] <span class="sc">-</span> yhat3</span>
<span id="cb30-23"><a href="#cb30-23" tabindex="-1"></a>  a_R23[k] <span class="ot">=</span> <span class="fu">summary</span>(L3)<span class="sc">$</span>adj.r.squared</span>
<span id="cb30-24"><a href="#cb30-24" tabindex="-1"></a>  </span>
<span id="cb30-25"><a href="#cb30-25" tabindex="-1"></a>  <span class="co"># 三次模型</span></span>
<span id="cb30-26"><a href="#cb30-26" tabindex="-1"></a>  L4 <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb30-27"><a href="#cb30-27" tabindex="-1"></a>  yhat4 <span class="ot">=</span> <span class="fu">predict</span>(L4, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> chemical[k]))</span>
<span id="cb30-28"><a href="#cb30-28" tabindex="-1"></a>  e4[k] <span class="ot">=</span> magnetic[k] <span class="sc">-</span> yhat4</span>
<span id="cb30-29"><a href="#cb30-29" tabindex="-1"></a>  a_R24[k] <span class="ot">=</span> <span class="fu">summary</span>(L4)<span class="sc">$</span>adj.r.squared</span>
<span id="cb30-30"><a href="#cb30-30" tabindex="-1"></a>}</span>
<span id="cb30-31"><a href="#cb30-31" tabindex="-1"></a></span>
<span id="cb30-32"><a href="#cb30-32" tabindex="-1"></a><span class="do">## 计算均方误差和调整后R方(均值)</span></span>
<span id="cb30-33"><a href="#cb30-33" tabindex="-1"></a>mse <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb30-34"><a href="#cb30-34" tabindex="-1"></a>adj_r_squared <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">mean</span>(a_R21), <span class="fu">mean</span>(a_R22), <span class="fu">mean</span>(a_R23), <span class="fu">mean</span>(a_R24))</span>
<span id="cb30-35"><a href="#cb30-35" tabindex="-1"></a></span>
<span id="cb30-36"><a href="#cb30-36" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb30-37"><a href="#cb30-37" tabindex="-1"></a>results <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">model_type =</span> <span class="fu">c</span>(<span class="st">&quot;线性模型&quot;</span>, <span class="st">&quot;二次模型&quot;</span>, <span class="st">&quot;指数模型&quot;</span>, <span class="st">&quot;三次模型&quot;</span>),</span>
<span id="cb30-38"><a href="#cb30-38" tabindex="-1"></a>                     <span class="at">mes =</span> <span class="fu">round</span>(mse, <span class="dv">3</span>),</span>
<span id="cb30-39"><a href="#cb30-39" tabindex="-1"></a>                     <span class="at">adjR2 =</span> <span class="fu">round</span>(adj_r_squared, <span class="dv">3</span>))</span>
<span id="cb30-40"><a href="#cb30-40" tabindex="-1"></a></span>
<span id="cb30-41"><a href="#cb30-41" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(results, <span class="at">caption =</span> <span class="st">&quot;模型评估结果&quot;</span>)</span></code></pre></div>
<table>
<caption>模型评估结果</caption>
<thead>
<tr class="header">
<th align="left">model_type</th>
<th align="right">mes</th>
<th align="right">adjR2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">线性模型</td>
<td align="right">19.556</td>
<td align="right">0.528</td>
</tr>
<tr class="even">
<td align="left">二次模型</td>
<td align="right">17.852</td>
<td align="right">0.577</td>
</tr>
<tr class="odd">
<td align="left">指数模型</td>
<td align="right">18.442</td>
<td align="right">0.528</td>
</tr>
<tr class="even">
<td align="left">三次模型</td>
<td align="right">18.178</td>
<td align="right">0.574</td>
</tr>
</tbody>
</table>
</div>
<div id="结果分析-4" class="section level3">
<h3>结果分析：</h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>根据输出结果，使用二次多项式回归的预测误差更小且调整后的<span class="math inline">\(R^2\)</span>更大，这表明其既有较小的预测误差，又有较高的解释能力。模型残差诊断图像如下：</p>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAHgCAMAAABNUi8GAAABGlBMVEUAAAAAACsAAFUAKysAK4AAVVUAVYAAVaoqVX8rAAArACsrAFUrKwArK1UrK4ArVVUrgIArgKorgNRAFSpVAABVACtVAFVVKwBVKytVVVVVf39VqqpVqv9qf39/f3+AKwCAKyuAK1WAgCuAgFWAgKqAqoCA1KqA1P+enp6enq6enr6ers+evr6evt+qVQCqVSuqqlWq1ICq/6qq//+unp6unq6unr6uz8+uz9+uz+++np6+nq6+nr6+rq6+rs++vr6+z8++3//Prp7Prq7Prr7Pz67Pz9/P7//UgCvUqqrU1IDU/6rU/9TU///fU2vfvp7fz67f///vz67v////qlX/qqr/1ID/377/78///6r//9T//9///+////8yOZCMAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO2dDX/sRnWHx+bSW99ACK5zIWVrJ+XFhpQFYqCF0qZJaSMCvjSJ8M1ust//a3TeNdKOpDnzpqP1eX732mvtSCMd/XXmnNFoxA4EgRi29A4QxBQkUAI1JFACNSRQAjUkUAI1JFACNSRQAjUkUAI1JFACNSRQAjUkUAI1JFACNSRQAjUkUAI1JFACNSRQAjUkUAI1JFACNSRQAjUkUAI1JFACNSRQAjUkUAI1JFACNSRQAjUkUAI1JFACNSRQAjUkUAI1JFACNSRQAjUkUAI1JFACNSRQAjUkUAI1JFACNSRQAjUkUAI1JFACNSRQAjUkUAI1JFACNSRQAjUkUAI1JFACNSRQAjXLCHR/wySXnu92Vxv9qT27nfh2lK3aNtvIsq3+38e36by05/cNK17LePXcAL3aewuK2j8vSwn0ufjVssmjjRXos4d+ec86xQW6vxHXR+vuSkX2N+f3h8PjxeXIgqL2z8uiAtW/xlizQHdv33If+vjGfdlqRmjOZb2PFxv/gqL2z8uiAlVaanRb83gh2mVtAr7w7Idnt/IP+WMrv5SfdcGDMTg3ZLfIESgvK5dz+CJTjdl06SPcNM8emmU86O5Ke8rtc/+CXPavwPIetOFaEW2PFFurI8ctv+Jb5hhoq0tK0W1M66S2s332abeoL9DOg5pq7KYLH6Ko4vHFMjGorbdVjvNoQS77V2BRgTbyghVXLzecMaa6RsXhbzsD8RZT+UsR2J137aZouvgW3EV+gdpq7KbrHOki2LbZfBguyGb/8iybxW+Myfix767UgQubKBu0bhMj81BpIFPQFhbFHKNtzbZdgdpq7KarHnBdAgSayf7lWdCDPl6Iy7g1nULKakpOzZGBeEx0/it1BZuCEt70CI/ZW+TzoLaapoJAd1e6NlbV2VjCmvgs9i/Okk18K2LzvlR0q3J0Bcs2RzcxpqD83Z5/YPJKs8gv0LPeKTptD9rlRDxPEymQu0D8ymf/4iwag25V1O18IVsQEwM1wkCXXcPcss5A3e93jJeytvPHoLoau+nSx7gkwgPub3jueOlfkM/+xVlUoLsr0f0jtMJNJS9lc9GKhSKL5EZ94C3KRl28/IoXQbouqDa1Zc/1X63fg14qh2KqsZsufIjNgk28ysK53bperv6CjPYvzbL9oI1oZBp9IvXNuF4/nAznfqBioLNb0wC5d+1Uf4e7qCdQLuBnD1vTDyr1UqUfVN1G2vruJVahHcbAvQUZ7V8aGixSht3bt7uXi91JsvxiqKOjBdghgZZhf7PZv3u7uEDXDwm0EI8vblv/cCECAgmUQA0JlEANCbQM+mbSUt1Mp0O6QNmTAmabbURv9tJHWJd5c8AtmH0LKwJ4sDFZPNkTWKL8FlYE8GBjRqaRPYElym9hRQQfrI5BY5p4+CrrhQSamQoHS/YElii/hRVBAs3LKQhUZXpbOT5hu+CT5mpngkolDVh+AgLtkvcTECiT//bvCmG2zx6WetK825tAGvk4X8StzpMUaM+/sO4g1y9Qpn7svn/Bnh+ay8Pu5aJd3+FJ0tvyUR/qZpL0/Is+pQfn1wQrEajor2k2zeawf28dAjUPRMP9/SkKtOdfTkugTnvQXq7Ig6onyyYn7hhuOvjmyvro+5eTauJ1RN2Kkd+bNcWgmKtYBMe/nFSSpNnKsZUryeKxV1GdUf9yOgJFQmA309u38aOZTtKeY/6FBJoZ8qB5IYFmhgSaFxJoZsIPNnqGZbInsMTompW6Rfq3OqvNCTSyM6EF42dYJoECS5Tfwtzmu1udz1fTDxo/w/LqBdr3JdMObP0C7d3q5KxFoPEzLK9doH1fwiYP6Pp6dnN2baQxU+9Wp7g6l33SHBCDxs6wvHaB9nyJe1tzyPX4Vw6mBNqYyb3VKX42iyqUsvhZer5kQqDX41+5mBJ4Yyb3VuclCXQVdL7E38Tbph3kQVHHTOZWBGj8RX5Ag0WefRozNdPaBTrwJUdJUi/uBCRJTzZmAgFIki7b8QteDHWSb37xKHj19pzyJcOkaP1ZPDJA3UzPHsZCJvFSFzFW9CQFOsb1sT5PUqCLDpgEetCRActquP0g5j/l8aACb49SoEDX9JDXdMdahdoDkQOWR1p4JdBD6w1ST0Ggw6tstL/z9DzoVMdarerT2ZoZuD0O4QQE2nMik53x9QVauoVai0C1kxzBzhF/kgJ1ztHcnSKAQKPfSsEGf1TruF+C8KpjJrYDVoGVTqCzdzIBHfXRb6Vgw8+lFbqKJOlpjqjX50Y6kYD77MA7SZFvpagt0EWhO0lT2NYtSJx6jcASk2+lkAGVeDuOz8FWbuLnKeliSaATaPcUKk67SliJqbdSCIG2Iqz33QivmyTNU/QaIYGOwIzZGUSfubJ4LlDuYQ/9W3N1R9SHF7c/SuwCCfQIaRwlT3Z9Ddz7kgL1bKGnpUzKhTrEAgJ1doEEOkQaR+yziDvB5xySxU9kneIV9nK2tsZz/5+5n0b+6JUvrLfsTby7CyTQHrr9ZCxs8LFnA8ASo513XL/iORPfrbt+88d8fwyKQ44kwiHmDjrgAl3TreNoGNPn8po37bFeASrQpG6mIIGCBYegXyCqiT/Z+UFlOsSsUbjzZIdorwAVaNpbKfpNvD99imiylz9jEUnSyc4PyrqMnbfs14e0LBkcg6a9lYL1Pvf33PwV4BERSHKM4D2Dzw+6juF2xlsqcSZfTpmy+IgtDD1ldyyzZwBBoz5K+I6B5weFV7EEWqBanMlXExqBAlr2Av1E+XjqWTzT3jOHOOX2wkqUyDr7jZVXdf5DJIHigzH1T6gzqr9zdMPhJZKzzsFOD6IpT3A11pRDO6JqnlFQE38yT3Uy/U+JM/OWA0skZ50DWVk/aEZgHQl03FOCJFc3YgUkSVNPdWapoho63Lx2OpcybjqwROpbKTxJUXfledWYpymvHBBAupkmnurMUkUddOt+MHFn3t0DNPGJWeeRUDpxur8PRyUSwSrQyac681RRHN3pxfQgEHZI7PT0VZGhROAWjtpwM8rFutCjqnLlgRib+MmnOjNVURCbFYmR8cz+mb+eDCUCtzDSyWz1UyyXCdlwdOWvNHZDkdsBgEGg7KBb8+tDgcCzX1FIifm3UmyV/sZH1Ot8yJOrh3UuFQVi4Vc9PFsqDQKB6nZd5kVF9ZnNg5pYajs63E4d00QUveCtzpk4dVqSnk2FsLsSplppkiTP0bXt+yzoUjIJ1D7k7RtR/+GHhwP/z3+/ejX/n+mycp1K/311uvsE214YvEXirdH6BKo0qe+zV3hcIrzE1AzLXoEOt2CDUF+lxokFuClgXh7SAOkyoW5ybudC4CZr2GZtAhXn7/q6WErkqTC4xPQMy6Zp93WbdHVMjMbpVCdLHKtkMKIt2DgBpdNlOaguBHFNP158Y0ygszF9ZXTK3nXGV9qLcIHOzLDcBBhU5UkjF56TzZsSrm5cPwhqWUbD3gzu0ltdILLR2d+MJJ3zMX01jFNhapDSAatAM8ywzOzReYt12f6gxKsigI8DdrBJTMb0tQTKmNPZqfo7TZpbTZ+gGDR9hmVzsLOlj7vsnaXQJr6iOYsKNG8Vc7BOijIpMo7TKLYSFTvq5Uc26kDd4p4SztLsMWhOwmqa7VcOi+kLof207Ri8dhxn7QC4skB9/iywo95ZOpDwjNFKdiN7a8tCSExfAC1N27rLpt1t6msDEGiW8YvH3Uwx+ukPJJ3bANLxoBirMNq0HlM99Lbgc1CQJCnD+MVjBxrcAo/ZqHITPkdgE4/yuXinB4nZpGhh08K6mVLHL6p+puMvA4wwnvwHbqAS4XuC7rl488iGGqK0tDI1UA+aNn7RJ6awJn5ChsVizKhTBOsHxXSr04hTDQIpUwccWAyaPH7RJ6YgHUz5yULXepzwg1dJfUIhLzZtZ4jEKaiexYM2N5a512h+IkOH8DUwPRdvU/bgmY9rARbo33I0SYECGxNllY6j4gKNJnsV7mMb2AgVqEg7NzxkusiRdQYKbEwiJdKiqaH+sA2FFpx+DU2WKsK2xkxnJ6JUsyNQoCJgenxxu83SJAES91oC9YqxbJKE5DU0qiOJpc7xVYxAgcrLfRvTaeepI7zrc6RY9o7jjJIP96BLv4bGPH+TdyaQ3EAECu2kHx19E9x4jo3MOwWBLlaF6k7SJ0GLE6s8gQKN6FT215Gmr1pNfOyWShNfhR6qY36VepY9J8sINI1KSVLkhoJLgl8tmTweVGvT+NBr9Oo8hAsU1b1joL/DOVgkz6slw1di3YWt7rNX6q5LBNwPWqQO8BZB+qx6GiDdTBleLRlSnB065+mIE8FIkADWKVBw7fV2IbimyVdL5qnClDbO0/QnIU7ajyCBlqguiKlXS2aqwhTWzhPTIJBQTkGgJzmiPlcV+vpUznOFnIBAZwWIM0mqVYXp71xNo95n/QKt3ITPEbYnNXpF7FxX6EYoQcgm0PSZMCId3SoFKig8ol43LGsWpyCXQNNnwogOFXH15kG6mQ4FR9Tr63bt+swl0PSJBhIcIao+E0A3U9ER9WuOO11OQaCoCD+EyRH14kvR+kPtaS7W6+jXCyMjWxOfPBOGMeju5b2IaEfmeURPJlEIewpbAgWqU3b1+RT0mS9JSp8JQxm0FXlt++xhbJ5H7ORRhWqRRmYTHK9C98dn2QUkYOtm2v9o/969GDclHekKCT/YdqKbSYdMrXcqF1OFdpFOk6NmAoHuMmqwCZRLVAh0I3+tkfAs/mrqkQ8dMjWugAfD7XRM1DU5/5Tj9dfYKCnQuPGLT8WDTj80p3J8rlCPh2XdT2abnGtlsNMIPB1yZfFTd0bgAn0SMWgT8wBiV4Xt9ti/94+H5u9X2+TMkO9O0ri54QJ9Cll8wENzI06238Qf9v+w6iZnhmwC3d+M3rQ7tVZnkpwHOy1Q/caNtTc5M1RJkp4UyebqGBOoRkyPePrMyyuDpSO3kTB6BHllAvBDc7l3BjxsD0/xyFVHE9M1aKa2QOMfmsu1MyTQ1OpPW6DRD83l2hkSaGr1Jy3Q+Ifmcu3M0xNo7m2ctEDjH5obhQRaeRunLdD8kEArb4MECoMEWnkbJy3Q+Ec+cu0MCZQY5fFC90Of5v2fmpBAyxA/BTjRgwRKoIYEWgTxwFET9xoaogcJtARiOvX2/H5qlCIRBgm0APt3b9UQ2qxZ/NOEBFoAkSHJEbQk0GRIoAUQAn18cSue26RupkRIoCXgzbsIQ3dXOe/FP01IoCXY34inrtqsY0WeKCRQAjWpApVpgLizB4m2RPmN9DOQRyL0WtDKWiafIQVWpteCVlYQffiAFYIzNKBtgMkfeMd7JAp0dyWOrIV194lZN1p++nmkBugoNGsBKxPJiu6SBFRm1gJWVhBz+IAVgkUHsw1o0xE73idNoA37jriWgI/eiNx2f7ORuW74pajXipm1WDx/AatMrxU1RXIZzOGHok9NCFDbADZ9gO/4gDSB/ulBHJjslwbCryuxKnBMBV8rpjKeUUdUxteKqawg0xM+9VGnJgiobQCb1kB2fECOGHT39rfAU4VEawZe2ePF2S34JKi1Yo6sILAXUhcTKPwGBPRN2g45BCoCNuDULGLWLLhd5FrwysxMnMCrQawVUVk5fFONTYBHoMAd75Eliz9Axz82MkOG2qUxzgw62JKXj4knVHEEIzvVuKgm1JfrYVRoBBq84z4WEai6osCxub0OIwQamSRFVFYKsBsKPly4bUClU/xnHoGK/pjHN8OjDHmb+gDt3dBrQSsz5WGV6bWglRXEGA2wRrCKoN1MIIHCd7xHFg/awCYhUm8F24gpCgGrmbWAlZnysMrMWtDKymEOP5xwFQFtAxMofMd70K1OAjUkUAI1JFACNSRQAjUkUAI1JFACNSRQAjUkUAI1JFACNSRQAjUkUAI1JFACNSRQAjUkUAI1JFACNSRQAjUkUAI1JFACNSRQAjUkUAI1JFACNSRQAjUIBarfI7jxP9vqmUeBXlUg0GY7+3GANY4sZhfMTojKS1a1N0aBdscvZ37qm4MEOo6aTXjGGt7vzUI5kefoVCC6FAmUBBpHskD1NIlj04yQQCXm+B/f+OCKnf3kSkyAqOe+aBn7pn3P9f5mw/9mz02rI+fAsuUQzZpYDS3QX8qJPLQpeJstZp/89vfO7+WSnbCnNJeamduaUGxAvzZHzwYopzXSX/8zY5dm1aqGxihQGUz1dCdm6BVzg/ILXE2VJhY8vvlnNbt0V9CU4yJ+iq8o0i8MeC4U5phM6O1iY4yoTSW+0L+UCcUGmudmO04p8fXFpaPaqobGKFDrQa1A9QSBwha6ieembOT03Gpqxc50ciq7+Al9V40S6ItbxxTm1ws7h682laMrvfDgEaj5utum+lXP0CsRqHCqZ7dNJ9DHN//y7q1c7npQXU40QAkvllgtNgbtTKFniHeMqL83kx5bE4o/jpv47uu+QKsZeiUC7exnkqRf/PjNBzkB8tCDaloks9LVpCfQLqHp3KZZ0nnQzoTiL+ERdy/vt8/tVrqvjzyoprChkQv0hXrppQw5VURkpusVr3GTr5eR17f8RgVeerWnLlDHZNohOsYxMeiL286EcgvyPT/KNUqDOl93q3Zbr2Bo3ALd37CN+H+QCaRsj97SHlRMHc+/Yt9V7VfD2Fsv7025p53F2w4NbTL9Dgm9RNizy+IdE6pNXHTTsHKDOl/r09Fl8XUMjVCgxOL8DU/rQwIlUEMCJVBDAiVQQwIlUEMCJVBDAiVQQwIlUEMCJVBDAiVQQwIlUEMCJVBDAiVQQwIlUEMCJVBDAiVQQwIlUEMCJVBDAiVQQwIlUEMCJVBDAiVQQwIlUEMCJVBDAiVQQwIlUEMCJVBDAiVQQwIlUEMCJVBDAiVQQwIlUEMCJVBDAiVQQwIlUEMCJVBDAiVQQwIlUEMCJVBDAiVQQwIlUEMCJVBDAiVQQwIlUEMCJVBDAiVQQwIlUEMCJVBDAiVQQwIlUEMCJVBDAiVQQwIlUEMCJVBDAiVQQwIlUEMCJVBDAiVQQwIlUEMCJVDDSKEEZoRAmcPS+0MQPUiSBGqsQNvz+4ad3S66MwQxxAh0f7PZXW3aZw/L7g5B9DEC3b19y33o4xv3y+4OQfRxPGjz7KEhD0rgootBeQD6+GKZGHR3xRg79zlvHnYMlmznr6F241mvNqVj+v2N6na59HzXHX3r2YMA2wQYuRYYsviWCYttfWczRqDLi/NQIabf3zwXv5TtRiGB5mArTa0t3me1Ai0e02tzea3WcSIClU2sxNvOFqZn44bvhPhzy39vtDEbtyXrbNeaxf11Hi8Ye/ZneRJ0id3VD67YtKfJTvGY3lhN2sNYSBw7MwEOX3j2w7Nb+Yf84dhUF5SrSEvx+M4uco2stmwLmZp2b/9QaGVrVtmqugbnKgcYPGjLrEIbfpC7q0vpVNXnjfz9eGGO2tqulWfiuX8deUJMid2VsGzlPt7SMb3rQY2FpI74USs5cgGJnbACdexjCtrtbJ992i1yjKy3bAo9mJp2V6KE2aKta3CucoBBoPJ6lr5b6EzAG0h1bXNjqmWt8e3GdvsbuVicgON15P9+CeUETgct0EZehNpCxkjKR+rA3gjUtU/rtJQN/8y34C6yRrZb1oXs3/KD3aJTV+9c5cAKtFmsiZfwpFRefJ2KWt1YqTDKfmNspxbwn751nFPEf3aN3AlhsviNCTTlgarzJ45VqaR1m/jOPqagLSyKOefeGNnZsizU+/tgt2jrGpyrHNiOeplybrOGD0B4O2HbRH65nP9KX+3MnglZqidQ0Vx51nEEKk9HZYHWiOmlB328EG60s5BUrTr65kigrn10QQlvqIVRe4uMQO2WVSH7t41y5RZtXYNzlQPnTtLu5TJ3kswFJwP1TbfINEdnnQB5/D3qQd11noQHVdq8HKbqulU/8qA9++iC8nd7/oGxjVnU96BdIfu33Ibd4sCDZsW5k7R/93YRgZp81IQ2Bx3FtKY56ilrNAZ11xnGoCcrUCmp/qFpk6nLs+ki8J59dEH9+x3j6K12bQy6sVt9R4ahG6eg3aJTV3Yj2xiUt5Rt5h6CUFom7CGdgcgCuenVhc4ubRbfdeP7s/j+OpfDLH4BgZaO6bVAZTptLCQdmLkixUKRWe9vnj3w5nvj2tQUVJvail6U3qJeFq9sLwvZv60HlVvsZ/H+Wy6xoMjiZcymjkr3aYo+vFtjiMY901t7h2/YD2rW4UWG/aD1BVo8pjftTiOva22hVtmx1w8qrfsDFYNam7bW4AfTueQu6oxsba97oPTfXQ23Wr7s/JeiXJP7qkQh0BNkwZh+KbL2Llm6LH7ZbqZTY8GYvj4yBjW5QGb6HnR7WonEkiwY09enzdy35NAX6BO54on10BdomTCCIKIZxKDUxGeCYvpMpGfx7EkBs01MTG+r+rDaQd3d3VWra0CAOeAmHGwhdQOzm+f/eEbMP7fPHhZ+7hR4sDExva3iQ/CqDnfQ8tAV8hAo0KTBDWUFytSP3fcv2PNDc3nYvVy00QQebExMn8meEYq7q69SgAdt5JDUiG6RKgIVZ7rZNJvD/r11CDQ+ps9mzxi51ZZouEDl4NO0JqkMzNbQXq7OgyZVkdTEp1BRpeECtYP6C9SRhtzDVtwW3qwuBk2qIotA48RWTaKAJl6OV518QjC6jhxs5V2Z7dKzR4UdbKmYXp2srRzUEWyKaLHd3ZUPSk8gi8dF+MEWiOkTOjQSlFZUpCTQzIQnSekx/bCJT+vQwCnR0G6mt2/j73yQQH1kiOlHBLpQh0aZ5p48aGbCDxYc08/fXEnv0EgLK+WqeWVKAs1MzSze8xWGDo27nDoFCDR6NrYq3Uw2dV14OAuGbqb0Do0czXWeJh/SDxo7G1vNe/HP19FRnyemL9pRn8kNpnZFge4kRc7GVvFePGcVAsVehSVX5hOtU5AHBc7GFj5iyq1ICgzQPPVSV7Hmsg9RnJhAJfnyc7hOITFo7GxsYQbVGWgrGj1QgO+mruJns6hCw9WTHtNXvBeftwsJoFI0Wbx2hPsfic47WBeJm7perkagGWL6Y4GWfUY8561NFeLObw2bQA+ydxnWyWyzeJm6Rg0XyAfkTlL2mJ5Vaf9zetNZncIGizz7NOahTlATfwB70DpnJRSIB42cYXm0Cjb5bUayd8iP6xSSJF22mQ3qrUgIFBKDVjsrYQBi0OSYfuRWZy3usvbIqy0ehoEErJvp2UP5bibZtsOzeCws2lG/TGNSZtCd1inUgyIcsHx0VhadTSpT3eJGvXzpgcchzI4HXYYyo0NhMShjMXd369zqdKtbULCgwSLjMb14+4BwBkCBIiCzTtFk8dk4avLrtnuAJGkipleDRQdZ/tGNj8WeSQogl05BMWixOnIyFGjlGBXUzTQa02tjt14XuwqBGurdi4+f2K5yk8SOHChKgU7H9Fsz+axnMMlkFUinc72LTfkBHjTTiPryFpyLSctWHlxyMqa30yMDBYqrU9iDEWqoUqvHoAtYEGmSlF6F51ZnpV3IgKfP00dtgeaxINJ2TACJQVOr8AsUsXHGuBv3q/Jg/nr3008O6oP55JTAJ1DM7Vj4jhWJ6Zk4X2iNM8+RXxXH8vr9L/g//uHr/x6q84CxiS/RjiUeZbd6uAct85Ss3JMVK9RF6FQcyue/O3z1h8/4h6/+49d3Px+WCjx13XtJjsidJCUL9HgXEi8bZ/VlY1D0Uah6cswMBQqZ/ZP///yjw9d/FAJ9/bPPxB+DEkFHa7pLtp7BbtnNlU9O3ZKUTbqrLy1QZHd+B6gnx9So9LDz2POggte/G5YQRebmErIRf9ituVSbJa3vUeNKBTry9ZK9bDOoJ8fUqPQwq/diUCHOcQ86NZcQTKDJNsst0JU28Z6v2PAjribfPDkGE6jK4r/6zy9EFj90oIHzg5qm3XdnxNmHLoQPstmIEAdygsrVp8b6SVJCZebD8XC77kY9c+2MRqAC8ViOel4itImfKaGLzMwl1IQkSWxguPmd8xUbrA/3foFqjBLtkgIVPUxHjhNVE6+eHDMCDU2SZkqYIunzgzoGYwG7Nybk/vJiLiLuzIatUmZ+UNbts2MVTEmSfnIM8MQZQKDRuFpSV7hp6UdacDffGHGhPQdaRKCR2w1fAzw/6Ow8A8waGJnjTCC3QCfHL6o2yK15Wn6zEp4ulcbo/r3y0lsthALzg6oY1BjvJPQJbOJTn+qUYp3xj+7yMCNnPhV+AR5LcWRnQqspMD/oATCPy1qAJEnpT3X2RBmWAh3tR16mBFg4Sco/5z9koqG1EC7QLE919qPHkfZ7zLEeL51zdvOAD2aOmln80RchqefKgHrQ1Kc6Q8znK9Pzq+Xklc6y3Uyn50Kh3Uwj+pzsNhmrA2JKK1CkurSAmvjEmH48BgXOKIiYbFm8b5TIdB2m0Q7MhPi/EXGisjIgSco+U4v1oKEdGyvoi8omUG5vWB3GJ1ojzVQ0mr7gsjKkmyn3TC2mHzS0C7dUF3JOAEnSlfCR+QyqrWONNKmzvuvsp1rjVSwB0IPmfQ2Nvtc5MMloSITMdF4gAhXxZcYr3vGebNJYw4a9XxSZlYHdTEkztRxPHqZjUPcK5sZ7NdY84Wp8vIC6mRq2SReoM/DHFeeYzjxh56AoLisv2c0kFKqs1d2yk3+/GtrI3k1GZDk/IIEeHi++kSrQYzmN3zwey9gHRVFZOde+BD9C0//KJpLKRtp+rwar4bqmJ4EJlDdLiaNvJhrkns6muzlRSbJPeJI0GdMHPULjmwJcOMtXxs7GgvID2rB9kmxZfGAdrm28W8bbBR8GQKATMb33CQXT1fwhF6b/v/hO/H/1avCdWD4sO7INZP9rC9RpXQbtjE+ZiD3lGJBupvGYHviMl/mC8WhT9YMKU/YcQ+/mG4omPuwedKBAM77t2Dfac6wHPo8dcU59M4PZwj4AAAspSURBVB3TBz5CM/hCtPAmkR+557n0XWLoMIjqHrS/VPywl/WwXKZQqa67AAl0IqYPeYTGc6tTC5SxucOuLNHo4RM1Bep5HtbZZU96P7qDUXfx61Czm2l0wDILmWCkgkQzjBoLbeIzPEPjizkHhY4Vmt6/XHm2oiX7QfWtTnNLfnZXSkk052gzgAcFP0PTr2M05mRs8PWwK3/4GegTMTbxGWP63hesO9ygViZnMFpmkC2wHzThVqeRlehLHnzL3N8jgnKWwgR6wh50pImfjT97JCqqjCw7wgWa/AyNiTl73R+O2ianwugtBTbxvu0VY3mBqt+gLcL1VViWHYAmPvkZGuE6j+Qyv8CzFGR/lE18oefie48lwggRW2l36aF2N9Ox/I4MOtvEg+uvqE/ATibG9N4vjETjGFNefVl2QGPQxDp8F/hx/2dy19KCBO9lkefitUgT6HS4gLu0QOa6smXBU1Z7Jm5IusBXQfDRFXouPkc8s+y9psNxRjxd2HjQ9G6RyvnKIoQfXv7n4rssKYm6Qbt/B9zUeq50vhh0IYEijUELVJHlqePl3chiAl3m2sSYxR9iYvqjkMkz/WKGEGpJgTaqTYlq4vXwhbRukQUCULT9oOmvofEJNMzEk4WWa+Lb59osMUnS7mojnkLM2S0SzSkMFilxqzO0iZ+R4GJ5bPPOUVQO6mbavbzP+hy3v6KgDcIUirGJL1FFuD6XzoP8iFGwTb9hCRfo/mazf/c2RaDTxgvXEdS+J5sk+R47DtkBtAIV4mz7bTQgBn18cdv6R9DObcH+muogCdsbYNH6hO9Xekx/LNDAHVi8I2mENsWDxsO6nxOtk1Nyrkas9hUAYtD8MT0LNSHWuyXNkQdEI1DHuPN7hdW+B1g3U/6YfnyOgbUSKNACI+r9FSFvwOcJ3vP0mN7/KsTD6k2o0K88hvSDpo6+0YNp51ofd5X1Eb7nqTH9CQr06GXcwG6mQ+rsdiyk9Vl3+5Rp18WNeqFd0HPx62zijSBdWXZAupmSR99IuwUodD3GPSbTvoseQWFrmECDkyQM9D3lGIAmPsub5mDPy9Qj2xkN207Y26Pbc28Sld7NtBSeJnyOelm8/oRUn9n2CtAPOv/26NY7if2UQHu3kr789d3dz4drf/2xfJ/1X4dvDf7q3z/58refDUtnBCLLjmwCDZsuMCBJWoKMrgfSzXSYfXt043rY4wHgR5X3zPv6Z59xOQ4VOiHQ7o9MUo3wmEMAAm2nupmCpgtEyxICnY7p1bdcoYC3phz6I+q/+r1Q4pe/+aRfRgv0848G62YUqM16ErZhUEfz1R/G98cZzTS+mbjZ2PCwRBOfHtN/2EuB+W/muivhQBW8qf/pJ+aXEOjrO+E/X9/JxQf18V9UEy8XfvV78Q3/yCOEL3/7P3eiuIgXPhKyv/vZuFjUvkQc0/TBvp6qM+ihubULtHaSFMaIySf6Qd0L7fX7X6gPwpVytepfXKCvpS6Fy9RlxFef/1QIVC8UUpXl+cJf/86szZcKeX9uNuyQz2UONisO5+v//fqP8wJVQf0YUdMFniI1Ber7zglBjY6k2pR/5L++/vi/VKuvQgBbVJXQC00TLxby0vxPvTW9ka7CIsq07YI52BCBzgywDZku8CkQfrCTMb0kQqAOtokX2hJ+U/36+uP3/08lTry1vlMa/dwKVC+UAhWNunSr4k/tNsUyGxiUU2ZHuEDjIYH6mIzpw6oYu9WpUM6Q/xx60I86F6hF3HlQvVCqkrtOvbDvQQ+pmbmH0Q2SQDMD7GZKqmJaoCKq5C7z/S+OYlDV+gsBaoF2MaheaL77q/WgMgb9DZc3F1LO7tI5qQMEGjTA1jfpPwnUy2RMn6UKlYZ7snjVO+pk8fyrf3WyeF7g7iOhxX/7+CMtUJPF3/3eaeFTCHTCgMEiiB6aQwygic/+0FxJsjXpwOgANJqp7ENzp0GFgw1t4vOQLdyM2xBkNNPkANupW51PCvApAGOr+nDBwwTBlRm9boA59IfJAbZTtzqj3UrcamuoTBD90FyOypdZtUj7EuQTJu8krUMztQUaH9NnqJwEOthGZNUV16ov0OiYPkPlpyjQoOFhI6Nz1qCZ2gKNf2guQ+WnJ9DHCx2zjj3yMXGrcx2aqR6DRj80l6PykxNoyp2PdWimukDTIYHKbWbY6Bo0QwItv2pJgYrgsokbYLsOzSyQJB3iHuPOUPnpCbTh+mzP70f6OQkoszE9EYoUKM83VaaedMUTDikxPeGg5mbi1tzfXJJACXRYgT6+uBVPalOTlIWkmJ5wUDEob95FGLq7Sum3IywU02dDCXR/w85uD21SvzJhoZg+H09rQHwlKKbPBwm0ABTT50O/vix8ACkRAMX02SBJloBi+myQ1yRQI9SZIlKZBog7e5BoS5TfSD8DeSRCrwWtrGXCm0Er02tBK8uBs6fAne6Xh2Vozqra0FHrarvlwygzMgDdXYk9a2HdfWLWjZYfBo/UAB2FZi1gZSJZ0V2SgMrMWsDKsuDsKWyn++XVqYlY1Rg6Zl1jt3y4ooRrtGHfEZcp8NEbkdvubzYy1w2/yvVaMW8iEc9fwCrTa0W99iQRZ0+hO+2W16cmYlVj6KhqD7mHIVhFRjnQPz2IHZP90kD4ZSpWBR4MXyumMp5RR1TG14qpLBVnT6E77ZZXpyZq1QNwaqnBuk3WmIgdfYChdu5b4MAjWjPwyh4vzm7B51qtFXNkqWQSKDAGTRFZb11pt4wwzycIYudE4LF7CWo+xdzXcIHKteCVmfdpAK8GsVZEZalgEKhvavLQdQvGoDEYKwCVJjNkqGYac21CoxxePiaeUMVrj+xEINAG2EQNwoMyMWgkUQJVFyg0Begu6wiBRiZJEZWlkilJAgq0l18BXWCdJCkSsWPCpz++GR60yNvUB2gnil4LWpkpD6tMrwWtLAuZupmA12O/qwhGt25+g2XxoA1sEiI1E9lGTFEIWM2sBazMlIdVZtaCVpYDvaeihwu40+6qUIF2qxpDR1Wb3WB0n5NADQmUQA0JlEANCZRADQmUQA0JlEANCZRADQmUQA0JlEANCZRADQmUQA0JlEANCZRADQmUQA0JlEANCZRADQmUQA0JlEANCZRADQmUQA0JlEANCZRADUKB6vcIbvyPzXqmBaBXFYSyQkthFGhnRTnzU9+oJNAEVmgpEuhTYoWWQizQxzc+uGJnP7kSEyDquStaxr5p33O9v9nwv9lz8YdRcleu9qyJq8DOpCXMpG2oTPb47e+d3ytzihjr726gE7+UAqNAZQza052Y8FfMDXq10TOviQWPb/5ZTVbdFTTluIjpFUUetECVmf4ibfgXZbLHi42Z+1tamW20LZfeZYwCtR7UClRP8CdEp5v45vmhkTMQqakVdSFdDjQ/8FNCm1abSdpQfzYzhhkrR02AXYKVCFQ41bPbphMov/TfvZXLXQ+qy4nWCfaeiieCEagyk7Sh+Wze1qKszN2nseXCrESg3fT+5qL+xY/ffJATIA89qCbvPL8nguNBBdKG3SJtTseDIgC5QF+ol17KkPON+y4GPcjXuMnXy8irX35zfq/L5X8ZyongxKByYlduQ2MyPc/rtheDIhApboHub4Sh1FSi+r1ab2kPKqaO51+x797Ia71h7K2X96YcZfF+VP55acwkp99Xn1UqKs0pSom+El1oYRAKlFgeBNmRhgRKDMAVIJFAiSENpgCJBEqghgRKoIYESqCGBEqghgRKoIYESqCGBEqghgRKoIYESqCGBEqghgRKoIYESqCGBEqghgRKoIYESqCGBEqghgRKoOb/Ab1ueJaVxyKkAAAAAElFTkSuQmCC" /><!-- --></p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>二次模型拟合看起来总体上是合理的，但存在一些潜在的问题。由Residuals
vs
Fitted（残差与拟合值图）可以看出，图中残差点随机分布在零线附近，但有一些点偏离较大，可能表明存在轻微的异方差性或有影响点；Q-Q
Residuals中的点大体沿着对角线排列，但在尾部有一些偏离；Scale-Location（尺度-位置图）显示残差的绝对值随着拟合值的增加而增加，这表明可能存在异方差性；Residuals
vs Leverage（残差与杠杆值图）中一些点的杠杆值较高。
鉴于此，需要进一步的模型诊断。</p>
<hr />
</div>
</div>
<div id="三习题8.1" class="section level2">
<h2><strong><em>三、习题8.1</em></strong></h2>
<p><span class="math inline">\(\hspace{1.5em}\)</span>实现Cramér-von
Mises两样本检验的置换检验。Cramér-von
Mises统计量用于比较两个样本的分布，通常表示为：</p>
<p><span class="math display">\[
W_2 = \frac{mn}{(m+n)^2} \left( \sum_{i=1}^n (F_n(x_i) - G_m(x_i))^2 +
\sum_{j=1}^m (F_n(y_j) - G_m(y_j))^2 \right)
\]</span></p>
<p>其中<span class="math inline">\(F_n\)</span>是样本<span class="math inline">\(x\)</span>的经验分布函数，<span class="math inline">\(G_m\)</span>是样本<span class="math inline">\(y\)</span>的经验分布函数。</p>
<div id="代码实现-4" class="section level3">
<h3>代码实现：</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a><span class="co"># 加载数据</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a><span class="fu">data</span>(chickwts)</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">sort</span>(<span class="fu">as.vector</span>(chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">sort</span>(<span class="fu">as.vector</span>(chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a><span class="do">## 计算Cramér-von Mises统计量</span></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>cvm_statistic<span class="ot">=</span><span class="cf">function</span>(x, y) {</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>  n<span class="ot">=</span><span class="fu">length</span>(x); m<span class="ot">=</span><span class="fu">length</span>(y)</span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>  <span class="co"># 合并样本并计算经验分布</span></span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>  pooled<span class="ot">=</span><span class="fu">c</span>(x, y); Fn<span class="ot">=</span><span class="fu">ecdf</span>(x)(pooled); Gm<span class="ot">=</span><span class="fu">ecdf</span>(y)(pooled)</span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>  <span class="co"># 计算 Cramér-von Mises 统计量</span></span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>  W2<span class="ot">=</span>((n<span class="sc">*</span>m)<span class="sc">/</span>((n<span class="sc">+</span>m)<span class="sc">^</span><span class="dv">2</span>))<span class="sc">*</span>(<span class="fu">sum</span>((Fn[<span class="dv">1</span><span class="sc">:</span>n]<span class="sc">-</span>Gm[<span class="dv">1</span><span class="sc">:</span>n])<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">sum</span>((Fn[(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(n<span class="sc">+</span>m)]<span class="sc">-</span>Gm[(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(n<span class="sc">+</span>m)])<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>  <span class="fu">return</span>(W2)</span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>}</span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a>t0<span class="ot">=</span><span class="fu">cvm_statistic</span>(x, y) <span class="co">#原始统计量</span></span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a><span class="do">## 置换检验</span></span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">23456</span>)</span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a>R<span class="ot">=</span><span class="dv">999</span>; z<span class="ot">=</span><span class="fu">c</span>(x, y);n<span class="ot">=</span><span class="fu">length</span>(x);K<span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(z);reps<span class="ot">=</span><span class="fu">numeric</span>(R)</span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb31-20"><a href="#cb31-20" tabindex="-1"></a>  k<span class="ot">=</span><span class="fu">sample</span>(K, <span class="at">size=</span>n, <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb31-21"><a href="#cb31-21" tabindex="-1"></a>  x1<span class="ot">=</span>z[k];  y1<span class="ot">=</span>z[<span class="sc">-</span>k]</span>
<span id="cb31-22"><a href="#cb31-22" tabindex="-1"></a>  reps[i]<span class="ot">=</span><span class="fu">cvm_statistic</span>(x1, y1)</span>
<span id="cb31-23"><a href="#cb31-23" tabindex="-1"></a>}</span>
<span id="cb31-24"><a href="#cb31-24" tabindex="-1"></a><span class="do">## 计算p值</span></span>
<span id="cb31-25"><a href="#cb31-25" tabindex="-1"></a>p<span class="ot">=</span><span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(t0, reps)) <span class="sc">&gt;=</span> <span class="fu">abs</span>(t0))</span>
<span id="cb31-26"><a href="#cb31-26" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb31-27"><a href="#cb31-27" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot; Cramér-von Mises 统计量:&quot;</span>, <span class="fu">round</span>(t0,<span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="st">&quot;p 值:&quot;</span>, <span class="fu">round</span>(p,<span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>##  Cramér-von Mises 统计量: 0.152 
##  p 值: 0.385</code></pre>
</div>
<div id="结果分析-5" class="section level3">
<h3>结果分析：</h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>Cramér-von
Mises统计量不为零，但p值大于0.05，这意味着我们<strong>没有足够的证据拒绝两个样本具有相同分布的原假设</strong>。直方图展示了置换得到的
Cramér-von Mises
统计量的分布。红色线表示原始统计量的位置，可以看到，大多数置换得到的统计量都小于原始统计量，这与较高的
p 值一致。</p>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<hr />
</div>
</div>
<div id="四习题8.2" class="section level2">
<h2><strong><em>四、习题8.2</em></strong></h2>
<p><span class="math inline">\(\hspace{1.5em}\)</span>对双变量斯皮尔曼秩相关检验进行置换检验，并将其与cor.test的p值进行比较。选取习题7.10中用过的ironslag数据集进行分析。</p>
<div id="代码实现-5" class="section level3">
<h3>代码实现：</h3>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="co">#加载数据</span></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a><span class="fu">library</span>(DAAG); <span class="fu">data</span>(ironslag)</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>magnetic<span class="ot">=</span>ironslag<span class="sc">$</span>magnetic; chemical<span class="ot">=</span>ironslag<span class="sc">$</span>chemical</span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a><span class="co"># 计算Spearman相关系数和p值</span></span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>spearman_test<span class="ot">=</span><span class="fu">cor.test</span>(magnetic, chemical, <span class="at">method=</span><span class="st">&quot;spearman&quot;</span>,<span class="at">exact =</span> <span class="cn">FALSE</span>)</span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>spearman_corr<span class="ot">=</span>spearman_test<span class="sc">$</span>estimate; p_value_cor<span class="ot">=</span>spearman_test<span class="sc">$</span>p.value</span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a><span class="co"># 置换检验</span></span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>);R<span class="ot">=</span><span class="dv">999</span>;comb<span class="ot">=</span><span class="fu">c</span>(magnetic, chemical);n<span class="ot">=</span><span class="fu">length</span>(magnetic)</span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a>reps<span class="ot">=</span><span class="fu">numeric</span>(R);t0<span class="ot">=</span>spearman_corr</span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a>    pp<span class="ot">=</span><span class="fu">sample</span>(comb,<span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a>    x1<span class="ot">=</span>pp[<span class="dv">1</span><span class="sc">:</span>n]; y1<span class="ot">=</span>pp[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>n)]</span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a>    reps[i]<span class="ot">=</span><span class="fu">cor</span>(x1, y1, <span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a>}</span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a><span class="co"># 计算置换检验p值</span></span>
<span id="cb33-17"><a href="#cb33-17" tabindex="-1"></a>p_value_perm<span class="ot">=</span><span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(t0, reps)) <span class="sc">&gt;=</span> <span class="fu">abs</span>(t0))</span>
<span id="cb33-18"><a href="#cb33-18" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb33-19"><a href="#cb33-19" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot; Spearman rank相关系数为:&quot;</span>, <span class="fu">round</span>(spearman_corr,<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb33-20"><a href="#cb33-20" tabindex="-1"></a>    <span class="st">&quot;cor.test的p值:&quot;</span>,<span class="fu">signif</span>(p_value_cor,<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb33-21"><a href="#cb33-21" tabindex="-1"></a>    <span class="st">&quot;置换检验的p值:&quot;</span>, <span class="fu">round</span>(p_value_perm,<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>##  Spearman rank相关系数为: 0.743 
##  cor.test的p值: 1.85e-10 
##  置换检验的p值: 0.001</code></pre>
</div>
<div id="结果分析-6" class="section level3">
<h3>结果分析：</h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>斯皮尔曼秩相关检验结果为0.743，表明磁性和化学特性之间存在强正相关关系,即随着磁性值的增加，化学值也倾向于增加。cor.test给出的p值（约为1.85e-10）非常小，表明这种相关性在统计上是显著的，几乎可以排除偶然因素的影响。置换检验的p值为0.001，同样支持这一结论，进一步验证了原始数据的相关性是可靠的。</p>
<hr />
</div>
</div>
</div>
<div id="作业2024-10-28" class="section level1">
<h1>作业2024-10-28</h1>
<div id="一习题9.3" class="section level2">
<h2><strong><em>一、习题9.3</em></strong></h2>
<p><span class="math inline">\(\hspace{1.5em}\)</span>使用Metropolis-Hastings算法从标准柯西分布中生成随机变量，丢弃链的前1000个样本，并比较生成的样本的分位数与标准柯西分布的分位数。进一步使用Gelman-Rubin方法评估链的收敛性。</p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>标准柯西分布是一种具有无限方差的连续概率分布，其概率密度函数为
<span class="math display">\[
f(x) = \frac{1}{\pi \theta (1 + (x/\theta)^2)} ,
\]</span> 其中 <span class="math inline">\(\theta = 1\)</span> 和 <span class="math inline">\(\eta = 0\)</span>为标准柯西分布的参数。</p>
<div id="算法思路" class="section level4">
<h4>算法思路：</h4>
<ol style="list-style-type: decimal">
<li><p><strong>定义目标分布</strong>：在本例中为标准柯西分布。</p></li>
<li><p><strong>定义提议分布</strong>：使用正态分布作为提议分布，其简单且容易生成随机样本。</p></li>
<li><p><strong>实现Metropolis-Hastings算法</strong>：</p>
<ul>
<li><p>初始化链的首个值。</p></li>
<li><p>迭代生成提议值并计算接受概率。</p></li>
<li><p>根据接受概率决定是否接受提议值。</p></li>
</ul></li>
<li><p><strong>生成直方图和潜在尺度缩减因子图</strong>：绘制直方图比较生成样本与理论分布的符合程度，并使用Gelman-Rubin评估链的收敛性。</p></li>
</ol>
</div>
<div id="代码实现与结果分析" class="section level3">
<h3>代码实现与结果分析：</h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a><span class="do">## 柯西分布</span></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>theta <span class="ot">=</span> <span class="dv">1</span>; eta <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>df <span class="ot">=</span> <span class="cf">function</span>(x) {</span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">/</span>(theta<span class="sc">*</span>pi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>((x<span class="sc">-</span>eta)<span class="sc">/</span>theta)<span class="sc">^</span><span class="dv">2</span>))}</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a><span class="do">## 正态分布-Proposal distribution</span></span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>dg <span class="ot">=</span> <span class="cf">function</span>(x, df) {</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>  <span class="fu">dnorm</span>(<span class="at">x =</span> x, <span class="at">mean =</span> df) }</span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a><span class="co"># Proposal分布中生成随机变量</span></span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a>rg <span class="ot">=</span> <span class="cf">function</span>(df) {</span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a>  <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">mean =</span> df) }</span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a><span class="do">## M-H</span></span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a>mh <span class="ot">=</span> <span class="cf">function</span> (N, df, dg, rg) {</span>
<span id="cb35-14"><a href="#cb35-14" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">numeric</span>(N); k <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb35-15"><a href="#cb35-15" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rg</span>(<span class="dv">1</span>) <span class="co"># 从Proposal中产生X1</span></span>
<span id="cb35-16"><a href="#cb35-16" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">runif</span>(N)</span>
<span id="cb35-17"><a href="#cb35-17" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb35-18"><a href="#cb35-18" tabindex="-1"></a>    xt <span class="ot">=</span> x[i<span class="dv">-1</span>]; y <span class="ot">=</span> <span class="fu">rg</span>(xt)</span>
<span id="cb35-19"><a href="#cb35-19" tabindex="-1"></a>    r <span class="ot">=</span> <span class="fu">df</span>(y)<span class="sc">*</span><span class="fu">dg</span>(xt, y)<span class="sc">/</span>(<span class="fu">df</span>(xt)<span class="sc">*</span><span class="fu">dg</span>(y, xt)) <span class="co"># 计算接受概率</span></span>
<span id="cb35-20"><a href="#cb35-20" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> r) {</span>
<span id="cb35-21"><a href="#cb35-21" tabindex="-1"></a>      <span class="co">#均匀随机数&lt;=接受概率时接受</span></span>
<span id="cb35-22"><a href="#cb35-22" tabindex="-1"></a>      x[i] <span class="ot">=</span> y } </span>
<span id="cb35-23"><a href="#cb35-23" tabindex="-1"></a>    <span class="cf">else</span> { </span>
<span id="cb35-24"><a href="#cb35-24" tabindex="-1"></a>      <span class="co"># 否则拒绝候选值，保留当前值</span></span>
<span id="cb35-25"><a href="#cb35-25" tabindex="-1"></a>      x[i] <span class="ot">=</span> xt ; k <span class="ot">=</span> k <span class="sc">+</span> <span class="dv">1</span> }</span>
<span id="cb35-26"><a href="#cb35-26" tabindex="-1"></a>  }</span>
<span id="cb35-27"><a href="#cb35-27" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">round</span>(k<span class="sc">/</span>N,<span class="dv">3</span>)); <span class="fu">return</span>(x) <span class="co"># 返回生成的随机变量序列</span></span>
<span id="cb35-28"><a href="#cb35-28" tabindex="-1"></a>}</span>
<span id="cb35-29"><a href="#cb35-29" tabindex="-1"></a><span class="do">## 执行M-H算法</span></span>
<span id="cb35-30"><a href="#cb35-30" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>); n <span class="ot">=</span> <span class="dv">20000</span>; k <span class="ot">=</span> <span class="dv">3</span> <span class="co"># 链数</span></span>
<span id="cb35-31"><a href="#cb35-31" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> k, <span class="at">ncol =</span> n)</span>
<span id="cb35-32"><a href="#cb35-32" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb35-33"><a href="#cb35-33" tabindex="-1"></a>  X[i, ] <span class="ot">=</span> <span class="fu">mh</span>(n, df, dg, rg)</span>
<span id="cb35-34"><a href="#cb35-34" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 0.222
## [1] 0.232
## [1] 0.233</code></pre>
<p><span class="math inline">\(\hspace{1.5em}\)</span>打印出的三条链的拒绝比例约为0.23，表明每条链中有23%的提议被拒绝，这表明提议分布与目标分布间有合理的平衡。</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="co">#绘制直方图</span></span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>x<span class="ot">=</span>X; <span class="fu">hist</span>(x, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">breaks =</span> <span class="dv">100</span>,<span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>)</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>plot.x <span class="ot">=</span> <span class="fu">seq</span>(<span class="fu">min</span>(x), <span class="fu">max</span>(x), <span class="fl">0.01</span>);<span class="fu">lines</span>(plot.x, <span class="fu">df</span>(plot.x),<span class="at">col=</span><span class="st">&quot;deeppink&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="co"># 绘制QQ图</span></span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>sample_quantiles <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, quantile, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>)))<span class="co"># 样本分位数</span></span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>theoretical_quantiles <span class="ot">=</span> <span class="fu">qcauchy</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="dv">1</span><span class="sc">/</span>n), <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)<span class="co">#理论分位数</span></span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a><span class="fu">qqplot</span>(theoretical_quantiles, sample_quantiles, <span class="at">main =</span> <span class="st">&quot;QQ plot&quot;</span>)</span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;deeppink&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>从<strong>直方图</strong>可以看出，样本分布与理论柯西分布形状基本一致，尽管存在些许偏差，整体符合度较高。<strong>QQ图</strong>上大部分点都分布在红线附近，说明样本分位数与理论分位数非常接近，然而，尾部的一些点稍微偏离红线，可能暗示样本分布的尾部与理论分布相比有些许差异。表明样本与理论分布之间很好的一致性，Metropolis-Hastings采样器可能有效地从目标分布中生成了样本。</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="do">## 计算潜在尺度缩减因子</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>Gelman.Rubin <span class="ot">=</span> <span class="cf">function</span>(phi) {</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>  phi <span class="ot">=</span> <span class="fu">as.matrix</span>(phi)</span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>  k <span class="ot">=</span> <span class="fu">nrow</span>(phi); n <span class="ot">=</span> <span class="fu">ncol</span>(phi)</span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>  phi.means <span class="ot">=</span> <span class="fu">rowMeans</span>(phi)</span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>  B <span class="ot">=</span> n <span class="sc">*</span> <span class="fu">var</span>(phi.means)</span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>  phi.w <span class="ot">=</span> <span class="fu">apply</span>(phi, <span class="dv">1</span>, var)</span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>  W <span class="ot">=</span> <span class="fu">mean</span>(phi.w)</span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a>  v.hat <span class="ot">=</span> W <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n <span class="sc">+</span> B <span class="sc">/</span> n</span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a>  r.hat <span class="ot">=</span> v.hat <span class="sc">/</span> W</span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a>}</span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a><span class="do">## 绘制累积均值(phi)图</span></span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a>b<span class="ot">=</span><span class="dv">1000</span>; phi <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb39-16"><a href="#cb39-16" tabindex="-1"></a>  phi[i,] <span class="ot">=</span> phi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(phi))</span>
<span id="cb39-17"><a href="#cb39-17" tabindex="-1"></a>}</span>
<span id="cb39-18"><a href="#cb39-18" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb39-19"><a href="#cb39-19" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb39-20"><a href="#cb39-20" tabindex="-1"></a>    <span class="fu">plot</span>((b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n, phi[i,(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">2</span>),</span>
<span id="cb39-21"><a href="#cb39-21" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&#39;Index&#39;</span>, <span class="at">ylab =</span> <span class="fu">bquote</span>(phi))</span>
<span id="cb39-22"><a href="#cb39-22" tabindex="-1"></a>  } <span class="cf">else</span> { <span class="fu">lines</span>((b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n, phi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">col =</span> i) }</span>
<span id="cb39-23"><a href="#cb39-23" tabindex="-1"></a>}</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>累积均值图展示了三条链的累积均值随迭代次数的变化情况。所有链的累积均值随迭代次数增加而趋于稳定，表明链可能已经收敛。初期的波动可能是由于链的burn-in
period，在这段时间里，链还未达到其长期行为。随着迭代次数的增加，累积均值趋于平稳，这表明链已经混合良好。</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="do">## 绘制潜在尺度缩减因子图</span></span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>rhat <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n) {</span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a>  rhat[j] <span class="ot">=</span> <span class="fu">Gelman.Rubin</span>(phi[, <span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a>}</span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R&quot;</span>,</span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">round</span>(<span class="fu">max</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n]),<span class="at">digits =</span> <span class="dv">0</span>)))</span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">1.2</span>, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAVFBMVEUAAAAAACsAAFUAKysAK4AAVaorAAArACsrAFUrKysrK4ArgNRVAABVqv+AKwCA1P+qVQCq///UgCvUgIDU1P/U////AAD/qlX/1ID//6r//9T///8AnEK+AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAFr0lEQVR4nO3db1faSBxAYeyqbVeLyNaC5Pt/z80/rAHCTWQmM4R7X2w5p9lf8DkToIbAorCzLVLfgdwTCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCAoMtLiaYgC9Pz+V/92U07+9BhiXtHhA6/u36tavy8clLRpQS1MzXTguadGAto810KZ7kI0/tFPnCoIiAVVr5KHYP1xfOC5pUYCK2ujupXwi6/ERaOJx8RIIEggSCEoNlD1UYqD8XzGmBSp5BIJxAsE4gWCcQDBOIBgnEIwTCMYJBOMEgnECwTiBYJxAMO6mgdpTP2fH3SRQc1ajqefk81+gzIXirKD2bMaQFZT7Eop0iL0/VycMj4FOnFm9TaCiWN29uILOtl48CXS27eM/Ap1tt1wIdPl+BYJxAsE4gWCcQDBOIBgnEIwTCMYJBOMEgnECwTiBYJxAME4gGCcQjJsv0H99F8uNGzc3oHV7Jme37L2acNx+Zwa0uXspVvdv1fWWfdepjNzvvIB2y4f6Ost1dS0PVSL2bjVXoPr6r93yZ30x2JlW5QLb/vs25JrVuQFVP/CKDq/qIFzVq4evOJwlUM9Pva/eavu9AuJrVmcJBAdYcyHm7ndxsysIgIr1ft0MuGb1JoGKdfP0tek9czhfIHznz9j9zgsown4zfwdVeqDMl5BAkECQQJBAkECQQJBAkECQQJBAUGZA+X2WR1ZAFU9uQjkBNTYCHY7b32zXTmZLKB+gDxiBDsa1R9bixF9lUCSgdfl423wSJ12Sub+d668Y4wBVv7N/f65+tT8UaHHqUTuHogDtlvV5seX921CgzqrJaglFAdqfkV/dv60HfBrw0Yuf2QM1K6ioTqANWkGHSyanJRTpMahleX/G6+ZPzp49UPks1hxkve9DOz8uoyWUweugk3+djVCmQPkI5QqUjVC2QLkI5QuUiVDGQHn8ejFnoCwWUd5AGSyizIHSE2UPlJroCoDSPhRdBVCR8NuSrgOoSGd0NUBF+9u2sHdjwE6Dbxh33ORfT3ZtQPv//Qvf0vjFPQXfcFh/qkL9WSp1/gw6f+hPlNcK6p/7xS8B7R8YfMMk43p3c7HVzIE+73EY1eFmkc6LDf804AQdHoZnD8o4K6j/ZMZEzz3hinSI1ZePhxuXsFiPQf3XGn5pXLpu50H6iwkEJQO6mhIBjR0a/n6G/oEEmnjeyKEChdpSoMk3TDRv5FCBQm0p0OQbJpo3cuiNAs0pgSCBIIEggSCBIIEggSCBIIEggSCBIIGg8EDnPrC8efvDw+etjm+MaPvjNcLUTsGBqk/H3/Tdp+bDqD9vdXxjRO/P9ZspAk/tFhqouTK673OF95/T/bHV8Y0Rbdp34YSdelBooOZbfPuuGl8/HGx1fGP4rjaLp4Ym6NTDggOd+kT3j1Y/F/X3UnxsdXxj1N6a7UNP7RQaqDngew775svGV09/tzq+MW5v1Y8efGqnSYHaTb69BgUKPrXTtIdYs8njr7CHWOipnaZ9kG42+f4S6uH0M1C4qZ0mfZpv7m/5U4V6Qq6Bgk/tNO0Lxfqulg+noV7Stc9igad2Cv9PjfW5F/erxf4zvvZbHd8YUXuIBZ7ayX+sQgJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkH/A2Bplatw3wsUAAAAAElFTkSuQmCC" /><!-- --></p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>显示了潜在尺度缩减因子（Rhat）随迭代次数的变化，Rhat值是Gelman-Rubin统计量，比较了不同链的方差与链内方差。由图可以看出，初期Rhat值迅速下降，表明链在初期快速混合，但未达到平稳分布。在大约1000次迭代后低于1.2，这表明链混合良好。Rhat值的下降和稳定趋势表明随着迭代次数的增加，链逐渐收敛到其长期分布，即目标分布。</p>
<hr />
</div>
</div>
<div id="二习题9.8" class="section level2">
<h2><strong><em>二、习题9.8</em></strong></h2>
<p><span class="math inline">\(\hspace{1.5em}\)</span>使用Gibbs抽样方法生成一个二元随机样本序列，并使用Gelman-Rubin方法检验样本序列的收敛性。。给定的联合密度函数为
<span class="math inline">\(f(x, y) = \frac{n}{x}yx+a-1(1 -
y)^{n-x+b-1}\)</span>)，其中 <span class="math inline">\(x = 0, 1,
\ldots; y \leq 0 \leq 1\)</span>。对于固定的参数 <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, <span class="math inline">\(n\)</span>)，条件分布分别是二项式分布（Binomial(n,
y)）和Beta分布（Beta(x + a, n - x + b)）。</p>
<div id="算法思路-1" class="section level4">
<h4>算法思路：</h4>
<ol style="list-style-type: decimal">
<li><p>定义目标联合密度函数 <span class="math inline">\(f(x,
y)\)</span>。</p></li>
<li><p>使用Gibbs抽样循环生成样本序列，循环中从条件分布中抽样更新样本值。</p></li>
<li><p>绘制样本序列的散点图以可视化样本分布；计算样本序列的累积均值并绘制累积均值图。</p></li>
<li><p>使用Gelman-Rubin方法检验样本序列的收敛性，Rhat值接近1.2通常表示样本序列收敛。</p></li>
</ol>
</div>
<div id="代码实现与结果分析-1" class="section level3">
<h3>代码实现与结果分析：</h3>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a><span class="co"># 定义目标联合密度函数</span></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">1000</span>;a <span class="ot">=</span> <span class="dv">30</span>;b <span class="ot">=</span> <span class="dv">60</span></span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>df <span class="ot">=</span> <span class="cf">function</span> (x, y) {</span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>  <span class="fu">gamma</span>(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(<span class="fu">gamma</span>(x<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">gamma</span>(n<span class="sc">-</span>x<span class="sc">+</span><span class="dv">1</span>))<span class="sc">*</span>y<span class="sc">^</span>(x<span class="sc">+</span>a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y)<span class="sc">^</span>(n<span class="sc">-</span>x<span class="sc">+</span>b<span class="dv">-1</span>)}</span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">20000</span> ;burnin <span class="ot">=</span> <span class="dv">1000</span>;<span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a><span class="do">## Gibbs抽样循环</span></span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> m, <span class="dv">2</span>)</span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a>  xt <span class="ot">=</span> x[i<span class="dv">-1</span>,]  <span class="co"># 获取当前迭代的样本值</span></span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a>  xt[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, xt[<span class="dv">2</span>])  <span class="co"># 从条件分布Binomial(n, y)中抽样</span></span>
<span id="cb41-12"><a href="#cb41-12" tabindex="-1"></a>  xt[<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, xt[<span class="dv">1</span>] <span class="sc">+</span> a, n <span class="sc">-</span> xt[<span class="dv">1</span>] <span class="sc">+</span> b)  <span class="co"># 从条件分布Beta(x + a, n - x + b)中抽样</span></span>
<span id="cb41-13"><a href="#cb41-13" tabindex="-1"></a>  x[i,] <span class="ot">=</span> xt  <span class="co"># 更新样本值</span></span>
<span id="cb41-14"><a href="#cb41-14" tabindex="-1"></a>}</span>
<span id="cb41-15"><a href="#cb41-15" tabindex="-1"></a><span class="fu">plot</span>(x[,<span class="dv">1</span>], x[,<span class="dv">2</span>], <span class="at">xlab =</span> <span class="fu">bquote</span>(X[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">bquote</span>(X[<span class="dv">2</span>]),</span>
<span id="cb41-16"><a href="#cb41-16" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">ylim =</span> <span class="fu">range</span>(x[,<span class="dv">2</span>]))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>散点图显示了二元随机样本序列的分布情况,图中点的分布围绕某个区域密集分布，这表明样本序列可能很好地从目标分布中抽样。</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="do">## 绘制累积均值(phi)图</span></span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a>phi <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">t</span>(<span class="fu">apply</span>(x, <span class="dv">1</span>, cumsum)))</span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(phi)) {</span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a>  phi[i,] <span class="ot">=</span> phi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(phi))}</span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a><span class="fu">plot</span>((burnin<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m, phi[i, (burnin<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m],</span>
<span id="cb42-6"><a href="#cb42-6" tabindex="-1"></a>      <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&#39;Index&#39;</span>, <span class="at">ylab =</span> <span class="fu">bquote</span>(phi))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="co"># 计算潜在尺度缩减因子</span></span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>Gelman.Rubin <span class="ot">=</span> <span class="cf">function</span>(phi) {</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>  phi <span class="ot">=</span> <span class="fu">as.matrix</span>(phi);  k <span class="ot">=</span> <span class="fu">nrow</span>(phi); n <span class="ot">=</span> <span class="fu">ncol</span>(phi)</span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>  phi.means <span class="ot">=</span> <span class="fu">rowMeans</span>(phi); B <span class="ot">=</span> n <span class="sc">*</span> <span class="fu">var</span>(phi.means);</span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>  phi.w <span class="ot">=</span> <span class="fu">apply</span>(phi, <span class="dv">1</span>, var);  W <span class="ot">=</span> <span class="fu">mean</span>(phi.w)</span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a>  v.hat <span class="ot">=</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n<span class="sc">+</span>B<span class="sc">/</span>n; r.hat <span class="ot">=</span> v.hat <span class="sc">/</span> W</span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a>}</span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a><span class="do">## 绘制潜在尺度缩减因子图</span></span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a>rhat <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb43-11"><a href="#cb43-11" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n) {</span>
<span id="cb43-12"><a href="#cb43-12" tabindex="-1"></a>  rhat[j] <span class="ot">=</span> <span class="fu">Gelman.Rubin</span>(phi[, <span class="dv">1</span><span class="sc">:</span>j])}</span>
<span id="cb43-13"><a href="#cb43-13" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R&quot;</span>)</span>
<span id="cb43-14"><a href="#cb43-14" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">1.2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAASFBMVEUAAAAAACsAAFUAK4AAVaorAAArACsrKysrgNRVAABVqv+AKwCA1P+qVQCq/6qq///UgCvUgIDU////qlX/1ID//6r//9T///95UfByAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGJklEQVR4nO3dbXvSSBhAYapV67asrFT4//908wLUasKZTGbIQ3POB6+9dDpp7w3JACHdHO1qm6W/gegJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBBUG2txNSwGVna5eAkECQQIN9nb0EQgOzesDmniaWgdQ1nn79KXFBy4y3eAmck3ez1J84CLTvZu6AMtvsxUfuMh03ZQlXd5mLT5wgemqyJznLj6w6df3p+bPffM9f/pRYLor1aQ5baH4wOMJaPf5Z/tf/8yfbuw7qkxz2krxgcce6ETTMc2cbujLb4LTban4wGMP9PqlA9qPPMhm/HQ3s+m3VnzgseoedFudYzWg9ud4PJ4P1zOne/uiG+N02yw+sK8xenhpTmQjPhlAS+gc72YddPNH1tuWiw+sMN1iOsdqQIfnfgU3sgqaNN2SPLWAXr++NCew5gy/HVtKp293UZ5KQIfn7ti8bf7cPs6bbmGeaqf5yxpo3kJxcZ7Ke9Bj/zjLnW7pR1f/TRQf2LZr1kDdgejX9/yHWASeamex9qWOhys+CdPF8Im7DgriExUoCk/UhWIcn1svFNPeiQnkE3KhGMkn4kIxlE/EhWIon4ALxVg+8RaKsR5g8dZB0XziAZXdzPxqA008SIfzCbYHhXuAhQMqu5EShQIKuAPVfrI67fKXgD61Fornd1RH31odmi7iDlT1qUbblIsXIvpUfbLaNuHJakifSHvQioCaY9BpF5pwDAp5BKp2FuuvENpsRvafQaBJG7hZM4D+GzuFZ00XdAeaDrQ7LW4Oz6NrnKztBvWZDLR/eDlu25dSN6MXj+Vt94MAHZ4fu7P4rn05rOR2oz7CpgJ1F2Uenr9txl4pzN1uVJ/pQO35ezvv4TW03Q8GNHr2zt1uWJ9MoLkPMIGmbleg69sNew7LAHq7/KDgQjGuT5CXXAWC6QS6Pl1gH4GoGwMNX2EmEEwn0PXpIvsIRAkECQQFAArtIxAlECQQJBC0PFDgF8vaAgCVnbh0AkFVgCbdomu1QKm36ForUPINltYKlHqLruA+y+9BKwVKv0XXKoGOE27RtVag5OkEgulWCrRtDkHdB1rGbr2wcqD23LXdPCYcpKP71AHqPoqw7y7zpNP8OoG6NVC/RKSF4jqB3IOoyzHot8/9DE+3UqD0s9hagZKnEwimWytQ6i26wvtUAkq+RddKgdJv0bVSoPRbdK0UKP0WXSsFSr9F11qBkm/RtVqg1OkEgukE8iA9a7vxfZZ+iMVPIKjyk9Xav6GufpUWilm36ApZzacabaOvSd9NNYASbtGVOimOmD+g0N5ceA9KnfRjAiXcoit10g8KxLfoSp30owIVm1SguSMEqj5AoPkjUhLoJrN84ASCBIIEggSCBIIEggSCBIIEggSCBIIEgsoD7TfDtzXv3nR8ejdibOhYr1/6T4TmzzC94kDtZzn2A9/04bn5y137811GjA0dnfrzz/7arewZMioN1L81NHARbP958t2nH5cRo0OvTj1nhpxKA10chv+5+d99GQFD/57668sf25g6Q07FgbqfYvSN123zU51HwNC/2n/693t3FMueIafSQP0RYey40L7heBlxfejf7dqLStpfcJE9Q043Bdqfj9F5QA+n/eWuga7t9f0b1tkPkP5Y0xx37vohduW4ebq6KPsQ20M0KHd9kB4/856vfMg+SfdX3+zv/DQ/unZ7/fL054ipy7z2mpvLB4vvdaHY/SKuoW95118X0v7TZcTI0NH25ycr2TNMzyerkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQND/ODabLrylV+sAAAAASUVORK5CYII=" /><!-- --></p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>累积均值图显示累积均值在初期有较大的波动，然后随着迭代次数增加逐渐趋于稳定；潜在尺度缩减因子图中，Rhat值在初期迅速上升并趋于稳定，且一直保持在1.2以下，这表明链可能已经收敛。</p>
<hr />
</div>
</div>
<div id="三证明题" class="section level2">
<h2><strong><em>三、证明题</em></strong></h2>
<p><span class="math inline">\(\hspace{1.5em}\)</span>为证明给定MCMC的平稳性，需验证<span class="math inline">\(K(s,r)f(s)=K(r,s)f(r)\)</span>,即如果从状态<span class="math inline">\(s\)</span>开始，经过转移核<span class="math inline">\(K\)</span>后，得到的分布和从状态<span class="math inline">\(r\)</span>开始，经过转移核<span class="math inline">\(K\)</span>后得到的分布相同，那么这个分布<span class="math inline">\(f\)</span>就是平稳分布。</p>
<div id="转移核的定义" class="section level3">
<h3>转移核的定义：</h3>
<p><span class="math display">\[
K(r, s) = 1(s \neq r) \alpha(r, s) g(s \mid r) + 1(s = r) \left[1 - \int
\alpha(r, s) g(s \mid r) ds\right]
\]</span></p>
<p>详细平衡条件要求对于所有的 <span class="math inline">\(s\)</span>和
<span class="math inline">\(r\)</span>，<span class="math inline">\(K(s,
r) f(s) = K(r, s) f(r)\)</span>必须成立.</p>
</div>
<div id="证明" class="section level3">
<h3>证明：</h3>
<ol style="list-style-type: decimal">
<li>当 <span class="math inline">\(s \neq r\)</span>时：</li>
</ol>
<p><span class="math inline">\(\hspace{1.5em}\)</span>此时，转移核的表达式为：
<span class="math display">\[
   K(s, r) = \alpha(s, r) g(r \mid s)
   \]</span> <span class="math display">\[
   K(r, s) = \alpha(r, s) g(s \mid r)
    \]</span> 其中接受概率的定义为： <span class="math display">\[
   \alpha(s, r) = \min\left\{\frac{f(r) g(s \mid r)}{f(s) g(r \mid s)},
1\right\}
    \]</span> <span class="math display">\[
   \alpha(r, s) = \min\left\{\frac{f(s) g(r \mid s)}{f(r) g(s \mid r)},
1\right\}
    \]</span></p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>下证<span class="math inline">\(\alpha(s, r) g(r \mid s) f(s) = \alpha(r, s) g(s
\mid r) f(r)\)</span>.从左侧出发有：</p>
<p><span class="math display">\[
   \alpha(s, r) g(r \mid s) f(s) = \min\left\{1, \frac{f(r) g(s \mid
r)}{f(s) g(r \mid s)}\right\} g(r \mid s) f(s)
   \]</span> <span class="math display">\[
   = \frac{f(r) g(s \mid r)}{f(s) g(r \mid s)} g(r \mid s) f(s) \quad
\text{(当 }\frac{f(r) g(s \mid r)}{f(s) g(r \mid s)} &lt; 1\text{)}=
f(r) g(s \mid r)
   \]</span> 当 <span class="math inline">\(\frac{f(r) g(s \mid r)}{f(s)
g(r \mid s)} \geq 1\)</span> 时，左侧为<span class="math inline">\(g(r
\mid s) f(s)\)</span></p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>右侧： <span class="math display">\[
   \alpha(r, s) g(s \mid r) f(r) = \min\left\{1, \frac{f(s) g(r \mid
s)}{f(r) g(s \mid r)}\right\} g(s \mid r) f(r)
  \]</span> <span class="math display">\[
   = \frac{f(s) g(r \mid s)}{f(r) g(s \mid r)} g(s \mid r) f(r) \quad
\text{(当 }\frac{f(s) g(r \mid s)}{f(r) g(s \mid r)} &lt; 1\text{)}   =
f(s) g(r \mid s)
   \]</span></p>
<p>当 <span class="math inline">\(\frac{f(s) g(r \mid s)}{f(r) g(s \mid
r)} \geq 1\)</span> 时，右侧为：<span class="math inline">\(g(s \mid r)
f(r)\)</span>,左侧和右侧的相等关系成立。</p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>代入详细平衡条件，得到：</p>
<p><span class="math display">\[
   \alpha(s, r) g(r \mid s) f(s) = \alpha(r, s) g(s \mid r) f(r)
   \]</span> 故<span class="math inline">\(K(s, r) f(s) = \alpha(s, r)
g(r \mid s) f(s) = \alpha(r, s) g(s \mid r) f(r) = K(r, s)
f(r)\)</span>成立。</p>
<ol start="2" style="list-style-type: decimal">
<li><p><strong>当 <span class="math inline">\(s = r\)</span>
时</strong>：</p>
<p>此时，转移核为：</p>
<p><span class="math display">\[
K(s, s) = 1 - \int \alpha(s, s) g(s \mid s) ds
\]</span></p>
<p>由于 <span class="math inline">\(s = r\)</span>，我们可以写出：</p>
<p><span class="math display">\[
K(s, s) f(s) = \left[1 - \int \alpha(s, s) g(s \mid s) ds\right] f(s)
\]</span> <span class="math display">\[
K(r, r) f(r) = \left[1 - \int \alpha(r, r) g(r \mid r) dr\right] f(r)
\]</span></p>
<p>由于 <span class="math inline">\(s = r\)</span>，所以 <span class="math inline">\(K(s, s) = K(r, r)\)</span> 且 <span class="math inline">\(f(s) = f(r)\)</span>，这意味着：</p></li>
</ol>
<p><span class="math display">\[
   K(s, s) f(s) = K(r, r) f(r)
\]</span></p>
<p>即对于所有可能的 <span class="math inline">\(s\)</span> 和 <span class="math inline">\(r\)</span>（无论是 <span class="math inline">\(s
\neq r\)</span> 还是 <span class="math inline">\(s = r\)</span>），都有
<span class="math inline">\(K(s, r) f(s) = K(r, s)
f(r)\)</span>。这证明了目标分布 <span class="math inline">\(f\)</span>
是给定 MCMC 算法的平稳分布。</p>
<hr />
<p>#作业2024-11-04</p>
</div>
</div>
<div id="一习题11.3" class="section level2">
<h2><strong><em>一、习题11.3</em></strong></h2>
<div id="问题重述" class="section level3">
<h3>问题重述</h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>要求完成以下任务：</p>
<ol style="list-style-type: lower-alpha">
<li>编写一个函数来计算给定数学表达式中的第<span class="math inline">\(k\)</span>项，表达式为：</li>
</ol>
<p><span class="math display">\[
\sum_{k=0}^{\infty}\frac{(-1)^k}{k! 2^k}\frac{\|a\|^{2 k+2}}{(2 k+1)(2
k+2)}\frac{\Gamma\left(\frac{d+1}{2}\right)\Gamma\left(k+\frac{3}{2}\right)}{\Gamma\left(k+\frac{d}{2}+1\right)},
\]</span></p>
<p>其中<span class="math inline">\(d\geq1\)</span>是一个整数，<span class="math inline">\(a\)</span>是<span class="math inline">\(\mathbb{R}^d\)</span>中的一个向量<span class="math inline">\(\|\cdot\|\)</span>表示欧几里得范数。要求进行适当的算术运算，以便可以计算出任意大的<span class="math inline">\(k\)</span>和<span class="math inline">\(d\)</span>的系数。</p>
<ol start="2" style="list-style-type: lower-alpha">
<li><p>修改函数，使其计算并返回总和。</p></li>
<li><p>当<span class="math inline">\(a = (1,
2)^T\)</span>时，计算。</p></li>
</ol>
</div>
<div id="问题分析" class="section level3">
<h3>问题分析</h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>本题要求我们计算一个无穷级数的和，涉及到一些函数如伽玛函数、指数运算，当涉及到大数或小数时，在计算机上直接计算这些表达式可能会遇到数值稳定性问题。常采用<strong>取对数</strong>的方式解决，将乘法和除法转换为加法和减法，从而避免数值溢出或下溢。即：</p>
<p><span class="math display">\[
e^{(-1)^k[(2k+2)\ln(\|a\|)+\ln(\Gamma(\frac{d+1}{2}))+\ln(\Gamma(k+\frac{3}{2}))-\ln(k!)-k\ln(2)
-\ln((2k+1)(2k+2))-\ln(\Gamma(k+\frac{d}{2}+1))]}
\]</span></p>
</div>
<div id="代码实现-6" class="section level3">
<h3>代码实现</h3>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a><span class="do">## (a) 编写计算第k项的函数</span></span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>calcu_kterm <span class="ot">=</span> <span class="cf">function</span>(a, k, d) {</span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>  <span class="co">#对原式取对数--这里有一个log(k!)在0的位置需要定义一下</span></span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a>  <span class="cf">if</span> (k<span class="sc">==</span><span class="dv">0</span>) log_factorial<span class="ot">=</span><span class="dv">0</span> <span class="cf">else</span> log_factorial<span class="ot">=</span><span class="fu">sum</span>(<span class="fu">log</span>(<span class="dv">1</span><span class="sc">:</span>k))</span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a>  log_term <span class="ot">=</span> <span class="dv">0</span><span class="sc">+</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>))<span class="sc">+</span><span class="fu">log</span>(<span class="fu">gamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>))<span class="sc">+</span><span class="fu">log</span>(<span class="fu">gamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>))<span class="sc">-</span></span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a>      log_factorial<span class="sc">-</span>k<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>)<span class="sc">-</span><span class="fu">log</span>((<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>))<span class="sc">-</span><span class="fu">log</span>(<span class="fu">gamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a>  term <span class="ot">=</span> ((<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k)<span class="sc">*</span><span class="fu">exp</span>(log_term) <span class="co"># 还原</span></span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a>  <span class="fu">return</span>(term)</span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a>}</span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a><span class="do">## (b) 计算并返回总和</span></span>
<span id="cb44-12"><a href="#cb44-12" tabindex="-1"></a><span class="co"># 最大计算次数为max_iter 当计算小于1e-10时停止计算</span></span>
<span id="cb44-13"><a href="#cb44-13" tabindex="-1"></a>getSum <span class="ot">=</span> <span class="cf">function</span>(a,d,<span class="at">max_iter=</span><span class="dv">1000</span>,<span class="at">tol=</span><span class="fl">1e-10</span>){ </span>
<span id="cb44-14"><a href="#cb44-14" tabindex="-1"></a>  sum_value <span class="ot">=</span> <span class="dv">0</span>; Final <span class="ot">=</span> <span class="fu">calcu_kterm</span>(a, <span class="dv">0</span>, d)</span>
<span id="cb44-15"><a href="#cb44-15" tabindex="-1"></a>  exp_sum_value <span class="ot">=</span> Final</span>
<span id="cb44-16"><a href="#cb44-16" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb44-17"><a href="#cb44-17" tabindex="-1"></a>    current_term <span class="ot">=</span> <span class="fu">calcu_kterm</span>(a, k, d)</span>
<span id="cb44-18"><a href="#cb44-18" tabindex="-1"></a>    sum_value <span class="ot">=</span> sum_value <span class="sc">+</span> current_term</span>
<span id="cb44-19"><a href="#cb44-19" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(current_term) <span class="sc">&lt;</span> tol){</span>
<span id="cb44-20"><a href="#cb44-20" tabindex="-1"></a>      <span class="cf">break</span>}</span>
<span id="cb44-21"><a href="#cb44-21" tabindex="-1"></a>  }</span>
<span id="cb44-22"><a href="#cb44-22" tabindex="-1"></a>  <span class="fu">return</span>(sum_value)</span>
<span id="cb44-23"><a href="#cb44-23" tabindex="-1"></a>}</span>
<span id="cb44-24"><a href="#cb44-24" tabindex="-1"></a><span class="do">## (c) Evaluate the sum</span></span>
<span id="cb44-25"><a href="#cb44-25" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>) ; d <span class="ot">=</span> <span class="fu">length</span>(a)</span>
<span id="cb44-26"><a href="#cb44-26" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">getSum</span>(a, d)</span>
<span id="cb44-27"><a href="#cb44-27" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;计算结果约为:&quot;</span>,result)</span></code></pre></div>
<pre><code>## 计算结果约为: -4.995031</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a>absolute_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">40</span>, calcu_kterm, <span class="at">a =</span> a, <span class="at">d =</span> d)</span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>, <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>, calcu_kterm, <span class="at">a =</span> a, <span class="at">d =</span> d), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;级数项随k的变化&quot;</span>,<span class="at">xlab =</span> <span class="st">&quot;k&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>, <span class="at">col =</span> <span class="st">&quot;deeppink&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>由图可以验证，随着k增大，级数不断收敛。</p>
<hr />
</div>
</div>
<div id="二习题11.5" class="section level2">
<h2><strong><em>二、习题11.5</em></strong></h2>
<div id="问题重述-1" class="section level3">
<h3>问题重述</h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>求解方程：</p>
<p><span class="math display">\[
\frac{2\Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)}\Gamma\left(\frac{k-1}{2}\right)}\int_{0}^{c_{k-1}}\left(1+\frac{u^{2}}{k-1}\right)^{-k/2}
du = \frac{2\Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi
k}\Gamma\left(\frac{k}{2}\right)}\int_{0}^{c_{k}}\left(1+\frac{u^{2}}{k}\right)^{-(k+1)/2}
du
\]</span></p>
<p>其中，<span class="math inline">\(c_k\)</span>定义为：</p>
<p><span class="math display">\[
c_k = \sqrt{\frac{a^2 k}{k+1-a^2}}
\]</span></p>
</div>
<div id="问题分析-1" class="section level3">
<h3>问题分析</h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>方程的左侧和右侧都是关于k的函数，包含积分和伽玛函数。</p>
<ul>
<li><p>由于积分没有解析解，我们需要使用<strong>数值积分</strong>方法来近似计算积分的值，可以借助<strong>integrate函数</strong>使用自适应方法估计。</p></li>
<li><p>进一步地，需要找到一个a,使得方程两侧的值相等,转换为方程的<strong>求根问题</strong>，采用<strong>Brent算法</strong>求解。</p></li>
</ul>
</div>
<div id="代码实现-7" class="section level3">
<h3>代码实现</h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>solve.equation <span class="ot">=</span> <span class="cf">function</span>(k) {</span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a>  <span class="co"># 定义方程的左右两边</span></span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a>  term <span class="ot">=</span> <span class="cf">function</span>(n, a) {</span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a>    integral <span class="ot">=</span> <span class="cf">function</span>(u) (<span class="dv">1</span><span class="sc">+</span>u<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(n<span class="dv">-1</span>))<span class="sc">^</span>(<span class="sc">-</span>n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a>    ck <span class="ot">=</span> <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>n<span class="sc">/</span>(n<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)) </span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a>    p <span class="ot">=</span> <span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(pi<span class="sc">*</span>(n<span class="dv">-1</span>))<span class="sc">*</span><span class="fu">exp</span>(<span class="fu">lgamma</span>(n<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>((n<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a>    <span class="fu">return</span>(p<span class="sc">*</span><span class="fu">integrate</span>(integral, <span class="dv">0</span>, ck)<span class="sc">$</span>value)  <span class="co"># 计算积分并返回</span></span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a>  }</span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a>  f <span class="ot">=</span> <span class="cf">function</span>(a){</span>
<span id="cb47-11"><a href="#cb47-11" tabindex="-1"></a>    <span class="fu">term</span>(k, a)<span class="sc">-</span><span class="fu">term</span>(k<span class="sc">+</span><span class="dv">1</span>, a)}</span>
<span id="cb47-12"><a href="#cb47-12" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">f</span>(<span class="fl">1.5</span>)<span class="sc">*</span><span class="fu">f</span>(<span class="dv">2</span>) <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb47-13"><a href="#cb47-13" tabindex="-1"></a>    r <span class="ot">=</span> <span class="fu">uniroot</span>(f, <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">2</span>))<span class="sc">$</span>root  <span class="co"># 求解方程</span></span>
<span id="cb47-14"><a href="#cb47-14" tabindex="-1"></a>  } <span class="cf">else</span> r <span class="ot">=</span> <span class="cn">NA</span> <span class="co">#出现NA则通过绘制k对应图像调整区间</span></span>
<span id="cb47-15"><a href="#cb47-15" tabindex="-1"></a>  <span class="fu">return</span>(r)</span>
<span id="cb47-16"><a href="#cb47-16" tabindex="-1"></a>}</span>
<span id="cb47-17"><a href="#cb47-17" tabindex="-1"></a><span class="co"># 不同的k值求解</span></span>
<span id="cb47-18"><a href="#cb47-18" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits=</span><span class="dv">4</span>)</span>
<span id="cb47-19"><a href="#cb47-19" tabindex="-1"></a>rs <span class="ot">=</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>), solve.equation)</span>
<span id="cb47-20"><a href="#cb47-20" tabindex="-1"></a><span class="fu">print</span>(rs)</span></code></pre></div>
<pre><code>##  [1] 1.811 1.827 1.830 1.829 1.825 1.821 1.816 1.811 1.807 1.803 1.799 1.796
## [13] 1.793 1.790 1.787 1.785 1.783 1.781 1.779 1.777 1.775 1.774 1.743 1.734
## [25] 1.733</code></pre>
<hr />
</div>
</div>
<div id="三" class="section level2">
<h2><strong><em>三</em></strong></h2>
<div id="问题重述-2" class="section level3">
<h3>问题重述</h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>假设 <span class="math inline">\(T_1,\ldots,T_n\)</span>是从期望为<span class="math inline">\(\lambda\)</span>的指数分布中独立同分抽取的样本。由于右删失，大于<span class="math inline">\(\tau\)</span>的值不会被观察到，因此观察到的值是<span class="math inline">\(Y_i=T_iI(T_i\leq\tau)+\tau
I(T_i&gt;\tau)\)</span>,<span class="math inline">\(i=1,\ldots,n\)</span>。假设 <span class="math inline">\(\tau=1\)</span>，并且观察到的<span class="math inline">\(Y_i\)</span>值如下：</p>
<p><span class="math inline">\(0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91,
1.00, 0.21, 0.85\)</span></p>
<p>使用E-M估计 <span class="math inline">\(\lambda\)</span>，并与观察数据的最大似然估计（MLE）结果进行比较。</p>
</div>
<div id="问题分析-2" class="section level3">
<h3>问题分析</h3>
<div id="步骤-1-定义混合分布" class="section level5">
<h5>步骤 1: 定义混合分布</h5>
<p>混合分布由两部分组成：</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(T_i \leq \tau\)</span> 时，<span class="math inline">\(Y_i = T_i\)</span>，其概率密度函数为 <span class="math inline">\(\lambda e^{-\lambda T_i}\)</span>。</p></li>
<li><p><span class="math inline">\(T_i &gt; \tau\)</span> 时，<span class="math inline">\(Y_i = \tau\)</span>。</p></li>
</ol>
</div>
<div id="步骤-2-e-m-算法" class="section level5">
<h5>步骤 2: E-M 算法</h5>
<ul>
<li><p>E-step：计算每个观测值<span class="math inline">\(Y_i\)</span>来自指数分布的部分的期望值，即<span class="math inline">\(Z_i = P(T_i \leq \tau | Y_i,
\lambda)\)</span>。</p></li>
<li><p>M-step：更新<span class="math inline">\(\lambda\)</span>的估计值，使得对数似然函数最大化。</p></li>
</ul>
</div>
</div>
<div id="代码实现-8" class="section level3">
<h3>代码实现</h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>根据公式 <span class="math inline">\(E[X | X &gt; \theta] = \frac{1}{\lambda} +
\theta\)</span>，根据当前的<span class="math inline">\(\lambda\)</span>和<span class="math inline">\(\theta\)</span>计算调整后的条件期望值。</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>Y<span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a>tau<span class="ot">=</span><span class="fl">1.0</span>  <span class="co"># 删失阈值</span></span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a><span class="co"># EM算法</span></span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>EM<span class="ot">=</span><span class="cf">function</span>(Y, tau, <span class="at">max_iter=</span><span class="dv">100</span>,<span class="at">tol=</span><span class="fl">1e-6</span>) {</span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a>  n<span class="ot">=</span><span class="fu">length</span>(Y); lamb<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb49-8"><a href="#cb49-8" tabindex="-1"></a>    expect<span class="ot">=</span><span class="fu">ifelse</span>(Y<span class="sc">&lt;</span>tau, Y, tau<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>lamb)  <span class="co"># E步</span></span>
<span id="cb49-9"><a href="#cb49-9" tabindex="-1"></a>    new_lamb<span class="ot">=</span><span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(expect)  <span class="co"># M步</span></span>
<span id="cb49-10"><a href="#cb49-10" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(new_lamb<span class="sc">-</span>lamb)<span class="sc">&lt;</span>tol) {<span class="co"># 收敛判定</span></span>
<span id="cb49-11"><a href="#cb49-11" tabindex="-1"></a>      <span class="cf">break</span>}</span>
<span id="cb49-12"><a href="#cb49-12" tabindex="-1"></a>    lamb<span class="ot">=</span>new_lamb</span>
<span id="cb49-13"><a href="#cb49-13" tabindex="-1"></a>  }</span>
<span id="cb49-14"><a href="#cb49-14" tabindex="-1"></a>  <span class="fu">return</span>(lamb)</span>
<span id="cb49-15"><a href="#cb49-15" tabindex="-1"></a>}</span>
<span id="cb49-16"><a href="#cb49-16" tabindex="-1"></a><span class="co"># 调用EM算法</span></span>
<span id="cb49-17"><a href="#cb49-17" tabindex="-1"></a>lambda_EM<span class="ot">=</span><span class="fu">EM</span>(Y, tau)</span>
<span id="cb49-18"><a href="#cb49-18" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;EM算法估计的lambda：&quot;</span>, lambda_EM, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## EM算法估计的lambda： 1.037</code></pre>
<p><span class="math inline">\(\hspace{1.5em}\)</span>最大似然估计（MLE）可以通过直接最大化似然函数来实现。对于截断数据，似然函数可以写为：
<span class="math display">\[
L(\lambda) = \prod_{i=1}^n \left( \lambda e^{-\lambda Y_i} \right)^{Z_i}
\left( e^{-\lambda \tau} \right)^{1-Z_i}
\]</span></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="co"># 负对数似然函数</span></span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>neg_log_likelihood <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda, Y, tau) {</span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>  <span class="co"># 对应删失和非删失数据的似然项</span></span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>  term1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">log</span>(lambda) <span class="sc">-</span> lambda <span class="sc">*</span> Y[Y <span class="sc">&lt;</span> tau])  <span class="co"># 未删失数据</span></span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a>  term2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> tau)) <span class="sc">*</span> (Y <span class="sc">&gt;=</span> tau))  <span class="co"># 删失数据</span></span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a>  <span class="fu">return</span>(<span class="sc">-</span>(term1 <span class="sc">+</span> term2))</span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a>}</span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a><span class="co"># MLE估计</span></span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a>MLE_lambda <span class="ot">&lt;-</span> <span class="cf">function</span>(Y, tau) {</span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a>  <span class="co"># 最小化负对数似然</span></span>
<span id="cb51-11"><a href="#cb51-11" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">optimize</span>(neg_log_likelihood, <span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">0.0001</span>, <span class="dv">10</span>), <span class="at">Y =</span> Y, <span class="at">tau =</span> tau)</span>
<span id="cb51-12"><a href="#cb51-12" tabindex="-1"></a>  <span class="fu">return</span>(result<span class="sc">$</span>minimum)</span>
<span id="cb51-13"><a href="#cb51-13" tabindex="-1"></a>}</span>
<span id="cb51-14"><a href="#cb51-14" tabindex="-1"></a><span class="co"># 运行MLE估计</span></span>
<span id="cb51-15"><a href="#cb51-15" tabindex="-1"></a>lambda_MLE <span class="ot">&lt;-</span> <span class="fu">MLE_lambda</span>(Y, tau)</span>
<span id="cb51-16"><a href="#cb51-16" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;最大似然估计的lambda：&quot;</span>, lambda_MLE, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 最大似然估计的lambda： 2.101</code></pre>
<hr />
</div>
</div>
</div>
<div id="作业2024-11-11" class="section level1">
<h1>作业2024-11-11</h1>
<div id="一习题11.7" class="section level2">
<h2><strong><em>一、习题11.7</em></strong></h2>
<p><span class="math inline">\(\hspace{1.5em}\)</span>最小化目标函数
<span class="math inline">\(4x+2y+9z\)</span>，受以下约束条件限制：</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(2x+y+z \leq 2\)</span></p></li>
<li><p><span class="math inline">\(x-y+3z \leq 3\)</span></p></li>
<li><p><span class="math inline">\(x \geq 0\)</span>, <span class="math inline">\(y \geq 0\)</span>, <span class="math inline">\(z
\geq 0\)</span></p></li>
</ol>
<div id="代码实现-9" class="section level4">
<h4>代码实现</h4>
<p><span class="math inline">\(\hspace{1.5em}\)</span>线性规划问题可以使用<code>lpSolve</code>包解决。</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a><span class="fu">library</span>(lpSolve)</span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a><span class="co"># 目标函数系数(min 4x+2y+9z)</span></span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a>objective<span class="ot">=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">9</span>)</span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a><span class="co"># 约束条件</span></span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a>constr<span class="ot">=</span><span class="fu">rbind</span>(</span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="co">#  2x+y+z &lt;= 2</span></span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>) <span class="co">#  x-y+3z &lt;= 3</span></span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a>)</span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a>direction<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;&lt;=&quot;</span>, <span class="st">&quot;&lt;=&quot;</span>)</span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a>rhs<span class="ot">=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb53-12"><a href="#cb53-12" tabindex="-1"></a><span class="co"># 定义变量的下界(x, y, z &gt;= 0)</span></span>
<span id="cb53-13"><a href="#cb53-13" tabindex="-1"></a>lower.bounds<span class="ot">=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb53-14"><a href="#cb53-14" tabindex="-1"></a><span class="co"># 使用lp函数求解线性规划问题</span></span>
<span id="cb53-15"><a href="#cb53-15" tabindex="-1"></a>result<span class="ot">=</span><span class="fu">lp</span>(<span class="st">&quot;min&quot;</span>, objective, constr, direction, rhs,<span class="at">all.int=</span><span class="cn">FALSE</span>)</span>
<span id="cb53-16"><a href="#cb53-16" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb53-17"><a href="#cb53-17" tabindex="-1"></a>result<span class="sc">$</span>solution</span></code></pre></div>
<pre><code>## [1] 0 0 0</code></pre>
</div>
<div id="结果验证" class="section level4">
<h4>结果验证</h4>
<p><span class="math inline">\(\hspace{1.5em}\)</span>输出结果为[0, 0,
0]，这个解是一个正确的最优解，它符合所有约束条件并最小化了目标函数。</p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>从目标函数<span class="math inline">\(4x+2y+9z\)</span>来看，所有的系数都是正数(4、2、9)。因此，最优解会倾向于将
<span class="math inline">\(x\)</span>、<span class="math inline">\(y\)</span> 和 <span class="math inline">\(z\)</span> 的值尽可能小，以便最小化目标函数。</p>
<ol style="list-style-type: decimal">
<li><p>对第一个约束 <span class="math inline">\(2*0+0+0=0 \leq
2\)</span> 是满足的。</p></li>
<li><p>对第二个约束 <span class="math inline">\(0-0+3*0=0 \leq
3\)</span> 也是满足的。</p></li>
</ol>
<p>这表明 <span class="math inline">\(x=0\)</span>, <span class="math inline">\(y=0\)</span>, <span class="math inline">\(z=0\)</span>
是一个可行解，并且目标函数的值为：</p>
<p><span class="math display">\[
4*0+2*0+9*0=0
\]</span></p>
<p>由于目标函数值为零，并且没有负值的系数，因此这就是最小值。</p>
<hr />
</div>
</div>
<div id="二exercises-3-4-5" class="section level2">
<h2><strong><em>二、Exercises 3, 4, 5</em></strong></h2>
<div id="exercises-3" class="section level3">
<h3><strong><em>Exercises 3</em></strong></h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>分别使用循环和lapply()函数，根据存储在这个列表中的公式来拟合mtcars数据集的线性模型：</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a>formulas<span class="ot">=</span><span class="fu">list</span>(</span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span><span class="sc">/</span>disp),</span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a>  mpg <span class="sc">~</span> disp<span class="sc">+</span>wt,</span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span><span class="sc">/</span>disp)<span class="sc">+</span>wt)</span></code></pre></div>
<div id="代码实现-10" class="section level4">
<h4>代码实现</h4>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="co"># 加载数据集和所需包(microbenchmark测量两者的执行时间)</span></span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a><span class="fu">data</span>(mtcars);<span class="fu">library</span>(microbenchmark)</span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a><span class="do">## 一、使用 for 循环</span></span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>time_for1<span class="ot">=</span><span class="fu">microbenchmark</span>(</span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a>  <span class="at">for_loop=</span>{mod_for1<span class="ot">=</span><span class="fu">list</span>()</span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(formulas)) {</span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a>      mod_for1[[i]]<span class="ot">=</span><span class="fu">lm</span>(formulas[[i]], <span class="at">data=</span>mtcars)</span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a>    }},  <span class="at">times=</span><span class="dv">10</span>)</span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a><span class="co"># 打印模型2结果</span></span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(mod_for1[[<span class="dv">2</span>]]))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -3.738 -1.822 -0.075  1.049  4.610 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   10.752      0.799    13.4  3.1e-14 ***
## I(1/disp)   1557.674    114.894    13.6  2.5e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.29 on 30 degrees of freedom
## Multiple R-squared:  0.86,   Adjusted R-squared:  0.855 
## F-statistic:  184 on 1 and 30 DF,  p-value: 2.49e-14</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="do">## 二、使用 lapply()</span></span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a>time_lapply1<span class="ot">=</span><span class="fu">microbenchmark</span>(</span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a>  <span class="at">lapply_loop=</span>{</span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>    mod_lapply1<span class="ot">=</span><span class="fu">lapply</span>(formulas, <span class="cf">function</span>(f) <span class="fu">lm</span>(f, <span class="at">data=</span>mtcars))</span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a>  },<span class="at">times=</span><span class="dv">10</span> )</span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a><span class="co"># 打印模型2结果</span></span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(mod_lapply1[[<span class="dv">2</span>]]))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -3.738 -1.822 -0.075  1.049  4.610 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   10.752      0.799    13.4  3.1e-14 ***
## I(1/disp)   1557.674    114.894    13.6  2.5e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.29 on 30 degrees of freedom
## Multiple R-squared:  0.86,   Adjusted R-squared:  0.855 
## F-statistic:  184 on 1 and 30 DF,  p-value: 2.49e-14</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="do">## 对比二者运行效率</span></span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a><span class="fu">print</span>(time_for1)</span></code></pre></div>
<pre><code>## Unit: milliseconds
##      expr   min    lq mean median    uq   max neval
##  for_loop 5.048 5.104 5.25  5.133 5.306 6.077    10</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="fu">print</span>(time_lapply1)</span></code></pre></div>
<pre><code>## Unit: milliseconds
##         expr   min    lq mean median    uq   max neval
##  lapply_loop 2.471 2.486  2.7   2.54 2.611 4.146    10</code></pre>
</div>
<div id="结果解释-1" class="section level4">
<h4>结果解释</h4>
<p><span class="math inline">\(\hspace{1.5em}\)</span>输出说明：</p>
<ul>
<li><p>min：最小执行时间；lq：第一四分位数；mean：平均执行时间；median：中位数执行时间</p></li>
<li><p>uq：第三四分位数；max：最大执行时间；neval：测试执行次数(10
次)</p></li>
</ul>
<p><span class="math inline">\(\hspace{1.5em}\)</span>通过打印结果可以看到，<strong>两种方法在四种模型下的拟合结果都相同</strong>。</p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>从<strong>运行效率</strong>来看，lapply()比for循环更高效。这是因为它是向量化的，并且
R 的内部优化通常能使 lapply() 执行得更快。</p>
</div>
</div>
<div id="exercises-4" class="section level3">
<h3><strong><em>Exercises 4</em></strong></h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>在不使用匿名函数的情况下，使用for循环和lapply()函数，对下面每个mtcarsbootstrap样本上拟合模型mpg~disp。</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a>bootstraps<span class="ot">=</span><span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a>  rows<span class="ot">=</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a>  mtcars[rows, ]})</span></code></pre></div>
<div id="代码实现-11" class="section level4">
<h4>代码实现</h4>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a><span class="do">## 一、使用 for 循环</span></span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a>time_for2<span class="ot">=</span><span class="fu">microbenchmark</span>(</span>
<span id="cb65-4"><a href="#cb65-4" tabindex="-1"></a>  <span class="at">for_loop=</span>{</span>
<span id="cb65-5"><a href="#cb65-5" tabindex="-1"></a>    mod_for2<span class="ot">=</span><span class="fu">list</span>()</span>
<span id="cb65-6"><a href="#cb65-6" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(bootstraps)) {</span>
<span id="cb65-7"><a href="#cb65-7" tabindex="-1"></a>      mod_for2[[i]]<span class="ot">=</span><span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data=</span>bootstraps[[i]])}</span>
<span id="cb65-8"><a href="#cb65-8" tabindex="-1"></a>    },<span class="at">times=</span><span class="dv">10</span>)</span>
<span id="cb65-9"><a href="#cb65-9" tabindex="-1"></a><span class="do">## 二、使用 lapply()</span></span>
<span id="cb65-10"><a href="#cb65-10" tabindex="-1"></a>fit_model<span class="ot">=</span><span class="cf">function</span>(bootstrap_data) {<span class="co"># 定义拟合模型的函数</span></span>
<span id="cb65-11"><a href="#cb65-11" tabindex="-1"></a>  <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data=</span>bootstrap_data)}</span>
<span id="cb65-12"><a href="#cb65-12" tabindex="-1"></a>time_lapply2<span class="ot">=</span><span class="fu">microbenchmark</span>(</span>
<span id="cb65-13"><a href="#cb65-13" tabindex="-1"></a>  <span class="at">lapply_loop=</span>{mod_lapply2<span class="ot">=</span><span class="fu">lapply</span>(bootstraps, fit_model)},<span class="at">times=</span><span class="dv">10</span>)</span>
<span id="cb65-14"><a href="#cb65-14" tabindex="-1"></a><span class="do">## 比较两个方法的第一个模型结果</span></span>
<span id="cb65-15"><a href="#cb65-15" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">coef</span>(mod_for2[[<span class="dv">1</span>]]),<span class="fu">coef</span>(mod_lapply2[[<span class="dv">1</span>]]))<span class="co">#输出为True即相同</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="do">## 打印比较效率</span></span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a><span class="fu">print</span>(time_for2);<span class="fu">print</span>(time_lapply2)</span></code></pre></div>
<pre><code>## Unit: milliseconds
##      expr   min    lq  mean median   uq   max neval
##  for_loop 7.741 7.835 8.302  8.017 8.99 9.009    10</code></pre>
<pre><code>## Unit: milliseconds
##         expr   min    lq  mean median    uq   max neval
##  lapply_loop 4.928 4.948 5.296  5.014 5.225 7.302    10</code></pre>
</div>
<div id="结果解释-2" class="section level4">
<h4>结果解释</h4>
<p><span class="math inline">\(\hspace{1.5em}\)</span>输出说明，两种方法得到的结果相同，且lapply()明显快于for循环。</p>
</div>
</div>
<div id="exercises-3-1" class="section level3">
<h3><strong><em>Exercises 3</em></strong></h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>对于前两个练习中的每个模型，使用下面的函数提取R²值：</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a>rsq<span class="ot">=</span><span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span></code></pre></div>
<div id="代码实现-12" class="section level4">
<h4>代码实现</h4>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a><span class="do">## 练习1 </span></span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a>R1_1<span class="ot">=</span><span class="fu">lapply</span>(mod_for1,rsq);R1_2<span class="ot">=</span><span class="fu">lapply</span>(mod_lapply1,rsq) <span class="co">#提取R²值</span></span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a>df1<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">mod_for=</span><span class="fu">unlist</span>(R1_1),<span class="at">mod_lapply=</span><span class="fu">unlist</span>(R1_2))</span>
<span id="cb71-5"><a href="#cb71-5" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">t</span>(df1),<span class="at">caption=</span><span class="st">&quot;练习一中四个模型的结果&quot;</span>)</span></code></pre></div>
<table>
<caption>练习一中四个模型的结果</caption>
<tbody>
<tr class="odd">
<td align="left">mod_for</td>
<td align="right">0.718</td>
<td align="right">0.86</td>
<td align="right">0.781</td>
<td align="right">0.884</td>
</tr>
<tr class="even">
<td align="left">mod_lapply</td>
<td align="right">0.718</td>
<td align="right">0.86</td>
<td align="right">0.781</td>
<td align="right">0.884</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="do">## 练习2</span></span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a>R2_1<span class="ot">=</span><span class="fu">lapply</span>(mod_for2,rsq);R2_2<span class="ot">=</span><span class="fu">lapply</span>(mod_lapply2,rsq) <span class="co">#提取R²值</span></span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a>df2<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">mod_for=</span><span class="fu">unlist</span>(R2_1),<span class="at">mod_lapply=</span><span class="fu">unlist</span>(R2_2))</span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">t</span>(df2),<span class="at">caption=</span><span class="st">&quot;练习二中模型结果&quot;</span>)</span></code></pre></div>
<table>
<caption>练习二中模型结果</caption>
<colgroup>
<col width="15%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="7%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="left">mod_for</td>
<td align="right">0.633</td>
<td align="right">0.617</td>
<td align="right">0.799</td>
<td align="right">0.779</td>
<td align="right">0.768</td>
<td align="right">0.723</td>
<td align="right">0.77</td>
<td align="right">0.725</td>
<td align="right">0.689</td>
<td align="right">0.662</td>
</tr>
<tr class="even">
<td align="left">mod_lapply</td>
<td align="right">0.633</td>
<td align="right">0.617</td>
<td align="right">0.799</td>
<td align="right">0.779</td>
<td align="right">0.768</td>
<td align="right">0.723</td>
<td align="right">0.77</td>
<td align="right">0.725</td>
<td align="right">0.689</td>
<td align="right">0.662</td>
</tr>
</tbody>
</table>
<hr />
</div>
</div>
</div>
<div id="三excecises-3-and-6" class="section level2">
<h2><strong><em>三、Excecises 3 and 6</em></strong></h2>
<div id="exercises-3-2" class="section level3">
<h3><strong><em>Exercises 3</em></strong></h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>以下代码模拟了对非正态数据进行t检验的性能。使用sapply()和一个匿名函数从每次试验中提取p值。</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a>trials<span class="ot">=</span><span class="fu">replicate</span>(</span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a>  <span class="dv">100</span>,</span>
<span id="cb73-3"><a href="#cb73-3" tabindex="-1"></a>  <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb73-4"><a href="#cb73-4" tabindex="-1"></a>  <span class="at">simplify=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<ul>
<li>额外挑战：通过直接使用[[来去掉匿名函数。</li>
</ul>
<div id="代码实现-13" class="section level4">
<h4>代码实现</h4>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="do">## 使用 sapply() 和匿名函数提取每次试验中的 p 值</span></span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a>p_values1<span class="ot">=</span><span class="fu">sapply</span>(trials, <span class="cf">function</span>(x) x<span class="sc">$</span>p.value)</span></code></pre></div>
<p><span class="math inline">\(\hspace{1.5em}\)</span>sapply()将匿名函数应用于trials列表的每个元素，提取每个t.test结果中的p.value，并返回一个包含所有
p 值的向量。</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="do">## 额外挑战：使用 sapply() 和 [[ 来提取 p.value</span></span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a>p_values2<span class="ot">=</span><span class="fu">sapply</span>(trials, <span class="st">`</span><span class="at">[[</span><span class="st">`</span>, <span class="st">&quot;p.value&quot;</span>)</span></code></pre></div>
<p><span class="math inline">\(\hspace{1.5em}\)</span><code>[[</code>
是一种通过名称访问列表中元素的方式，允许通过名称或索引提取元素。与使用 $
的方式是等效的， [[ 灵活性更高。</p>
</div>
</div>
<div id="exercises-6" class="section level3">
<h3><strong><em>Exercises 6</em></strong></h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>实现一个结合Map()和vapply()的函数，创建一个lapply()的变体，该变体并行地遍历所有输入，并将输出存储在向量(或矩阵)中。</p>
<div id="代码实现-14" class="section level4">
<h4>代码实现</h4>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a>m_v_lapply<span class="ot">=</span><span class="cf">function</span>(..., FUN) {</span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a>  args<span class="ot">=</span><span class="fu">list</span>(...)  <span class="co"># 获取输入的列表或向量</span></span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a>  result<span class="ot">=</span><span class="fu">Map</span>(FUN, args[[<span class="dv">1</span>]], args[[<span class="dv">2</span>]]) <span class="co"># 将所有输入的参数传入FUN</span></span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(result) <span class="sc">&gt;</span> <span class="dv">0</span>) { <span class="co"># 获取第一个元素的类型来推断 FUN.VALUE 类型</span></span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a>    first_value<span class="ot">=</span>result[[<span class="dv">1</span>]]</span>
<span id="cb76-6"><a href="#cb76-6" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.numeric</span>(first_value)) {</span>
<span id="cb76-7"><a href="#cb76-7" tabindex="-1"></a>      result<span class="ot">=</span><span class="fu">vapply</span>(result, <span class="cf">function</span>(x) x, <span class="at">FUN.VALUE=</span><span class="fu">numeric</span>(<span class="dv">1</span>))</span>
<span id="cb76-8"><a href="#cb76-8" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.character</span>(first_value)) {</span>
<span id="cb76-9"><a href="#cb76-9" tabindex="-1"></a>      result<span class="ot">=</span><span class="fu">vapply</span>(result, <span class="cf">function</span>(x) x, <span class="at">FUN.VALUE=</span><span class="fu">character</span>(<span class="dv">1</span>))</span>
<span id="cb76-10"><a href="#cb76-10" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.logical</span>(first_value)) {</span>
<span id="cb76-11"><a href="#cb76-11" tabindex="-1"></a>      result<span class="ot">=</span><span class="fu">vapply</span>(result, <span class="cf">function</span>(x) x, <span class="at">FUN.VALUE=</span><span class="fu">logical</span>(<span class="dv">1</span>))</span>
<span id="cb76-12"><a href="#cb76-12" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.list</span>(first_value)) {</span>
<span id="cb76-13"><a href="#cb76-13" tabindex="-1"></a>      result<span class="ot">=</span><span class="fu">vapply</span>(result, <span class="cf">function</span>(x) x, <span class="at">FUN.VALUE=</span><span class="fu">list</span>())</span>
<span id="cb76-14"><a href="#cb76-14" tabindex="-1"></a>    } <span class="cf">else</span> {<span class="fu">stop</span>(<span class="st">&quot;返回类型不可识别&quot;</span>)}</span>
<span id="cb76-15"><a href="#cb76-15" tabindex="-1"></a>  }</span>
<span id="cb76-16"><a href="#cb76-16" tabindex="-1"></a>  <span class="fu">return</span>(result)}</span>
<span id="cb76-17"><a href="#cb76-17" tabindex="-1"></a><span class="do">## 运行示例1：加法</span></span>
<span id="cb76-18"><a href="#cb76-18" tabindex="-1"></a><span class="co"># 定义一个简单的函数：两个输入的乘法</span></span>
<span id="cb76-19"><a href="#cb76-19" tabindex="-1"></a>multi_fun<span class="ot">=</span><span class="cf">function</span>(x, y) {</span>
<span id="cb76-20"><a href="#cb76-20" tabindex="-1"></a>  <span class="fu">return</span>(x<span class="sc">*</span>y)}</span>
<span id="cb76-21"><a href="#cb76-21" tabindex="-1"></a>input1<span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>; input2<span class="ot">=</span><span class="dv">6</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb76-22"><a href="#cb76-22" tabindex="-1"></a>output1<span class="ot">=</span><span class="fu">m_v_lapply</span>(input1, input2, <span class="at">FUN=</span>multi_fun)</span>
<span id="cb76-23"><a href="#cb76-23" tabindex="-1"></a><span class="fu">print</span>(output1)</span></code></pre></div>
<pre><code>## [1]  6 14 24 36 50</code></pre>
<ul>
<li><p><code>...</code>
用来接收输入参数的列表，可以是多个向量或其他类型的输入。</p></li>
<li><p><code>FUN</code>
用来指定希望对每一对输入参数执行的操作。</p></li>
</ul>
<hr />
</div>
</div>
</div>
<div id="三excecise4-4-5" class="section level2">
<h2><strong><em>三、Excecise4 4-5</em></strong></h2>
<div id="exercises-4-1" class="section level3">
<h3><strong><em>Exercises 4</em></strong></h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>制作一个更快版本的chisq.test()函数，该函数仅在输入为两个无缺失值的数值向量时计算卡方检验统计量。</p>
<p><span class="math inline">\(\hspace{1.5em}\)</span>卡方检验(Pearson’s
Chi-squared test)用于检验两个分类变量是否独立。公式如下：</p>
<p><span class="math display">\[
\chi^2=\sum \frac{(O_i-E_i)^2}{E_i}
\]</span></p>
<p>其中： - <span class="math inline">\(O_i\)</span> 是观察频数(Observed
Frequency) - <span class="math inline">\(E_i\)</span>
是期望频数(Expected Frequency)，计算公式为：</p>
<p><span class="math display">\[
E_i=\frac{(行的总和) \times (列的总和)}{总样本数}
\]</span></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a>chisq_test<span class="ot">=</span><span class="cf">function</span>(x, y) {</span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(x) <span class="sc">||</span> <span class="sc">!</span><span class="fu">is.numeric</span>(y)) {<span class="co"># 输入是否为数值向量</span></span>
<span id="cb78-3"><a href="#cb78-3" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;两个输入都必须是数值向量&quot;</span>)}</span>
<span id="cb78-4"><a href="#cb78-4" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(x) <span class="sc">!=</span> <span class="fu">length</span>(y)) {<span class="co"># 向量长度是否相等</span></span>
<span id="cb78-5"><a href="#cb78-5" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;两个向量的长度必须相同&quot;</span>) }</span>
<span id="cb78-6"><a href="#cb78-6" tabindex="-1"></a>   <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">is.na</span>(x)) <span class="sc">||</span> <span class="fu">any</span>(<span class="fu">is.na</span>(y))) {<span class="co"># 是否有缺失值</span></span>
<span id="cb78-7"><a href="#cb78-7" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;向量中不允许有缺失值&quot;</span>)}</span>
<span id="cb78-8"><a href="#cb78-8" tabindex="-1"></a>    c_table<span class="ot">=</span><span class="fu">table</span>(x, y) <span class="co"># 创建列联表</span></span>
<span id="cb78-9"><a href="#cb78-9" tabindex="-1"></a>    <span class="co"># 计算期望频数矩阵</span></span>
<span id="cb78-10"><a href="#cb78-10" tabindex="-1"></a>    row_sum<span class="ot">=</span><span class="fu">rowSums</span>(c_table);col_sum<span class="ot">=</span><span class="fu">colSums</span>(c_table);total_sum<span class="ot">=</span><span class="fu">sum</span>(c_table)</span>
<span id="cb78-11"><a href="#cb78-11" tabindex="-1"></a>    expected<span class="ot">=</span><span class="fu">outer</span>(row_sum, col_sum, <span class="st">&quot;*&quot;</span>)<span class="sc">/</span>total_sum</span>
<span id="cb78-12"><a href="#cb78-12" tabindex="-1"></a>    <span class="co"># 卡方统计量</span></span>
<span id="cb78-13"><a href="#cb78-13" tabindex="-1"></a>    chi_squared_stat<span class="ot">=</span><span class="fu">sum</span>((c_table<span class="sc">-</span>expected)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>expected)</span>
<span id="cb78-14"><a href="#cb78-14" tabindex="-1"></a>    <span class="co"># 自由度、p值</span></span>
<span id="cb78-15"><a href="#cb78-15" tabindex="-1"></a>    df<span class="ot">=</span>(<span class="fu">nrow</span>(c_table)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="fu">ncol</span>(c_table)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb78-16"><a href="#cb78-16" tabindex="-1"></a>    p_value<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(chi_squared_stat, df)</span>
<span id="cb78-17"><a href="#cb78-17" tabindex="-1"></a>    <span class="co"># 返回结果</span></span>
<span id="cb78-18"><a href="#cb78-18" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">chi_squared_stat=</span>chi_squared_stat,<span class="at">df=</span>df,<span class="at">p_value=</span>p_value))</span>
<span id="cb78-19"><a href="#cb78-19" tabindex="-1"></a>}</span>
<span id="cb78-20"><a href="#cb78-20" tabindex="-1"></a><span class="do">## 示例使用</span></span>
<span id="cb78-21"><a href="#cb78-21" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>,<span class="dv">25</span>,<span class="dv">30</span>); y<span class="ot">=</span><span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">10</span>,<span class="dv">25</span>,<span class="dv">20</span>,<span class="dv">50</span>)</span>
<span id="cb78-22"><a href="#cb78-22" tabindex="-1"></a>result1<span class="ot">=</span><span class="fu">chisq_test</span>(x, y)</span>
<span id="cb78-23"><a href="#cb78-23" tabindex="-1"></a><span class="fu">print</span>(result1)</span></code></pre></div>
<pre><code>## $chi_squared_stat
## [1] 20
## 
## $df
## [1] 16
## 
## $p_value
## [1] 0.22</code></pre>
</div>
<div id="exercises-5" class="section level3">
<h3><strong><em>Exercises 5</em></strong></h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>对于两个无缺失值的整数向量输入的情况，制作一个更快版本的
table() 函数，并用它来加速上面的卡方检验。</p>
<div id="代码实现-15" class="section level4">
<h4>代码实现</h4>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a>fast_table<span class="ot">=</span><span class="cf">function</span>(x, y) {</span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a>  x_levels<span class="ot">=</span><span class="fu">as.integer</span>(<span class="fu">factor</span>(x))</span>
<span id="cb80-3"><a href="#cb80-3" tabindex="-1"></a>  y_levels<span class="ot">=</span><span class="fu">as.integer</span>(<span class="fu">factor</span>(y))</span>
<span id="cb80-4"><a href="#cb80-4" tabindex="-1"></a>  <span class="co"># 初始化空的频数表</span></span>
<span id="cb80-5"><a href="#cb80-5" tabindex="-1"></a>  counts<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span><span class="fu">length</span>(<span class="fu">unique</span>(x)), <span class="at">ncol=</span><span class="fu">length</span>(<span class="fu">unique</span>(y)))</span>
<span id="cb80-6"><a href="#cb80-6" tabindex="-1"></a>  <span class="co"># 填充频数表</span></span>
<span id="cb80-7"><a href="#cb80-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(x)) {</span>
<span id="cb80-8"><a href="#cb80-8" tabindex="-1"></a>    counts[x_levels[i], y_levels[i]]<span class="ot">=</span>counts[x_levels[i], y_levels[i]]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb80-9"><a href="#cb80-9" tabindex="-1"></a>  }</span>
<span id="cb80-10"><a href="#cb80-10" tabindex="-1"></a>  <span class="fu">return</span>(counts)}</span>
<span id="cb80-11"><a href="#cb80-11" tabindex="-1"></a><span class="co"># 使用之前定义的 chisq_test 函数,修改列联表定义的部分，进行卡方检验</span></span>
<span id="cb80-12"><a href="#cb80-12" tabindex="-1"></a>chisq_test_fast<span class="ot">=</span><span class="cf">function</span>(x, y) {</span>
<span id="cb80-13"><a href="#cb80-13" tabindex="-1"></a>     c_table<span class="ot">=</span><span class="fu">fast_table</span>(x, y) <span class="co"># 创建列联表</span></span>
<span id="cb80-14"><a href="#cb80-14" tabindex="-1"></a>    <span class="co"># 计算期望频数矩阵</span></span>
<span id="cb80-15"><a href="#cb80-15" tabindex="-1"></a>    row_sum<span class="ot">=</span><span class="fu">rowSums</span>(c_table);col_sum<span class="ot">=</span><span class="fu">colSums</span>(c_table);total_sum<span class="ot">=</span><span class="fu">sum</span>(c_table)</span>
<span id="cb80-16"><a href="#cb80-16" tabindex="-1"></a>    expected<span class="ot">=</span><span class="fu">outer</span>(row_sum, col_sum, <span class="st">&quot;*&quot;</span>)<span class="sc">/</span>total_sum</span>
<span id="cb80-17"><a href="#cb80-17" tabindex="-1"></a>    <span class="co"># 卡方统计量</span></span>
<span id="cb80-18"><a href="#cb80-18" tabindex="-1"></a>    chi_squared_stat<span class="ot">=</span><span class="fu">sum</span>((c_table<span class="sc">-</span>expected)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>expected)</span>
<span id="cb80-19"><a href="#cb80-19" tabindex="-1"></a>    <span class="co"># 自由度、p值</span></span>
<span id="cb80-20"><a href="#cb80-20" tabindex="-1"></a>    df<span class="ot">=</span>(<span class="fu">nrow</span>(c_table)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="fu">ncol</span>(c_table)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb80-21"><a href="#cb80-21" tabindex="-1"></a>    p_value<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(chi_squared_stat, df)</span>
<span id="cb80-22"><a href="#cb80-22" tabindex="-1"></a>    <span class="co"># 返回结果</span></span>
<span id="cb80-23"><a href="#cb80-23" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">chi_squared_stat=</span>chi_squared_stat,<span class="at">df=</span>df,<span class="at">p_value=</span>p_value))</span>
<span id="cb80-24"><a href="#cb80-24" tabindex="-1"></a>}</span>
<span id="cb80-25"><a href="#cb80-25" tabindex="-1"></a><span class="do">## 示例使用</span></span>
<span id="cb80-26"><a href="#cb80-26" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>,<span class="dv">25</span>,<span class="dv">30</span>); y<span class="ot">=</span><span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">10</span>,<span class="dv">25</span>,<span class="dv">20</span>,<span class="dv">50</span>)</span>
<span id="cb80-27"><a href="#cb80-27" tabindex="-1"></a>result2<span class="ot">=</span><span class="fu">chisq_test_fast</span>(x, y)</span>
<span id="cb80-28"><a href="#cb80-28" tabindex="-1"></a><span class="fu">print</span>(result2)</span></code></pre></div>
<pre><code>## $chi_squared_stat
## [1] 20
## 
## $df
## [1] 16
## 
## $p_value
## [1] 0.22</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="do">## 对比运行效率</span></span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb82-3"><a href="#cb82-3" tabindex="-1"></a>time1<span class="ot">=</span><span class="fu">microbenchmark</span>(<span class="fu">chisq_test</span>(x, y),<span class="at">times=</span><span class="dv">50</span>);<span class="fu">print</span>(time1)</span></code></pre></div>
<pre><code>## Unit: microseconds
##              expr min  lq mean median  uq max neval
##  chisq_test(x, y) 242 245  251    247 248 396    50</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a>time2<span class="ot">=</span><span class="fu">microbenchmark</span>(<span class="fu">chisq_test_fast</span>(x, y),<span class="at">times=</span><span class="dv">50</span>);<span class="fu">print</span>(time2)</span></code></pre></div>
<pre><code>## Unit: microseconds
##                   expr min  lq mean median  uq max neval
##  chisq_test_fast(x, y) 150 151  157    154 156 291    50</code></pre>
<p><span class="math inline">\(\hspace{1.5em}\)</span>可以看到，使用改进的<code>fast_table()</code>后，输出结果不变，而运行速度得到明显地提升。</p>
<hr />
</div>
</div>
</div>
</div>
<div id="作业2024-11-18" class="section level1">
<h1>作业2024-11-18</h1>
<div id="作业要求" class="section level3">
<h3>作业要求</h3>
<p><span class="math inline">\(\hspace{1.5em}\)</span>根据Exercise_9.8写一个Rcpp函数，使用“<strong>qqplot</strong>”函数比较编写的Rcpp函数生成的随机数与R中相应函数生成的随机数。使用“<strong>microbenchmark</strong>”函数比较这两个函数的计算时间。</p>
</div>
<div id="代码实现-16" class="section level3">
<h3>代码实现</h3>
<div id="c-function" class="section level4">
<h4>1. C++ function</h4>
<p><span class="math inline">\(\hspace{1.5em}\)</span>首先创建一个m行2列的矩阵存储样本，对其赋初始值后进行Gibbs抽样循环：从条件分布Binomial(n,
y)抽样更新 x1，从条件分布Beta(x + a, n - x + b)抽样更新x2。</p>
<ul>
<li><p>输入参数：样本数 m、burnin 样本数、n、a、b。</p></li>
<li><p>使用 R::rbinom 和 R::rbeta 来从二项式和 Beta
分布中抽样。</p></li>
</ul>
<p><span class="math inline">\(\hspace{1.5em}\)</span>C++函数
<strong>gibbs_sampler.cpp</strong>具体定义如下：</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="co">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a>using namespace Rcpp;</span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" tabindex="-1"></a><span class="sc">/</span><span class="er">/</span> [[Rcpp<span class="sc">::</span>export]]</span>
<span id="cb86-5"><a href="#cb86-5" tabindex="-1"></a>NumericMatrix <span class="fu">gibbs_sampling</span>(int m, int n, double a, double b) {</span>
<span id="cb86-6"><a href="#cb86-6" tabindex="-1"></a>  NumericMatrix <span class="fu">x</span>(m, <span class="dv">2</span>);</span>
<span id="cb86-7"><a href="#cb86-7" tabindex="-1"></a>  double xt_1<span class="ot">=</span><span class="fl">0.5</span>; </span>
<span id="cb86-8"><a href="#cb86-8" tabindex="-1"></a>  double xt_2<span class="ot">=</span><span class="fl">0.5</span>;</span>
<span id="cb86-9"><a href="#cb86-9" tabindex="-1"></a>  <span class="cf">for</span> (int <span class="at">i=</span><span class="dv">1</span>; i <span class="sc">&lt;</span> m; <span class="sc">++</span>i) {</span>
<span id="cb86-10"><a href="#cb86-10" tabindex="-1"></a>    xt_1<span class="ot">=</span>R<span class="sc">::</span><span class="fu">rbinom</span>(n, xt_2);</span>
<span id="cb86-11"><a href="#cb86-11" tabindex="-1"></a>    xt_2<span class="ot">=</span>R<span class="sc">::</span><span class="fu">rbeta</span>(xt_1 <span class="sc">+</span> a, n <span class="sc">-</span> xt_1 <span class="sc">+</span> b);</span>
<span id="cb86-12"><a href="#cb86-12" tabindex="-1"></a>    <span class="fu">x</span>(i, <span class="dv">0</span>)<span class="ot">=</span>xt_1;</span>
<span id="cb86-13"><a href="#cb86-13" tabindex="-1"></a>    <span class="fu">x</span>(i, <span class="dv">1</span>)<span class="ot">=</span>xt_2;</span>
<span id="cb86-14"><a href="#cb86-14" tabindex="-1"></a>  }</span>
<span id="cb86-15"><a href="#cb86-15" tabindex="-1"></a>  return x;</span>
<span id="cb86-16"><a href="#cb86-16" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="rcpp-v.s.-r" class="section level4">
<h4>2. Rcpp v.s. R</h4>
<p><span class="math inline">\(\hspace{1.5em}\)</span>首先导入定义的Rcpp函数和需要的包：Rcpp、microbenchmark。</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a><span class="fu">library</span>(Rcpp);<span class="fu">library</span>(microbenchmark)</span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a><span class="do">## 载入Rcpp函数</span></span>
<span id="cb87-4"><a href="#cb87-4" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="st">&#39;../vignettes/gibbs.cpp&#39;</span>)</span></code></pre></div>
<pre><code>## Warning in normalizePath(path.expand(path), winslash, mustWork):
## path[1]=&quot;C:/SA24204129/vignettes/../inst/include&quot;: 系统找不到指定的文件。</code></pre>
<p><span class="math inline">\(\hspace{1.5em}\)</span>使用“<strong>qqplot</strong>”函数比较编写的Rcpp函数生成的随机数与R中相应函数生成的随机数。使用“<strong>microbenchmark</strong>”函数比较这计算时间。</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a><span class="co"># 设置参数和种子--Beta分布的参数与Gibbs抽样过程的迭代次数m</span></span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">1000</span>;a<span class="ot">=</span><span class="dv">30</span>;b<span class="ot">=</span><span class="dv">60</span>;m<span class="ot">=</span><span class="dv">10000</span></span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb89-4"><a href="#cb89-4" tabindex="-1"></a><span class="do">## R编写Gibbs抽样函数</span></span>
<span id="cb89-5"><a href="#cb89-5" tabindex="-1"></a>R_gibbs_sampling<span class="ot">=</span><span class="cf">function</span>(m, n, a, b) {</span>
<span id="cb89-6"><a href="#cb89-6" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>m, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb89-7"><a href="#cb89-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb89-8"><a href="#cb89-8" tabindex="-1"></a>    xt<span class="ot">=</span>x[i<span class="dv">-1</span>,]  <span class="co"># 当前迭代的样本值</span></span>
<span id="cb89-9"><a href="#cb89-9" tabindex="-1"></a>    xt[<span class="dv">1</span>]<span class="ot">=</span><span class="fu">rbinom</span>(<span class="dv">1</span>, n, xt[<span class="dv">2</span>])   <span class="co"># Binomial(n,y)中抽样</span></span>
<span id="cb89-10"><a href="#cb89-10" tabindex="-1"></a>    xt[<span class="dv">2</span>]<span class="ot">=</span><span class="fu">rbeta</span>(<span class="dv">1</span>,xt[<span class="dv">1</span>]<span class="sc">+</span>a,n<span class="sc">-</span>xt[<span class="dv">1</span>]<span class="sc">+</span>b) <span class="co"># Beta(x+a,n-x+b)中抽样</span></span>
<span id="cb89-11"><a href="#cb89-11" tabindex="-1"></a>    x[i,]<span class="ot">=</span>xt <span class="co"># 更新样本值</span></span>
<span id="cb89-12"><a href="#cb89-12" tabindex="-1"></a>  }</span>
<span id="cb89-13"><a href="#cb89-13" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb89-14"><a href="#cb89-14" tabindex="-1"></a>}</span>
<span id="cb89-15"><a href="#cb89-15" tabindex="-1"></a></span>
<span id="cb89-16"><a href="#cb89-16" tabindex="-1"></a><span class="do">## 使用Rcpp的Gibbs抽样</span></span>
<span id="cb89-17"><a href="#cb89-17" tabindex="-1"></a>x_rcpp<span class="ot">=</span><span class="fu">gibbs_sampling</span>(m, n, a, b)</span>
<span id="cb89-18"><a href="#cb89-18" tabindex="-1"></a><span class="do">## 使用R编写的Gibbs抽样</span></span>
<span id="cb89-19"><a href="#cb89-19" tabindex="-1"></a>x_r<span class="ot">=</span><span class="fu">R_gibbs_sampling</span>(m, n, a, b)</span></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="do">## 在一张图上plot散点图</span></span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb90-3"><a href="#cb90-3" tabindex="-1"></a><span class="fu">plot</span>(x_rcpp[,<span class="dv">1</span>], x_rcpp[,<span class="dv">2</span>], <span class="at">xlab =</span> <span class="st">&#39;x1&#39;</span>, <span class="at">ylab =</span><span class="st">&#39;x2&#39;</span>,<span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb90-4"><a href="#cb90-4" tabindex="-1"></a>     <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">ylim =</span> <span class="fu">range</span>(x_rcpp[,<span class="dv">2</span>]),<span class="at">col =</span> <span class="st">&#39;darkgray&#39;</span>,<span class="at">pch =</span> <span class="dv">1</span>)</span>
<span id="cb90-5"><a href="#cb90-5" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)</span>
<span id="cb90-6"><a href="#cb90-6" tabindex="-1"></a><span class="fu">plot</span>(x_r[,<span class="dv">1</span>], x_r[,<span class="dv">2</span>],<span class="at">cex =</span> <span class="fl">0.5</span>,<span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">ylab =</span><span class="st">&#39;&#39;</span>,<span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb90-7"><a href="#cb90-7" tabindex="-1"></a>     <span class="at">xaxt =</span> <span class="st">&#39;n&#39;</span>,<span class="at">yaxt =</span> <span class="st">&#39;n&#39;</span>,<span class="at">col =</span><span class="st">&#39;darkred&#39;</span>,<span class="at">pch =</span> <span class="dv">18</span>)</span>
<span id="cb90-8"><a href="#cb90-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Rcpp Samples&quot;</span>, <span class="st">&quot;R Samples&quot;</span>),</span>
<span id="cb90-9"><a href="#cb90-9" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkgray&quot;</span>, <span class="st">&quot;darkred&quot;</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">18</span>), <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>通过
<strong>plot()</strong>可以观察到Gibbs抽样生成的二元样本序列的分布情况。可以看到二者围绕某个区域密集分布，样本序列可能很好地从目标分布中抽样；同时二者分布形态相似。</li>
</ul>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="do">## QQ图比较</span></span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb91-3"><a href="#cb91-3" tabindex="-1"></a><span class="fu">qqplot</span>(x_rcpp[,<span class="dv">1</span>], x_r[,<span class="dv">1</span>], <span class="at">main=</span><span class="st">&quot;X1的QQ图(Rcpp v.s. R)&quot;</span>, </span>
<span id="cb91-4"><a href="#cb91-4" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">&quot;Rcpp-X1&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R-X1&quot;</span>,<span class="at">col =</span> <span class="st">&quot;darkgray&quot;</span>)</span>
<span id="cb91-5"><a href="#cb91-5" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)  <span class="co"># 添加y=x参考线</span></span>
<span id="cb91-6"><a href="#cb91-6" tabindex="-1"></a><span class="fu">qqplot</span>(x_rcpp[,<span class="dv">2</span>], x_r[,<span class="dv">2</span>], <span class="at">main=</span><span class="st">&quot;X2的QQ图(Rcpp v.s. R)&quot;</span>, </span>
<span id="cb91-7"><a href="#cb91-7" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">&quot;Rcpp-X2&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R-X2&quot;</span>,<span class="at">col =</span> <span class="st">&quot;darkgray&quot;</span>)</span>
<span id="cb91-8"><a href="#cb91-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)  <span class="co"># 添加y=x参考线</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>通过<strong>qqplot()</strong>可以检验生成的样本是否符合预期，如果两者生成的随机数分布一致，点会接近于一条直线。从图可以看出，大部分点都紧密地围绕在对角线附近，仅在尾部区域可能存在一些偏差。这表明<strong>Rcpp和R生成的样本序列的分布非常相似</strong>。</li>
</ul>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a><span class="do">## 两种方法的计算时间-重复10次结果</span></span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a>ts<span class="ot">=</span><span class="fu">microbenchmark</span>(</span>
<span id="cb92-3"><a href="#cb92-3" tabindex="-1"></a>  <span class="at">Rcpp=</span><span class="fu">gibbs_sampling</span>(m,n,a,b),</span>
<span id="cb92-4"><a href="#cb92-4" tabindex="-1"></a>  <span class="at">R=</span><span class="fu">R_gibbs_sampling</span>(m,n,a,b),</span>
<span id="cb92-5"><a href="#cb92-5" tabindex="-1"></a>  <span class="at">times=</span><span class="dv">10</span>) </span>
<span id="cb92-6"><a href="#cb92-6" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">summary</span>(ts))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">expr</th>
<th align="right">min</th>
<th align="right">lq</th>
<th align="right">mean</th>
<th align="right">median</th>
<th align="right">uq</th>
<th align="right">max</th>
<th align="right">neval</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Rcpp</td>
<td align="right">2.88</td>
<td align="right">2.89</td>
<td align="right">3.03</td>
<td align="right">2.91</td>
<td align="right">2.94</td>
<td align="right">4.09</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="left">R</td>
<td align="right">30.85</td>
<td align="right">31.19</td>
<td align="right">32.71</td>
<td align="right">32.72</td>
<td align="right">33.36</td>
<td align="right">35.10</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
<ul>
<li>通过
<strong>microbenchmark()</strong>可以比较二者实现性能，明显看到，通过C++代码实现的Rcpp*<strong>速度快了10倍左右</strong>，通过编写Rcpp函数<strong>大幅度提升了代码运行效率</strong>。</li>
</ul>
</div>
<div id="回到exercise9.8上收敛性验证" class="section level4">
<h4>3. 回到Exercise9.8上–收敛性验证</h4>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a><span class="do">## 累积均值(phi)图</span></span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a>phi<span class="ot">=</span><span class="cf">function</span>(x,<span class="at">c=</span><span class="st">&quot;darkred&quot;</span>,<span class="at">y=</span><span class="st">&#39;n&#39;</span>){</span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a>  burnin<span class="ot">=</span><span class="dv">1000</span> <span class="co"># 不稳定的烧入期</span></span>
<span id="cb93-4"><a href="#cb93-4" tabindex="-1"></a>  phi <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">t</span>(<span class="fu">apply</span>(x, <span class="dv">1</span>, cumsum)))</span>
<span id="cb93-5"><a href="#cb93-5" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(phi)) {</span>
<span id="cb93-6"><a href="#cb93-6" tabindex="-1"></a>    phi[i,] <span class="ot">=</span> phi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(phi))}</span>
<span id="cb93-7"><a href="#cb93-7" tabindex="-1"></a>  <span class="fu">plot</span>((burnin<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m, phi[i, (burnin<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m],</span>
<span id="cb93-8"><a href="#cb93-8" tabindex="-1"></a>       <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&#39;Index&#39;</span>, <span class="at">ylab =</span> <span class="fu">bquote</span>(phi),</span>
<span id="cb93-9"><a href="#cb93-9" tabindex="-1"></a>       <span class="at">col=</span>c,<span class="at">yaxt =</span> y) </span>
<span id="cb93-10"><a href="#cb93-10" tabindex="-1"></a>}</span>
<span id="cb93-11"><a href="#cb93-11" tabindex="-1"></a><span class="fu">phi</span>(x_r,<span class="at">c=</span><span class="st">&quot;darkgray&quot;</span>,<span class="at">y=</span><span class="st">&#39;s&#39;</span>);<span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>);<span class="fu">phi</span>(x_rcpp)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li><strong>累积均值图</strong>：绘制累积均值图，用于观察样本序列是否趋于稳定。可以看到，<strong>两种方法累积均值图显示样本序列都是趋于稳定的</strong>，符合收敛性要求。</li>
</ul>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a><span class="do">## 绘制潜在尺度缩减因子图</span></span>
<span id="cb94-2"><a href="#cb94-2" tabindex="-1"></a>rhat<span class="ot">=</span><span class="cf">function</span>(x,<span class="at">c=</span><span class="st">&#39;darkred&#39;</span>){</span>
<span id="cb94-3"><a href="#cb94-3" tabindex="-1"></a>  <span class="do">## 计算潜在尺度缩减因子</span></span>
<span id="cb94-4"><a href="#cb94-4" tabindex="-1"></a>  phi <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">t</span>(<span class="fu">apply</span>(x, <span class="dv">1</span>, cumsum)))</span>
<span id="cb94-5"><a href="#cb94-5" tabindex="-1"></a>  Gelman.Rubin <span class="ot">=</span> <span class="cf">function</span>(phi) {</span>
<span id="cb94-6"><a href="#cb94-6" tabindex="-1"></a>    phi <span class="ot">=</span> <span class="fu">as.matrix</span>(phi);  k <span class="ot">=</span> <span class="fu">nrow</span>(phi); n <span class="ot">=</span> <span class="fu">ncol</span>(phi)</span>
<span id="cb94-7"><a href="#cb94-7" tabindex="-1"></a>    phi.means <span class="ot">=</span> <span class="fu">rowMeans</span>(phi); B <span class="ot">=</span> n <span class="sc">*</span> <span class="fu">var</span>(phi.means);</span>
<span id="cb94-8"><a href="#cb94-8" tabindex="-1"></a>    phi.w <span class="ot">=</span> <span class="fu">apply</span>(phi, <span class="dv">1</span>, var);  W <span class="ot">=</span> <span class="fu">mean</span>(phi.w)</span>
<span id="cb94-9"><a href="#cb94-9" tabindex="-1"></a>    v.hat <span class="ot">=</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n<span class="sc">+</span>B<span class="sc">/</span>n; r.hat <span class="ot">=</span> v.hat <span class="sc">/</span> W</span>
<span id="cb94-10"><a href="#cb94-10" tabindex="-1"></a>    <span class="fu">return</span>(r.hat)</span>
<span id="cb94-11"><a href="#cb94-11" tabindex="-1"></a>}</span>
<span id="cb94-12"><a href="#cb94-12" tabindex="-1"></a>  rhat <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb94-13"><a href="#cb94-13" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n) {</span>
<span id="cb94-14"><a href="#cb94-14" tabindex="-1"></a>    rhat[j] <span class="ot">=</span> <span class="fu">Gelman.Rubin</span>(phi[, <span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb94-15"><a href="#cb94-15" tabindex="-1"></a>    }</span>
<span id="cb94-16"><a href="#cb94-16" tabindex="-1"></a>  <span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R&quot;</span>,<span class="at">col=</span>c)</span>
<span id="cb94-17"><a href="#cb94-17" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">1.2</span>, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="st">&#39;red&#39;</span>) <span class="co"># 小于1.2认为是收敛</span></span>
<span id="cb94-18"><a href="#cb94-18" tabindex="-1"></a>}</span>
<span id="cb94-19"><a href="#cb94-19" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb94-20"><a href="#cb94-20" tabindex="-1"></a><span class="fu">rhat</span>(x_r,<span class="at">c=</span><span class="st">&quot;black&quot;</span>);<span class="fu">rhat</span>(x_rcpp)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li><strong>Gelman-Rubin
检验</strong>：绘制Rhat值图，观察是否低于1.2，小于1.2认为样本序列已经收敛。<strong>图中两种方法的Rhat值始终低于1.2，充分表明序列已经收敛</strong>。</li>
</ul>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
